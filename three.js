
(function(y,Fi){typeof exports=="object"&&typeof module!="undefined"?Fi(exports):typeof define=="function"&&define.amd?define(["exports"],Fi):(y=typeof globalThis!="undefined"?globalThis:y||self,Fi(y.THREE={}))})(this,function(y){"use strict";Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}),Math.sign===void 0&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),t=1;t<arguments.length;t++){var r=arguments[t];if(r!=null)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(i[n]=r[n])}return i});var Fi="124",xp={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},bp={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Sc=0,ys=1,Tc=2,_p=3,wp=0,xs=1,Ec=2,Gi=3,Hi=0,ht=1,In=2,bs=1,Mp=2,Mr=0,ki=1,_s=2,ws=3,Ms=4,Ac=5,ui=100,Lc=101,Rc=102,Ss=103,Ts=104,Pc=200,Cc=201,Nc=202,Oc=203,Es=204,As=205,Ic=206,Dc=207,Bc=208,zc=209,Uc=210,Fc=0,Gc=1,Hc=2,ka=3,kc=4,Vc=5,Wc=6,jc=7,Dn=0,qc=1,Xc=2,hi=0,Yc=1,Zc=2,Jc=3,Kc=4,Qc=5,Va=300,Bn=301,zn=302,Wa=303,ja=304,Vi=306,Un=307,Fn=1e3,At=1001,Gn=1002,dt=1003,qa=1004,Sp=1004,Xa=1005,Tp=1005,mt=1006,Ls=1007,Ep=1007,Wi=1008,Ap=1008,ji=1009,$c=1010,eu=1011,Hn=1012,tu=1013,kn=1014,Sr=1015,Vn=1016,ru=1017,iu=1018,nu=1019,qi=1020,au=1021,Hr=1022,Dt=1023,ou=1024,su=1025,lu=Dt,di=1026,Xi=1027,cu=1028,uu=1029,hu=1030,du=1031,pu=1032,fu=1033,Rs=33776,Ps=33777,Cs=33778,Ns=33779,Os=35840,Is=35841,Ds=35842,Bs=35843,mu=36196,zs=37492,Us=37496,vu=37808,gu=37809,yu=37810,xu=37811,bu=37812,_u=37813,wu=37814,Mu=37815,Su=37816,Tu=37817,Eu=37818,Au=37819,Lu=37820,Ru=37821,Pu=36492,Cu=37840,Nu=37841,Ou=37842,Iu=37843,Du=37844,Bu=37845,zu=37846,Uu=37847,Fu=37848,Gu=37849,Hu=37850,ku=37851,Vu=37852,Wu=37853,ju=2200,qu=2201,Xu=2202,Wn=2300,jn=2301,Ya=2302,pi=2400,fi=2401,qn=2402,Za=2500,Fs=2501,Yu=0,Lp=1,Rp=2,Lt=3e3,Xn=3001,Ja=3007,Ka=3002,Zu=3003,Gs=3004,Hs=3005,ks=3006,Ju=3200,Ku=3201,mi=0,Qu=1,Pp=0,Qa=7680,Cp=7681,Np=7682,Op=7683,Ip=34055,Dp=34056,Bp=5386,zp=512,Up=513,Fp=514,Gp=515,Hp=516,kp=517,Vp=518,$u=519,Yn=35044,vi=35048,Wp=35040,jp=35045,qp=35049,Xp=35041,Yp=35046,Zp=35050,Jp=35042,Kp="100",Vs="300 es";function ur(){}Object.assign(ur.prototype,{addEventListener:function(e,i){this._listeners===void 0&&(this._listeners={});var t=this._listeners;t[e]===void 0&&(t[e]=[]),t[e].indexOf(i)===-1&&t[e].push(i)},hasEventListener:function(e,i){if(this._listeners===void 0)return!1;var t=this._listeners;return t[e]!==void 0&&t[e].indexOf(i)!==-1},removeEventListener:function(e,i){if(this._listeners!==void 0){var t=this._listeners,r=t[e];if(r!==void 0){var n=r.indexOf(i);n!==-1&&r.splice(n,1)}}},dispatchEvent:function(e){if(this._listeners!==void 0){var i=this._listeners,t=i[e.type];if(t!==void 0){e.target=this;for(var r=t.slice(0),n=0,a=r.length;n<a;n++)r[n].call(this,e)}}}});for(var xt=[],Zn=0;Zn<256;Zn++)xt[Zn]=(Zn<16?"0":"")+Zn.toString(16);var $a=1234567,be={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,n=xt[e&255]+xt[e>>8&255]+xt[e>>16&255]+xt[e>>24&255]+"-"+xt[i&255]+xt[i>>8&255]+"-"+xt[i>>16&15|64]+xt[i>>24&255]+"-"+xt[t&63|128]+xt[t>>8&255]+"-"+xt[t>>16&255]+xt[t>>24&255]+xt[r&255]+xt[r>>8&255]+xt[r>>16&255]+xt[r>>24&255];return n.toUpperCase()},clamp:function(e,i,t){return Math.max(i,Math.min(t,e))},euclideanModulo:function(e,i){return(e%i+i)%i},mapLinear:function(e,i,t,r,n){return r+(e-i)*(n-r)/(t-i)},lerp:function(e,i,t){return(1-t)*e+t*i},smoothstep:function(e,i,t){return e<=i?0:e>=t?1:(e=(e-i)/(t-i),e*e*(3-2*e))},smootherstep:function(e,i,t){return e<=i?0:e>=t?1:(e=(e-i)/(t-i),e*e*e*(e*(e*6-15)+10))},randInt:function(e,i){return e+Math.floor(Math.random()*(i-e+1))},randFloat:function(e,i){return e+Math.random()*(i-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return e!==void 0&&($a=e%2147483647),$a=$a*16807%2147483647,($a-1)/2147483646},degToRad:function(e){return e*be.DEG2RAD},radToDeg:function(e){return e*be.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)==0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,i,t,r,n){var a=Math.cos,o=Math.sin,s=a(t/2),l=o(t/2),c=a((i+r)/2),h=o((i+r)/2),u=a((i-r)/2),p=o((i-r)/2),d=a((r-i)/2),m=o((r-i)/2);switch(n){case"XYX":e.set(s*h,l*u,l*p,s*c);break;case"YZY":e.set(l*p,s*h,l*u,s*c);break;case"ZXZ":e.set(l*u,l*p,s*h,s*c);break;case"XZX":e.set(s*h,l*m,l*d,s*c);break;case"YXY":e.set(l*d,s*h,l*m,s*c);break;case"ZYZ":e.set(l*m,l*d,s*h,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}};function eh(e,i){for(var t=0;t<i.length;t++){var r=i[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eo(e,i,t){return i&&eh(e.prototype,i),t&&eh(e,t),e}function le(e,i){e.prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i}function Yi(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var X=function(){function e(t,r){t===void 0&&(t=0),r===void 0&&(r=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=t,this.y=r}var i=e.prototype;return i.set=function(t,r){return this.x=t,this.y=r,this},i.setScalar=function(t){return this.x=t,this.y=t,this},i.setX=function(t){return this.x=t,this},i.setY=function(t){return this.y=t,this},i.setComponent=function(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;default:throw new Error("index is out of range: "+t)}return this},i.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},i.clone=function(){return new this.constructor(this.x,this.y)},i.copy=function(t){return this.x=t.x,this.y=t.y,this},i.add=function(t,r){return r!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,r)):(this.x+=t.x,this.y+=t.y,this)},i.addScalar=function(t){return this.x+=t,this.y+=t,this},i.addVectors=function(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this},i.addScaledVector=function(t,r){return this.x+=t.x*r,this.y+=t.y*r,this},i.sub=function(t,r){return r!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,r)):(this.x-=t.x,this.y-=t.y,this)},i.subScalar=function(t){return this.x-=t,this.y-=t,this},i.subVectors=function(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this},i.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},i.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},i.divide=function(t){return this.x/=t.x,this.y/=t.y,this},i.divideScalar=function(t){return this.multiplyScalar(1/t)},i.applyMatrix3=function(t){var r=this.x,n=this.y,a=t.elements;return this.x=a[0]*r+a[3]*n+a[6],this.y=a[1]*r+a[4]*n+a[7],this},i.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},i.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},i.clamp=function(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this},i.clampScalar=function(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this},i.clampLength=function(t,r){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(r,n)))},i.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},i.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},i.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},i.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},i.negate=function(){return this.x=-this.x,this.y=-this.y,this},i.dot=function(t){return this.x*t.x+this.y*t.y},i.cross=function(t){return this.x*t.y-this.y*t.x},i.lengthSq=function(){return this.x*this.x+this.y*this.y},i.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},i.normalize=function(){return this.divideScalar(this.length()||1)},i.angle=function(){var t=Math.atan2(-this.y,-this.x)+Math.PI;return t},i.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},i.distanceToSquared=function(t){var r=this.x-t.x,n=this.y-t.y;return r*r+n*n},i.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},i.setLength=function(t){return this.normalize().multiplyScalar(t)},i.lerp=function(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this},i.lerpVectors=function(t,r,n){return this.x=t.x+(r.x-t.x)*n,this.y=t.y+(r.y-t.y)*n,this},i.equals=function(t){return t.x===this.x&&t.y===this.y},i.fromArray=function(t,r){return r===void 0&&(r=0),this.x=t[r],this.y=t[r+1],this},i.toArray=function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t},i.fromBufferAttribute=function(t,r,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(r),this.y=t.getY(r),this},i.rotateAround=function(t,r){var n=Math.cos(r),a=Math.sin(r),o=this.x-t.x,s=this.y-t.y;return this.x=o*n-s*a+t.x,this.y=o*a+s*n+t.y,this},i.random=function(){return this.x=Math.random(),this.y=Math.random(),this},eo(e,[{key:"width",get:function(){return this.x},set:function(t){this.x=t}},{key:"height",get:function(){return this.y},set:function(t){this.y=t}}]),e}(),Rt=function(){function e(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var i=e.prototype;return i.set=function(t,r,n,a,o,s,l,c,h){var u=this.elements;return u[0]=t,u[1]=a,u[2]=l,u[3]=r,u[4]=o,u[5]=c,u[6]=n,u[7]=s,u[8]=h,this},i.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},i.clone=function(){return new this.constructor().fromArray(this.elements)},i.copy=function(t){var r=this.elements,n=t.elements;return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],this},i.extractBasis=function(t,r,n){return t.setFromMatrix3Column(this,0),r.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},i.setFromMatrix4=function(t){var r=t.elements;return this.set(r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]),this},i.multiply=function(t){return this.multiplyMatrices(this,t)},i.premultiply=function(t){return this.multiplyMatrices(t,this)},i.multiplyMatrices=function(t,r){var n=t.elements,a=r.elements,o=this.elements,s=n[0],l=n[3],c=n[6],h=n[1],u=n[4],p=n[7],d=n[2],m=n[5],g=n[8],b=a[0],v=a[3],f=a[6],M=a[1],_=a[4],w=a[7],x=a[2],S=a[5],A=a[8];return o[0]=s*b+l*M+c*x,o[3]=s*v+l*_+c*S,o[6]=s*f+l*w+c*A,o[1]=h*b+u*M+p*x,o[4]=h*v+u*_+p*S,o[7]=h*f+u*w+p*A,o[2]=d*b+m*M+g*x,o[5]=d*v+m*_+g*S,o[8]=d*f+m*w+g*A,this},i.multiplyScalar=function(t){var r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=t,r[4]*=t,r[7]*=t,r[2]*=t,r[5]*=t,r[8]*=t,this},i.determinant=function(){var t=this.elements,r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],h=t[7],u=t[8];return r*s*u-r*l*h-n*o*u+n*l*c+a*o*h-a*s*c},i.invert=function(){var t=this.elements,r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],h=t[7],u=t[8],p=u*s-l*h,d=l*c-u*o,m=h*o-s*c,g=r*p+n*d+a*m;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);var b=1/g;return t[0]=p*b,t[1]=(a*h-u*n)*b,t[2]=(l*n-a*s)*b,t[3]=d*b,t[4]=(u*r-a*c)*b,t[5]=(a*o-l*r)*b,t[6]=m*b,t[7]=(n*c-h*r)*b,t[8]=(s*r-n*o)*b,this},i.transpose=function(){var t,r=this.elements;return t=r[1],r[1]=r[3],r[3]=t,t=r[2],r[2]=r[6],r[6]=t,t=r[5],r[5]=r[7],r[7]=t,this},i.getNormalMatrix=function(t){return this.setFromMatrix4(t).copy(this).invert().transpose()},i.transposeIntoArray=function(t){var r=this.elements;return t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8],this},i.setUvTransform=function(t,r,n,a,o,s,l){var c=Math.cos(o),h=Math.sin(o);return this.set(n*c,n*h,-n*(c*s+h*l)+s+t,-a*h,a*c,-a*(-h*s+c*l)+l+r,0,0,1),this},i.scale=function(t,r){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=r,n[4]*=r,n[7]*=r,this},i.rotate=function(t){var r=Math.cos(t),n=Math.sin(t),a=this.elements,o=a[0],s=a[3],l=a[6],c=a[1],h=a[4],u=a[7];return a[0]=r*o+n*c,a[3]=r*s+n*h,a[6]=r*l+n*u,a[1]=-n*o+r*c,a[4]=-n*s+r*h,a[7]=-n*l+r*u,this},i.translate=function(t,r){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=r*n[2],n[4]+=r*n[5],n[7]+=r*n[8],this},i.equals=function(t){for(var r=this.elements,n=t.elements,a=0;a<9;a++)if(r[a]!==n[a])return!1;return!0},i.fromArray=function(t,r){r===void 0&&(r=0);for(var n=0;n<9;n++)this.elements[n]=t[n+r];return this},i.toArray=function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var n=this.elements;return t[r]=n[0],t[r+1]=n[1],t[r+2]=n[2],t[r+3]=n[3],t[r+4]=n[4],t[r+5]=n[5],t[r+6]=n[6],t[r+7]=n[7],t[r+8]=n[8],t},e}(),Zi,gi={getDataURL:function(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement=="undefined")return e.src;var i;if(e instanceof HTMLCanvasElement)i=e;else{Zi===void 0&&(Zi=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Zi.width=e.width,Zi.height=e.height;var t=Zi.getContext("2d");e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),i=Zi}return i.width>2048||i.height>2048?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png")}},Qp=0;function Ve(e,i,t,r,n,a,o,s,l,c){e===void 0&&(e=Ve.DEFAULT_IMAGE),i===void 0&&(i=Ve.DEFAULT_MAPPING),t===void 0&&(t=At),r===void 0&&(r=At),n===void 0&&(n=mt),a===void 0&&(a=Wi),o===void 0&&(o=Dt),s===void 0&&(s=ji),l===void 0&&(l=1),c===void 0&&(c=Lt),Object.defineProperty(this,"id",{value:Qp++}),this.uuid=be.generateUUID(),this.name="",this.image=e,this.mipmaps=[],this.mapping=i,this.wrapS=t,this.wrapT=r,this.magFilter=n,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=s,this.offset=new X(0,0),this.repeat=new X(1,1),this.center=new X(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Rt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.version=0,this.onUpdate=null}Ve.DEFAULT_IMAGE=void 0,Ve.DEFAULT_MAPPING=Va,Ve.prototype=Object.assign(Object.create(ur.prototype),{constructor:Ve,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];var t={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var r=this.image;if(r.uuid===void 0&&(r.uuid=be.generateUUID()),!i&&e.images[r.uuid]===void 0){var n;if(Array.isArray(r)){n=[];for(var a=0,o=r.length;a<o;a++)r[a].isDataTexture?n.push(Ws(r[a].image)):n.push(Ws(r[a]))}else n=Ws(r);e.images[r.uuid]={uuid:r.uuid,url:n}}t.image=r.uuid}return i||(e.textures[this.uuid]=t),t},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==Va)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Fn:e.x=e.x-Math.floor(e.x);break;case At:e.x=e.x<0?0:1;break;case Gn:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Fn:e.y=e.y-Math.floor(e.y);break;case At:e.y=e.y<0?0:1;break;case Gn:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Ve.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});function Ws(e){return typeof HTMLImageElement!="undefined"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&e instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap?gi.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var We=function(){function e(t,r,n,a){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),a===void 0&&(a=1),Object.defineProperty(this,"isVector4",{value:!0}),this.x=t,this.y=r,this.z=n,this.w=a}var i=e.prototype;return i.set=function(t,r,n,a){return this.x=t,this.y=r,this.z=n,this.w=a,this},i.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},i.setX=function(t){return this.x=t,this},i.setY=function(t){return this.y=t,this},i.setZ=function(t){return this.z=t,this},i.setW=function(t){return this.w=t,this},i.setComponent=function(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;case 3:this.w=r;break;default:throw new Error("index is out of range: "+t)}return this},i.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},i.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},i.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this},i.add=function(t,r){return r!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,r)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},i.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},i.addVectors=function(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this.w=t.w+r.w,this},i.addScaledVector=function(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this.w+=t.w*r,this},i.sub=function(t,r){return r!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,r)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},i.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},i.subVectors=function(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this.w=t.w-r.w,this},i.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},i.applyMatrix4=function(t){var r=this.x,n=this.y,a=this.z,o=this.w,s=t.elements;return this.x=s[0]*r+s[4]*n+s[8]*a+s[12]*o,this.y=s[1]*r+s[5]*n+s[9]*a+s[13]*o,this.z=s[2]*r+s[6]*n+s[10]*a+s[14]*o,this.w=s[3]*r+s[7]*n+s[11]*a+s[15]*o,this},i.divideScalar=function(t){return this.multiplyScalar(1/t)},i.setAxisAngleFromQuaternion=function(t){this.w=2*Math.acos(t.w);var r=Math.sqrt(1-t.w*t.w);return r<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/r,this.y=t.y/r,this.z=t.z/r),this},i.setAxisAngleFromRotationMatrix=function(t){var r,n,a,o,s=.01,l=.1,c=t.elements,h=c[0],u=c[4],p=c[8],d=c[1],m=c[5],g=c[9],b=c[2],v=c[6],f=c[10];if(Math.abs(u-d)<s&&Math.abs(p-b)<s&&Math.abs(g-v)<s){if(Math.abs(u+d)<l&&Math.abs(p+b)<l&&Math.abs(g+v)<l&&Math.abs(h+m+f-3)<l)return this.set(1,0,0,0),this;r=Math.PI;var M=(h+1)/2,_=(m+1)/2,w=(f+1)/2,x=(u+d)/4,S=(p+b)/4,A=(g+v)/4;return M>_&&M>w?M<s?(n=0,a=.707106781,o=.707106781):(n=Math.sqrt(M),a=x/n,o=S/n):_>w?_<s?(n=.707106781,a=0,o=.707106781):(a=Math.sqrt(_),n=x/a,o=A/a):w<s?(n=.707106781,a=.707106781,o=0):(o=Math.sqrt(w),n=S/o,a=A/o),this.set(n,a,o,r),this}var I=Math.sqrt((v-g)*(v-g)+(p-b)*(p-b)+(d-u)*(d-u));return Math.abs(I)<.001&&(I=1),this.x=(v-g)/I,this.y=(p-b)/I,this.z=(d-u)/I,this.w=Math.acos((h+m+f-1)/2),this},i.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},i.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},i.clamp=function(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this.z=Math.max(t.z,Math.min(r.z,this.z)),this.w=Math.max(t.w,Math.min(r.w,this.w)),this},i.clampScalar=function(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this.z=Math.max(t,Math.min(r,this.z)),this.w=Math.max(t,Math.min(r,this.w)),this},i.clampLength=function(t,r){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(r,n)))},i.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},i.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},i.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},i.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},i.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},i.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},i.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},i.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},i.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},i.normalize=function(){return this.divideScalar(this.length()||1)},i.setLength=function(t){return this.normalize().multiplyScalar(t)},i.lerp=function(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this.w+=(t.w-this.w)*r,this},i.lerpVectors=function(t,r,n){return this.x=t.x+(r.x-t.x)*n,this.y=t.y+(r.y-t.y)*n,this.z=t.z+(r.z-t.z)*n,this.w=t.w+(r.w-t.w)*n,this},i.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},i.fromArray=function(t,r){return r===void 0&&(r=0),this.x=t[r],this.y=t[r+1],this.z=t[r+2],this.w=t[r+3],this},i.toArray=function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t[r+3]=this.w,t},i.fromBufferAttribute=function(t,r,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this.w=t.getW(r),this},i.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},eo(e,[{key:"width",get:function(){return this.z},set:function(t){this.z=t}},{key:"height",get:function(){return this.w},set:function(t){this.w=t}}]),e}();function Bt(e,i,t){this.width=e,this.height=i,this.scissor=new We(0,0,e,i),this.scissorTest=!1,this.viewport=new We(0,0,e,i),t=t||{},this.texture=new Ve(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=i,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:mt,this.depthBuffer=t.depthBuffer!==void 0?t.depthBuffer:!0,this.stencilBuffer=t.stencilBuffer!==void 0?t.stencilBuffer:!1,this.depthTexture=t.depthTexture!==void 0?t.depthTexture:null}Bt.prototype=Object.assign(Object.create(ur.prototype),{constructor:Bt,isWebGLRenderTarget:!0,setSize:function(e,i){(this.width!==e||this.height!==i)&&(this.width=e,this.height=i,this.texture.image.width=e,this.texture.image.height=i,this.dispose()),this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function js(e,i,t){Bt.call(this,e,i,t),this.samples=4}js.prototype=Object.assign(Object.create(Bt.prototype),{constructor:js,isWebGLMultisampleRenderTarget:!0,copy:function(e){return Bt.prototype.copy.call(this,e),this.samples=e.samples,this}});var _t=function(){function e(t,r,n,a){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),a===void 0&&(a=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=t,this._y=r,this._z=n,this._w=a}e.slerp=function(t,r,n,a){return n.copy(t).slerp(r,a)},e.slerpFlat=function(t,r,n,a,o,s,l){var c=n[a+0],h=n[a+1],u=n[a+2],p=n[a+3],d=o[s+0],m=o[s+1],g=o[s+2],b=o[s+3];if(p!==b||c!==d||h!==m||u!==g){var v=1-l,f=c*d+h*m+u*g+p*b,M=f>=0?1:-1,_=1-f*f;if(_>Number.EPSILON){var w=Math.sqrt(_),x=Math.atan2(w,f*M);v=Math.sin(v*x)/w,l=Math.sin(l*x)/w}var S=l*M;if(c=c*v+d*S,h=h*v+m*S,u=u*v+g*S,p=p*v+b*S,v===1-l){var A=1/Math.sqrt(c*c+h*h+u*u+p*p);c*=A,h*=A,u*=A,p*=A}}t[r]=c,t[r+1]=h,t[r+2]=u,t[r+3]=p},e.multiplyQuaternionsFlat=function(t,r,n,a,o,s){var l=n[a],c=n[a+1],h=n[a+2],u=n[a+3],p=o[s],d=o[s+1],m=o[s+2],g=o[s+3];return t[r]=l*g+u*p+c*m-h*d,t[r+1]=c*g+u*d+h*p-l*m,t[r+2]=h*g+u*m+l*d-c*p,t[r+3]=u*g-l*p-c*d-h*m,t};var i=e.prototype;return i.set=function(t,r,n,a){return this._x=t,this._y=r,this._z=n,this._w=a,this._onChangeCallback(),this},i.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},i.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},i.setFromEuler=function(t,r){if(!(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,a=t._y,o=t._z,s=t._order,l=Math.cos,c=Math.sin,h=l(n/2),u=l(a/2),p=l(o/2),d=c(n/2),m=c(a/2),g=c(o/2);switch(s){case"XYZ":this._x=d*u*p+h*m*g,this._y=h*m*p-d*u*g,this._z=h*u*g+d*m*p,this._w=h*u*p-d*m*g;break;case"YXZ":this._x=d*u*p+h*m*g,this._y=h*m*p-d*u*g,this._z=h*u*g-d*m*p,this._w=h*u*p+d*m*g;break;case"ZXY":this._x=d*u*p-h*m*g,this._y=h*m*p+d*u*g,this._z=h*u*g+d*m*p,this._w=h*u*p-d*m*g;break;case"ZYX":this._x=d*u*p-h*m*g,this._y=h*m*p+d*u*g,this._z=h*u*g-d*m*p,this._w=h*u*p+d*m*g;break;case"YZX":this._x=d*u*p+h*m*g,this._y=h*m*p+d*u*g,this._z=h*u*g-d*m*p,this._w=h*u*p-d*m*g;break;case"XZY":this._x=d*u*p-h*m*g,this._y=h*m*p-d*u*g,this._z=h*u*g+d*m*p,this._w=h*u*p+d*m*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return r!==!1&&this._onChangeCallback(),this},i.setFromAxisAngle=function(t,r){var n=r/2,a=Math.sin(n);return this._x=t.x*a,this._y=t.y*a,this._z=t.z*a,this._w=Math.cos(n),this._onChangeCallback(),this},i.setFromRotationMatrix=function(t){var r=t.elements,n=r[0],a=r[4],o=r[8],s=r[1],l=r[5],c=r[9],h=r[2],u=r[6],p=r[10],d=n+l+p;if(d>0){var m=.5/Math.sqrt(d+1);this._w=.25/m,this._x=(u-c)*m,this._y=(o-h)*m,this._z=(s-a)*m}else if(n>l&&n>p){var g=2*Math.sqrt(1+n-l-p);this._w=(u-c)/g,this._x=.25*g,this._y=(a+s)/g,this._z=(o+h)/g}else if(l>p){var b=2*Math.sqrt(1+l-n-p);this._w=(o-h)/b,this._x=(a+s)/b,this._y=.25*b,this._z=(c+u)/b}else{var v=2*Math.sqrt(1+p-n-l);this._w=(s-a)/v,this._x=(o+h)/v,this._y=(c+u)/v,this._z=.25*v}return this._onChangeCallback(),this},i.setFromUnitVectors=function(t,r){var n=1e-6,a=t.dot(r)+1;return a<n?(a=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=a):(this._x=0,this._y=-t.z,this._z=t.y,this._w=a)):(this._x=t.y*r.z-t.z*r.y,this._y=t.z*r.x-t.x*r.z,this._z=t.x*r.y-t.y*r.x,this._w=a),this.normalize()},i.angleTo=function(t){return 2*Math.acos(Math.abs(be.clamp(this.dot(t),-1,1)))},i.rotateTowards=function(t,r){var n=this.angleTo(t);if(n===0)return this;var a=Math.min(1,r/n);return this.slerp(t,a),this},i.identity=function(){return this.set(0,0,0,1)},i.invert=function(){return this.conjugate()},i.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},i.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},i.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},i.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},i.normalize=function(){var t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},i.multiply=function(t,r){return r!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,r)):this.multiplyQuaternions(this,t)},i.premultiply=function(t){return this.multiplyQuaternions(t,this)},i.multiplyQuaternions=function(t,r){var n=t._x,a=t._y,o=t._z,s=t._w,l=r._x,c=r._y,h=r._z,u=r._w;return this._x=n*u+s*l+a*h-o*c,this._y=a*u+s*c+o*l-n*h,this._z=o*u+s*h+n*c-a*l,this._w=s*u-n*l-a*c-o*h,this._onChangeCallback(),this},i.slerp=function(t,r){if(r===0)return this;if(r===1)return this.copy(t);var n=this._x,a=this._y,o=this._z,s=this._w,l=s*t._w+n*t._x+a*t._y+o*t._z;if(l<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,l=-l):this.copy(t),l>=1)return this._w=s,this._x=n,this._y=a,this._z=o,this;var c=1-l*l;if(c<=Number.EPSILON){var h=1-r;return this._w=h*s+r*this._w,this._x=h*n+r*this._x,this._y=h*a+r*this._y,this._z=h*o+r*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(c),p=Math.atan2(u,l),d=Math.sin((1-r)*p)/u,m=Math.sin(r*p)/u;return this._w=s*d+this._w*m,this._x=n*d+this._x*m,this._y=a*d+this._y*m,this._z=o*d+this._z*m,this._onChangeCallback(),this},i.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},i.fromArray=function(t,r){return r===void 0&&(r=0),this._x=t[r],this._y=t[r+1],this._z=t[r+2],this._w=t[r+3],this._onChangeCallback(),this},i.toArray=function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._w,t},i.fromBufferAttribute=function(t,r){return this._x=t.getX(r),this._y=t.getY(r),this._z=t.getZ(r),this._w=t.getW(r),this},i._onChange=function(t){return this._onChangeCallback=t,this},i._onChangeCallback=function(){},eo(e,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}]),e}(),T=function(){function e(t,r,n){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=r,this.z=n}var i=e.prototype;return i.set=function(t,r,n){return n===void 0&&(n=this.z),this.x=t,this.y=r,this.z=n,this},i.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this},i.setX=function(t){return this.x=t,this},i.setY=function(t){return this.y=t,this},i.setZ=function(t){return this.z=t,this},i.setComponent=function(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;default:throw new Error("index is out of range: "+t)}return this},i.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},i.clone=function(){return new this.constructor(this.x,this.y,this.z)},i.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},i.add=function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,r)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},i.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},i.addVectors=function(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this},i.addScaledVector=function(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this},i.sub=function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,r)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},i.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},i.subVectors=function(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this},i.multiply=function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,r)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},i.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},i.multiplyVectors=function(t,r){return this.x=t.x*r.x,this.y=t.y*r.y,this.z=t.z*r.z,this},i.applyEuler=function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(th.setFromEuler(t))},i.applyAxisAngle=function(t,r){return this.applyQuaternion(th.setFromAxisAngle(t,r))},i.applyMatrix3=function(t){var r=this.x,n=this.y,a=this.z,o=t.elements;return this.x=o[0]*r+o[3]*n+o[6]*a,this.y=o[1]*r+o[4]*n+o[7]*a,this.z=o[2]*r+o[5]*n+o[8]*a,this},i.applyNormalMatrix=function(t){return this.applyMatrix3(t).normalize()},i.applyMatrix4=function(t){var r=this.x,n=this.y,a=this.z,o=t.elements,s=1/(o[3]*r+o[7]*n+o[11]*a+o[15]);return this.x=(o[0]*r+o[4]*n+o[8]*a+o[12])*s,this.y=(o[1]*r+o[5]*n+o[9]*a+o[13])*s,this.z=(o[2]*r+o[6]*n+o[10]*a+o[14])*s,this},i.applyQuaternion=function(t){var r=this.x,n=this.y,a=this.z,o=t.x,s=t.y,l=t.z,c=t.w,h=c*r+s*a-l*n,u=c*n+l*r-o*a,p=c*a+o*n-s*r,d=-o*r-s*n-l*a;return this.x=h*c+d*-o+u*-l-p*-s,this.y=u*c+d*-s+p*-o-h*-l,this.z=p*c+d*-l+h*-s-u*-o,this},i.project=function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},i.unproject=function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},i.transformDirection=function(t){var r=this.x,n=this.y,a=this.z,o=t.elements;return this.x=o[0]*r+o[4]*n+o[8]*a,this.y=o[1]*r+o[5]*n+o[9]*a,this.z=o[2]*r+o[6]*n+o[10]*a,this.normalize()},i.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},i.divideScalar=function(t){return this.multiplyScalar(1/t)},i.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},i.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},i.clamp=function(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this.z=Math.max(t.z,Math.min(r.z,this.z)),this},i.clampScalar=function(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this.z=Math.max(t,Math.min(r,this.z)),this},i.clampLength=function(t,r){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(r,n)))},i.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},i.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},i.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},i.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},i.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},i.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},i.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},i.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},i.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},i.normalize=function(){return this.divideScalar(this.length()||1)},i.setLength=function(t){return this.normalize().multiplyScalar(t)},i.lerp=function(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this},i.lerpVectors=function(t,r,n){return this.x=t.x+(r.x-t.x)*n,this.y=t.y+(r.y-t.y)*n,this.z=t.z+(r.z-t.z)*n,this},i.cross=function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,r)):this.crossVectors(this,t)},i.crossVectors=function(t,r){var n=t.x,a=t.y,o=t.z,s=r.x,l=r.y,c=r.z;return this.x=a*c-o*l,this.y=o*s-n*c,this.z=n*l-a*s,this},i.projectOnVector=function(t){var r=t.lengthSq();if(r===0)return this.set(0,0,0);var n=t.dot(this)/r;return this.copy(t).multiplyScalar(n)},i.projectOnPlane=function(t){return qs.copy(this).projectOnVector(t),this.sub(qs)},i.reflect=function(t){return this.sub(qs.copy(t).multiplyScalar(2*this.dot(t)))},i.angleTo=function(t){var r=Math.sqrt(this.lengthSq()*t.lengthSq());if(r===0)return Math.PI/2;var n=this.dot(t)/r;return Math.acos(be.clamp(n,-1,1))},i.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},i.distanceToSquared=function(t){var r=this.x-t.x,n=this.y-t.y,a=this.z-t.z;return r*r+n*n+a*a},i.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},i.setFromSpherical=function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},i.setFromSphericalCoords=function(t,r,n){var a=Math.sin(r)*t;return this.x=a*Math.sin(n),this.y=Math.cos(r)*t,this.z=a*Math.cos(n),this},i.setFromCylindrical=function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},i.setFromCylindricalCoords=function(t,r,n){return this.x=t*Math.sin(r),this.y=n,this.z=t*Math.cos(r),this},i.setFromMatrixPosition=function(t){var r=t.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this},i.setFromMatrixScale=function(t){var r=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),a=this.setFromMatrixColumn(t,2).length();return this.x=r,this.y=n,this.z=a,this},i.setFromMatrixColumn=function(t,r){return this.fromArray(t.elements,r*4)},i.setFromMatrix3Column=function(t,r){return this.fromArray(t.elements,r*3)},i.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},i.fromArray=function(t,r){return r===void 0&&(r=0),this.x=t[r],this.y=t[r+1],this.z=t[r+2],this},i.toArray=function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t},i.fromBufferAttribute=function(t,r,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this},i.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},e}(),qs=new T,th=new _t,hr=function(){function e(t,r){Object.defineProperty(this,"isBox3",{value:!0}),this.min=t!==void 0?t:new T(Infinity,Infinity,Infinity),this.max=r!==void 0?r:new T(-Infinity,-Infinity,-Infinity)}var i=e.prototype;return i.set=function(t,r){return this.min.copy(t),this.max.copy(r),this},i.setFromArray=function(t){for(var r=Infinity,n=Infinity,a=Infinity,o=-Infinity,s=-Infinity,l=-Infinity,c=0,h=t.length;c<h;c+=3){var u=t[c],p=t[c+1],d=t[c+2];u<r&&(r=u),p<n&&(n=p),d<a&&(a=d),u>o&&(o=u),p>s&&(s=p),d>l&&(l=d)}return this.min.set(r,n,a),this.max.set(o,s,l),this},i.setFromBufferAttribute=function(t){for(var r=Infinity,n=Infinity,a=Infinity,o=-Infinity,s=-Infinity,l=-Infinity,c=0,h=t.count;c<h;c++){var u=t.getX(c),p=t.getY(c),d=t.getZ(c);u<r&&(r=u),p<n&&(n=p),d<a&&(a=d),u>o&&(o=u),p>s&&(s=p),d>l&&(l=d)}return this.min.set(r,n,a),this.max.set(o,s,l),this},i.setFromPoints=function(t){this.makeEmpty();for(var r=0,n=t.length;r<n;r++)this.expandByPoint(t[r]);return this},i.setFromCenterAndSize=function(t,r){var n=Jn.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},i.setFromObject=function(t){return this.makeEmpty(),this.expandByObject(t)},i.clone=function(){return new this.constructor().copy(this)},i.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},i.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-Infinity,this},i.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},i.getCenter=function(t){return t===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new T),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},i.getSize=function(t){return t===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new T),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},i.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},i.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},i.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},i.expandByObject=function(t){t.updateWorldMatrix(!1,!1);var r=t.geometry;r!==void 0&&(r.boundingBox===null&&r.computeBoundingBox(),Ys.copy(r.boundingBox),Ys.applyMatrix4(t.matrixWorld),this.union(Ys));for(var n=t.children,a=0,o=n.length;a<o;a++)this.expandByObject(n[a]);return this},i.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},i.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},i.getParameter=function(t,r){return r===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),r=new T),r.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},i.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},i.intersectsSphere=function(t){return this.clampPoint(t.center,Jn),Jn.distanceToSquared(t.center)<=t.radius*t.radius},i.intersectsPlane=function(t){var r,n;return t.normal.x>0?(r=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(r=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(r+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(r+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(r+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(r+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),r<=-t.constant&&n>=-t.constant},i.intersectsTriangle=function(t){if(this.isEmpty())return!1;this.getCenter(Kn),to.subVectors(this.max,Kn),Ji.subVectors(t.a,Kn),Ki.subVectors(t.b,Kn),Qi.subVectors(t.c,Kn),kr.subVectors(Ki,Ji),Vr.subVectors(Qi,Ki),yi.subVectors(Ji,Qi);var r=[0,-kr.z,kr.y,0,-Vr.z,Vr.y,0,-yi.z,yi.y,kr.z,0,-kr.x,Vr.z,0,-Vr.x,yi.z,0,-yi.x,-kr.y,kr.x,0,-Vr.y,Vr.x,0,-yi.y,yi.x,0];return!Xs(r,Ji,Ki,Qi,to)||(r=[1,0,0,0,1,0,0,0,1],!Xs(r,Ji,Ki,Qi,to))?!1:(ro.crossVectors(kr,Vr),r=[ro.x,ro.y,ro.z],Xs(r,Ji,Ki,Qi,to))},i.clampPoint=function(t,r){return r===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),r=new T),r.copy(t).clamp(this.min,this.max)},i.distanceToPoint=function(t){var r=Jn.copy(t).clamp(this.min,this.max);return r.sub(t).length()},i.getBoundingSphere=function(t){return t===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=this.getSize(Jn).length()*.5,t},i.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},i.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},i.applyMatrix4=function(t){return this.isEmpty()?this:(Tr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Tr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Tr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Tr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Tr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Tr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Tr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Tr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Tr),this)},i.translate=function(t){return this.min.add(t),this.max.add(t),this},i.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},e}();function Xs(e,i,t,r,n){for(var a=0,o=e.length-3;a<=o;a+=3){xi.fromArray(e,a);var s=n.x*Math.abs(xi.x)+n.y*Math.abs(xi.y)+n.z*Math.abs(xi.z),l=i.dot(xi),c=t.dot(xi),h=r.dot(xi);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>s)return!1}return!0}var Tr=[new T,new T,new T,new T,new T,new T,new T,new T],Jn=new T,Ys=new hr,Ji=new T,Ki=new T,Qi=new T,kr=new T,Vr=new T,yi=new T,Kn=new T,to=new T,ro=new T,xi=new T,$p=new hr,Er=function(){function e(t,r){this.center=t!==void 0?t:new T,this.radius=r!==void 0?r:-1}var i=e.prototype;return i.set=function(t,r){return this.center.copy(t),this.radius=r,this},i.setFromPoints=function(t,r){var n=this.center;r!==void 0?n.copy(r):$p.setFromPoints(t).getCenter(n);for(var a=0,o=0,s=t.length;o<s;o++)a=Math.max(a,n.distanceToSquared(t[o]));return this.radius=Math.sqrt(a),this},i.clone=function(){return new this.constructor().copy(this)},i.copy=function(t){return this.center.copy(t.center),this.radius=t.radius,this},i.isEmpty=function(){return this.radius<0},i.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},i.containsPoint=function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},i.distanceToPoint=function(t){return t.distanceTo(this.center)-this.radius},i.intersectsSphere=function(t){var r=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=r*r},i.intersectsBox=function(t){return t.intersectsSphere(this)},i.intersectsPlane=function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},i.clampPoint=function(t,r){var n=this.center.distanceToSquared(t);return r===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),r=new T),r.copy(t),n>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},i.getBoundingBox=function(t){return t===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new hr),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},i.applyMatrix4=function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},i.translate=function(t){return this.center.add(t),this},i.equals=function(t){return t.center.equals(this.center)&&t.radius===this.radius},e}(),Ar=new T,Zs=new T,io=new T,Wr=new T,Js=new T,no=new T,Ks=new T,$i=function(){function e(t,r){this.origin=t!==void 0?t:new T,this.direction=r!==void 0?r:new T(0,0,-1)}var i=e.prototype;return i.set=function(t,r){return this.origin.copy(t),this.direction.copy(r),this},i.clone=function(){return new this.constructor().copy(this)},i.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},i.at=function(t,r){return r===void 0&&(console.warn("THREE.Ray: .at() target is now required"),r=new T),r.copy(this.direction).multiplyScalar(t).add(this.origin)},i.lookAt=function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},i.recast=function(t){return this.origin.copy(this.at(t,Ar)),this},i.closestPointToPoint=function(t,r){r===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),r=new T),r.subVectors(t,this.origin);var n=r.dot(this.direction);return n<0?r.copy(this.origin):r.copy(this.direction).multiplyScalar(n).add(this.origin)},i.distanceToPoint=function(t){return Math.sqrt(this.distanceSqToPoint(t))},i.distanceSqToPoint=function(t){var r=Ar.subVectors(t,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(t):(Ar.copy(this.direction).multiplyScalar(r).add(this.origin),Ar.distanceToSquared(t))},i.distanceSqToSegment=function(t,r,n,a){Zs.copy(t).add(r).multiplyScalar(.5),io.copy(r).sub(t).normalize(),Wr.copy(this.origin).sub(Zs);var o=t.distanceTo(r)*.5,s=-this.direction.dot(io),l=Wr.dot(this.direction),c=-Wr.dot(io),h=Wr.lengthSq(),u=Math.abs(1-s*s),p,d,m,g;if(u>0)if(p=s*c-l,d=s*l-c,g=o*u,p>=0)if(d>=-g)if(d<=g){var b=1/u;p*=b,d*=b,m=p*(p+s*d+2*l)+d*(s*p+d+2*c)+h}else d=o,p=Math.max(0,-(s*d+l)),m=-p*p+d*(d+2*c)+h;else d=-o,p=Math.max(0,-(s*d+l)),m=-p*p+d*(d+2*c)+h;else d<=-g?(p=Math.max(0,-(-s*o+l)),d=p>0?-o:Math.min(Math.max(-o,-c),o),m=-p*p+d*(d+2*c)+h):d<=g?(p=0,d=Math.min(Math.max(-o,-c),o),m=d*(d+2*c)+h):(p=Math.max(0,-(s*o+l)),d=p>0?o:Math.min(Math.max(-o,-c),o),m=-p*p+d*(d+2*c)+h);else d=s>0?-o:o,p=Math.max(0,-(s*d+l)),m=-p*p+d*(d+2*c)+h;return n&&n.copy(this.direction).multiplyScalar(p).add(this.origin),a&&a.copy(io).multiplyScalar(d).add(Zs),m},i.intersectSphere=function(t,r){Ar.subVectors(t.center,this.origin);var n=Ar.dot(this.direction),a=Ar.dot(Ar)-n*n,o=t.radius*t.radius;if(a>o)return null;var s=Math.sqrt(o-a),l=n-s,c=n+s;return l<0&&c<0?null:l<0?this.at(c,r):this.at(l,r)},i.intersectsSphere=function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},i.distanceToPlane=function(t){var r=t.normal.dot(this.direction);if(r===0)return t.distanceToPoint(this.origin)===0?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/r;return n>=0?n:null},i.intersectPlane=function(t,r){var n=this.distanceToPlane(t);return n===null?null:this.at(n,r)},i.intersectsPlane=function(t){var r=t.distanceToPoint(this.origin);if(r===0)return!0;var n=t.normal.dot(this.direction);return n*r<0},i.intersectBox=function(t,r){var n,a,o,s,l,c,h=1/this.direction.x,u=1/this.direction.y,p=1/this.direction.z,d=this.origin;return h>=0?(n=(t.min.x-d.x)*h,a=(t.max.x-d.x)*h):(n=(t.max.x-d.x)*h,a=(t.min.x-d.x)*h),u>=0?(o=(t.min.y-d.y)*u,s=(t.max.y-d.y)*u):(o=(t.max.y-d.y)*u,s=(t.min.y-d.y)*u),n>s||o>a||((o>n||n!==n)&&(n=o),(s<a||a!==a)&&(a=s),p>=0?(l=(t.min.z-d.z)*p,c=(t.max.z-d.z)*p):(l=(t.max.z-d.z)*p,c=(t.min.z-d.z)*p),n>c||l>a)||((l>n||n!==n)&&(n=l),(c<a||a!==a)&&(a=c),a<0)?null:this.at(n>=0?n:a,r)},i.intersectsBox=function(t){return this.intersectBox(t,Ar)!==null},i.intersectTriangle=function(t,r,n,a,o){Js.subVectors(r,t),no.subVectors(n,t),Ks.crossVectors(Js,no);var s=this.direction.dot(Ks),l;if(s>0){if(a)return null;l=1}else if(s<0)l=-1,s=-s;else return null;Wr.subVectors(this.origin,t);var c=l*this.direction.dot(no.crossVectors(Wr,no));if(c<0)return null;var h=l*this.direction.dot(Js.cross(Wr));if(h<0||c+h>s)return null;var u=-l*Wr.dot(Ks);return u<0?null:this.at(u/s,o)},i.applyMatrix4=function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},i.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},e}(),Te=function(){function e(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var i=e.prototype;return i.set=function(t,r,n,a,o,s,l,c,h,u,p,d,m,g,b,v){var f=this.elements;return f[0]=t,f[4]=r,f[8]=n,f[12]=a,f[1]=o,f[5]=s,f[9]=l,f[13]=c,f[2]=h,f[6]=u,f[10]=p,f[14]=d,f[3]=m,f[7]=g,f[11]=b,f[15]=v,this},i.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},i.clone=function(){return new e().fromArray(this.elements)},i.copy=function(t){var r=this.elements,n=t.elements;return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],this},i.copyPosition=function(t){var r=this.elements,n=t.elements;return r[12]=n[12],r[13]=n[13],r[14]=n[14],this},i.extractBasis=function(t,r,n){return t.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},i.makeBasis=function(t,r,n){return this.set(t.x,r.x,n.x,0,t.y,r.y,n.y,0,t.z,r.z,n.z,0,0,0,0,1),this},i.extractRotation=function(t){var r=this.elements,n=t.elements,a=1/en.setFromMatrixColumn(t,0).length(),o=1/en.setFromMatrixColumn(t,1).length(),s=1/en.setFromMatrixColumn(t,2).length();return r[0]=n[0]*a,r[1]=n[1]*a,r[2]=n[2]*a,r[3]=0,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[7]=0,r[8]=n[8]*s,r[9]=n[9]*s,r[10]=n[10]*s,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},i.makeRotationFromEuler=function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var r=this.elements,n=t.x,a=t.y,o=t.z,s=Math.cos(n),l=Math.sin(n),c=Math.cos(a),h=Math.sin(a),u=Math.cos(o),p=Math.sin(o);if(t.order==="XYZ"){var d=s*u,m=s*p,g=l*u,b=l*p;r[0]=c*u,r[4]=-c*p,r[8]=h,r[1]=m+g*h,r[5]=d-b*h,r[9]=-l*c,r[2]=b-d*h,r[6]=g+m*h,r[10]=s*c}else if(t.order==="YXZ"){var v=c*u,f=c*p,M=h*u,_=h*p;r[0]=v+_*l,r[4]=M*l-f,r[8]=s*h,r[1]=s*p,r[5]=s*u,r[9]=-l,r[2]=f*l-M,r[6]=_+v*l,r[10]=s*c}else if(t.order==="ZXY"){var w=c*u,x=c*p,S=h*u,A=h*p;r[0]=w-A*l,r[4]=-s*p,r[8]=S+x*l,r[1]=x+S*l,r[5]=s*u,r[9]=A-w*l,r[2]=-s*h,r[6]=l,r[10]=s*c}else if(t.order==="ZYX"){var I=s*u,P=s*p,R=l*u,N=l*p;r[0]=c*u,r[4]=R*h-P,r[8]=I*h+N,r[1]=c*p,r[5]=N*h+I,r[9]=P*h-R,r[2]=-h,r[6]=l*c,r[10]=s*c}else if(t.order==="YZX"){var D=s*c,B=s*h,O=l*c,U=l*h;r[0]=c*u,r[4]=U-D*p,r[8]=O*p+B,r[1]=p,r[5]=s*u,r[9]=-l*u,r[2]=-h*u,r[6]=B*p+O,r[10]=D-U*p}else if(t.order==="XZY"){var F=s*c,k=s*h,W=l*c,Y=l*h;r[0]=c*u,r[4]=-p,r[8]=h*u,r[1]=F*p+Y,r[5]=s*u,r[9]=k*p-W,r[2]=W*p-k,r[6]=l*u,r[10]=Y*p+F}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},i.makeRotationFromQuaternion=function(t){return this.compose(ef,t,tf)},i.lookAt=function(t,r,n){var a=this.elements;return zt.subVectors(t,r),zt.lengthSq()===0&&(zt.z=1),zt.normalize(),jr.crossVectors(n,zt),jr.lengthSq()===0&&(Math.abs(n.z)===1?zt.x+=1e-4:zt.z+=1e-4,zt.normalize(),jr.crossVectors(n,zt)),jr.normalize(),ao.crossVectors(zt,jr),a[0]=jr.x,a[4]=ao.x,a[8]=zt.x,a[1]=jr.y,a[5]=ao.y,a[9]=zt.y,a[2]=jr.z,a[6]=ao.z,a[10]=zt.z,this},i.multiply=function(t,r){return r!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,r)):this.multiplyMatrices(this,t)},i.premultiply=function(t){return this.multiplyMatrices(t,this)},i.multiplyMatrices=function(t,r){var n=t.elements,a=r.elements,o=this.elements,s=n[0],l=n[4],c=n[8],h=n[12],u=n[1],p=n[5],d=n[9],m=n[13],g=n[2],b=n[6],v=n[10],f=n[14],M=n[3],_=n[7],w=n[11],x=n[15],S=a[0],A=a[4],I=a[8],P=a[12],R=a[1],N=a[5],D=a[9],B=a[13],O=a[2],U=a[6],F=a[10],k=a[14],W=a[3],Y=a[7],j=a[11],Z=a[15];return o[0]=s*S+l*R+c*O+h*W,o[4]=s*A+l*N+c*U+h*Y,o[8]=s*I+l*D+c*F+h*j,o[12]=s*P+l*B+c*k+h*Z,o[1]=u*S+p*R+d*O+m*W,o[5]=u*A+p*N+d*U+m*Y,o[9]=u*I+p*D+d*F+m*j,o[13]=u*P+p*B+d*k+m*Z,o[2]=g*S+b*R+v*O+f*W,o[6]=g*A+b*N+v*U+f*Y,o[10]=g*I+b*D+v*F+f*j,o[14]=g*P+b*B+v*k+f*Z,o[3]=M*S+_*R+w*O+x*W,o[7]=M*A+_*N+w*U+x*Y,o[11]=M*I+_*D+w*F+x*j,o[15]=M*P+_*B+w*k+x*Z,this},i.multiplyScalar=function(t){var r=this.elements;return r[0]*=t,r[4]*=t,r[8]*=t,r[12]*=t,r[1]*=t,r[5]*=t,r[9]*=t,r[13]*=t,r[2]*=t,r[6]*=t,r[10]*=t,r[14]*=t,r[3]*=t,r[7]*=t,r[11]*=t,r[15]*=t,this},i.determinant=function(){var t=this.elements,r=t[0],n=t[4],a=t[8],o=t[12],s=t[1],l=t[5],c=t[9],h=t[13],u=t[2],p=t[6],d=t[10],m=t[14],g=t[3],b=t[7],v=t[11],f=t[15];return g*(+o*c*p-a*h*p-o*l*d+n*h*d+a*l*m-n*c*m)+b*(+r*c*m-r*h*d+o*s*d-a*s*m+a*h*u-o*c*u)+v*(+r*h*p-r*l*m-o*s*p+n*s*m+o*l*u-n*h*u)+f*(-a*l*u-r*c*p+r*l*d+a*s*p-n*s*d+n*c*u)},i.transpose=function(){var t=this.elements,r;return r=t[1],t[1]=t[4],t[4]=r,r=t[2],t[2]=t[8],t[8]=r,r=t[6],t[6]=t[9],t[9]=r,r=t[3],t[3]=t[12],t[12]=r,r=t[7],t[7]=t[13],t[13]=r,r=t[11],t[11]=t[14],t[14]=r,this},i.setPosition=function(t,r,n){var a=this.elements;return t.isVector3?(a[12]=t.x,a[13]=t.y,a[14]=t.z):(a[12]=t,a[13]=r,a[14]=n),this},i.invert=function(){var t=this.elements,r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],h=t[7],u=t[8],p=t[9],d=t[10],m=t[11],g=t[12],b=t[13],v=t[14],f=t[15],M=p*v*h-b*d*h+b*c*m-l*v*m-p*c*f+l*d*f,_=g*d*h-u*v*h-g*c*m+s*v*m+u*c*f-s*d*f,w=u*b*h-g*p*h+g*l*m-s*b*m-u*l*f+s*p*f,x=g*p*c-u*b*c-g*l*d+s*b*d+u*l*v-s*p*v,S=r*M+n*_+a*w+o*x;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var A=1/S;return t[0]=M*A,t[1]=(b*d*o-p*v*o-b*a*m+n*v*m+p*a*f-n*d*f)*A,t[2]=(l*v*o-b*c*o+b*a*h-n*v*h-l*a*f+n*c*f)*A,t[3]=(p*c*o-l*d*o-p*a*h+n*d*h+l*a*m-n*c*m)*A,t[4]=_*A,t[5]=(u*v*o-g*d*o+g*a*m-r*v*m-u*a*f+r*d*f)*A,t[6]=(g*c*o-s*v*o-g*a*h+r*v*h+s*a*f-r*c*f)*A,t[7]=(s*d*o-u*c*o+u*a*h-r*d*h-s*a*m+r*c*m)*A,t[8]=w*A,t[9]=(g*p*o-u*b*o-g*n*m+r*b*m+u*n*f-r*p*f)*A,t[10]=(s*b*o-g*l*o+g*n*h-r*b*h-s*n*f+r*l*f)*A,t[11]=(u*l*o-s*p*o-u*n*h+r*p*h+s*n*m-r*l*m)*A,t[12]=x*A,t[13]=(u*b*a-g*p*a+g*n*d-r*b*d-u*n*v+r*p*v)*A,t[14]=(g*l*a-s*b*a-g*n*c+r*b*c+s*n*v-r*l*v)*A,t[15]=(s*p*a-u*l*a+u*n*c-r*p*c-s*n*d+r*l*d)*A,this},i.scale=function(t){var r=this.elements,n=t.x,a=t.y,o=t.z;return r[0]*=n,r[4]*=a,r[8]*=o,r[1]*=n,r[5]*=a,r[9]*=o,r[2]*=n,r[6]*=a,r[10]*=o,r[3]*=n,r[7]*=a,r[11]*=o,this},i.getMaxScaleOnAxis=function(){var t=this.elements,r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],a=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(r,n,a))},i.makeTranslation=function(t,r,n){return this.set(1,0,0,t,0,1,0,r,0,0,1,n,0,0,0,1),this},i.makeRotationX=function(t){var r=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,r,-n,0,0,n,r,0,0,0,0,1),this},i.makeRotationY=function(t){var r=Math.cos(t),n=Math.sin(t);return this.set(r,0,n,0,0,1,0,0,-n,0,r,0,0,0,0,1),this},i.makeRotationZ=function(t){var r=Math.cos(t),n=Math.sin(t);return this.set(r,-n,0,0,n,r,0,0,0,0,1,0,0,0,0,1),this},i.makeRotationAxis=function(t,r){var n=Math.cos(r),a=Math.sin(r),o=1-n,s=t.x,l=t.y,c=t.z,h=o*s,u=o*l;return this.set(h*s+n,h*l-a*c,h*c+a*l,0,h*l+a*c,u*l+n,u*c-a*s,0,h*c-a*l,u*c+a*s,o*c*c+n,0,0,0,0,1),this},i.makeScale=function(t,r,n){return this.set(t,0,0,0,0,r,0,0,0,0,n,0,0,0,0,1),this},i.makeShear=function(t,r,n){return this.set(1,r,n,0,t,1,n,0,t,r,1,0,0,0,0,1),this},i.compose=function(t,r,n){var a=this.elements,o=r._x,s=r._y,l=r._z,c=r._w,h=o+o,u=s+s,p=l+l,d=o*h,m=o*u,g=o*p,b=s*u,v=s*p,f=l*p,M=c*h,_=c*u,w=c*p,x=n.x,S=n.y,A=n.z;return a[0]=(1-(b+f))*x,a[1]=(m+w)*x,a[2]=(g-_)*x,a[3]=0,a[4]=(m-w)*S,a[5]=(1-(d+f))*S,a[6]=(v+M)*S,a[7]=0,a[8]=(g+_)*A,a[9]=(v-M)*A,a[10]=(1-(d+b))*A,a[11]=0,a[12]=t.x,a[13]=t.y,a[14]=t.z,a[15]=1,this},i.decompose=function(t,r,n){var a=this.elements,o=en.set(a[0],a[1],a[2]).length(),s=en.set(a[4],a[5],a[6]).length(),l=en.set(a[8],a[9],a[10]).length(),c=this.determinant();c<0&&(o=-o),t.x=a[12],t.y=a[13],t.z=a[14],Kt.copy(this);var h=1/o,u=1/s,p=1/l;return Kt.elements[0]*=h,Kt.elements[1]*=h,Kt.elements[2]*=h,Kt.elements[4]*=u,Kt.elements[5]*=u,Kt.elements[6]*=u,Kt.elements[8]*=p,Kt.elements[9]*=p,Kt.elements[10]*=p,r.setFromRotationMatrix(Kt),n.x=o,n.y=s,n.z=l,this},i.makePerspective=function(t,r,n,a,o,s){s===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var l=this.elements,c=2*o/(r-t),h=2*o/(n-a),u=(r+t)/(r-t),p=(n+a)/(n-a),d=-(s+o)/(s-o),m=-2*s*o/(s-o);return l[0]=c,l[4]=0,l[8]=u,l[12]=0,l[1]=0,l[5]=h,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=d,l[14]=m,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this},i.makeOrthographic=function(t,r,n,a,o,s){var l=this.elements,c=1/(r-t),h=1/(n-a),u=1/(s-o),p=(r+t)*c,d=(n+a)*h,m=(s+o)*u;return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-d,l[2]=0,l[6]=0,l[10]=-2*u,l[14]=-m,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this},i.equals=function(t){for(var r=this.elements,n=t.elements,a=0;a<16;a++)if(r[a]!==n[a])return!1;return!0},i.fromArray=function(t,r){r===void 0&&(r=0);for(var n=0;n<16;n++)this.elements[n]=t[n+r];return this},i.toArray=function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var n=this.elements;return t[r]=n[0],t[r+1]=n[1],t[r+2]=n[2],t[r+3]=n[3],t[r+4]=n[4],t[r+5]=n[5],t[r+6]=n[6],t[r+7]=n[7],t[r+8]=n[8],t[r+9]=n[9],t[r+10]=n[10],t[r+11]=n[11],t[r+12]=n[12],t[r+13]=n[13],t[r+14]=n[14],t[r+15]=n[15],t},e}(),en=new T,Kt=new Te,ef=new T(0,0,0),tf=new T(1,1,1),jr=new T,ao=new T,zt=new T,oo=function(){function e(t,r,n,a){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),a===void 0&&(a=e.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=t,this._y=r,this._z=n,this._order=a}var i=e.prototype;return i.set=function(t,r,n,a){return this._x=t,this._y=r,this._z=n,this._order=a||this._order,this._onChangeCallback(),this},i.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},i.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},i.setFromRotationMatrix=function(t,r,n){var a=be.clamp,o=t.elements,s=o[0],l=o[4],c=o[8],h=o[1],u=o[5],p=o[9],d=o[2],m=o[6],g=o[10];switch(r=r||this._order,r){case"XYZ":this._y=Math.asin(a(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-p,g),this._z=Math.atan2(-l,s)):(this._x=Math.atan2(m,u),this._z=0);break;case"YXZ":this._x=Math.asin(-a(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(c,g),this._z=Math.atan2(h,u)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(a(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-d,g),this._z=Math.atan2(-l,u)):(this._y=0,this._z=Math.atan2(h,s));break;case"ZYX":this._y=Math.asin(-a(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(m,g),this._z=Math.atan2(h,s)):(this._x=0,this._z=Math.atan2(-l,u));break;case"YZX":this._z=Math.asin(a(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-p,u),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(c,g));break;case"XZY":this._z=Math.asin(-a(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(m,u),this._y=Math.atan2(c,s)):(this._x=Math.atan2(-p,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,n!==!1&&this._onChangeCallback(),this},i.setFromQuaternion=function(t,r,n){return rh.makeRotationFromQuaternion(t),this.setFromRotationMatrix(rh,r,n)},i.setFromVector3=function(t,r){return this.set(t.x,t.y,t.z,r||this._order)},i.reorder=function(t){return ih.setFromEuler(this),this.setFromQuaternion(ih,t)},i.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},i.fromArray=function(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this},i.toArray=function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._order,t},i.toVector3=function(t){return t?t.set(this._x,this._y,this._z):new T(this._x,this._y,this._z)},i._onChange=function(t){return this._onChangeCallback=t,this},i._onChangeCallback=function(){},eo(e,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}]),e}();oo.DefaultOrder="XYZ",oo.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var rh=new Te,ih=new _t,Qs=function(){function e(){this.mask=1|0}var i=e.prototype;return i.set=function(t){this.mask=1<<t|0},i.enable=function(t){this.mask|=1<<t|0},i.enableAll=function(){this.mask=4294967295|0},i.toggle=function(t){this.mask^=1<<t|0},i.disable=function(t){this.mask&=~(1<<t|0)},i.disableAll=function(){this.mask=0},i.test=function(t){return(this.mask&t.mask)!=0},e}(),rf=0,nh=new T,tn=new _t,Lr=new Te,so=new T,Qn=new T,nf=new T,af=new _t,ah=new T(1,0,0),oh=new T(0,1,0),sh=new T(0,0,1),of={type:"added"},lh={type:"removed"};function se(){Object.defineProperty(this,"id",{value:rf++}),this.uuid=be.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=se.DefaultUp.clone();var e=new T,i=new oo,t=new _t,r=new T(1,1,1);function n(){t.setFromEuler(i,!1)}function a(){i.setFromQuaternion(t,void 0,!1)}i._onChange(n),t._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:t},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Te},normalMatrix:{value:new Rt}}),this.matrix=new Te,this.matrixWorld=new Te,this.matrixAutoUpdate=se.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Qs,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}se.DefaultUp=new T(0,1,0),se.DefaultMatrixAutoUpdate=!0,se.prototype=Object.assign(Object.create(ur.prototype),{constructor:se,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,i){this.quaternion.setFromAxisAngle(e,i)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,i){return tn.setFromAxisAngle(e,i),this.quaternion.multiply(tn),this},rotateOnWorldAxis:function(e,i){return tn.setFromAxisAngle(e,i),this.quaternion.premultiply(tn),this},rotateX:function(e){return this.rotateOnAxis(ah,e)},rotateY:function(e){return this.rotateOnAxis(oh,e)},rotateZ:function(e){return this.rotateOnAxis(sh,e)},translateOnAxis:function(e,i){return nh.copy(e).applyQuaternion(this.quaternion),this.position.add(nh.multiplyScalar(i)),this},translateX:function(e){return this.translateOnAxis(ah,e)},translateY:function(e){return this.translateOnAxis(oh,e)},translateZ:function(e){return this.translateOnAxis(sh,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(Lr.copy(this.matrixWorld).invert())},lookAt:function(e,i,t){e.isVector3?so.copy(e):so.set(e,i,t);var r=this.parent;this.updateWorldMatrix(!0,!1),Qn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Lr.lookAt(Qn,so,this.up):Lr.lookAt(so,Qn,this.up),this.quaternion.setFromRotationMatrix(Lr),r&&(Lr.extractRotation(r.matrixWorld),tn.setFromRotationMatrix(Lr),this.quaternion.premultiply(tn.invert()))},add:function(e){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(of)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}var t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(lh)),this},clear:function(){for(var e=0;e<this.children.length;e++){var i=this.children[e];i.parent=null,i.dispatchEvent(lh)}return this.children.length=0,this},attach:function(e){return this.updateWorldMatrix(!0,!1),Lr.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Lr.multiply(e.parent.matrixWorld)),e.applyMatrix4(Lr),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,i){if(this[e]===i)return this;for(var t=0,r=this.children.length;t<r;t++){var n=this.children[t],a=n.getObjectByProperty(e,i);if(a!==void 0)return a}},getWorldPosition:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new T),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new _t),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Qn,e,nf),e},getWorldScale:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new T),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Qn,af,e),e},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new T),this.updateWorldMatrix(!0,!1);var i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var i=this.children,t=0,r=i.length;t<r;t++)i[t].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var i=this.children,t=0,r=i.length;t<r;t++)i[t].traverseVisible(e)}},traverseAncestors:function(e){var i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var i=this.children,t=0,r=i.length;t<r;t++)i[t].updateMatrixWorld(e)},updateWorldMatrix:function(e,i){var t=this.parent;if(e===!0&&t!==null&&t.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0)for(var r=this.children,n=0,a=r.length;n<a;n++)r[n].updateWorldMatrix(!1,!0)},toJSON:function(e){var i=e===void 0||typeof e=="string",t={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},t.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON());function n(A,I){return A[I.uuid]===void 0&&(A[I.uuid]=I.toJSON(e)),I.uuid}if(this.isMesh||this.isLine||this.isPoints){r.geometry=n(e.geometries,this.geometry);var a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){var o=a.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var c=o[s];n(e.shapes,c)}else n(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(n(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){for(var h=[],u=0,p=this.material.length;u<p;u++)h.push(n(e.materials,this.material[u]));r.material=h}else r.material=n(e.materials,this.material);if(this.children.length>0){r.children=[];for(var d=0;d<this.children.length;d++)r.children.push(this.children[d].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var m=0;m<this.animations.length;m++){var g=this.animations[m];r.animations.push(n(e.animations,g))}}if(i){var b=S(e.geometries),v=S(e.materials),f=S(e.textures),M=S(e.images),_=S(e.shapes),w=S(e.skeletons),x=S(e.animations);b.length>0&&(t.geometries=b),v.length>0&&(t.materials=v),f.length>0&&(t.textures=f),M.length>0&&(t.images=M),_.length>0&&(t.shapes=_),w.length>0&&(t.skeletons=w),x.length>0&&(t.animations=x)}return t.object=r,t;function S(A){var I=[];for(var P in A){var R=A[P];delete R.metadata,I.push(R)}return I}},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,i){if(i===void 0&&(i=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(var t=0;t<e.children.length;t++){var r=e.children[t];this.add(r.clone())}return this}});var $s=new T,sf=new T,lf=new Rt,dr=function(){function e(t,r){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=t!==void 0?t:new T(1,0,0),this.constant=r!==void 0?r:0}var i=e.prototype;return i.set=function(t,r){return this.normal.copy(t),this.constant=r,this},i.setComponents=function(t,r,n,a){return this.normal.set(t,r,n),this.constant=a,this},i.setFromNormalAndCoplanarPoint=function(t,r){return this.normal.copy(t),this.constant=-r.dot(this.normal),this},i.setFromCoplanarPoints=function(t,r,n){var a=$s.subVectors(n,r).cross(sf.subVectors(t,r)).normalize();return this.setFromNormalAndCoplanarPoint(a,t),this},i.clone=function(){return new this.constructor().copy(this)},i.copy=function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},i.normalize=function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},i.negate=function(){return this.constant*=-1,this.normal.negate(),this},i.distanceToPoint=function(t){return this.normal.dot(t)+this.constant},i.distanceToSphere=function(t){return this.distanceToPoint(t.center)-t.radius},i.projectPoint=function(t,r){return r===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),r=new T),r.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},i.intersectLine=function(t,r){r===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),r=new T);var n=t.delta($s),a=this.normal.dot(n);if(a===0)return this.distanceToPoint(t.start)===0?r.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/a;if(!(o<0||o>1))return r.copy(n).multiplyScalar(o).add(t.start)},i.intersectsLine=function(t){var r=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return r<0&&n>0||n<0&&r>0},i.intersectsBox=function(t){return t.intersectsPlane(this)},i.intersectsSphere=function(t){return t.intersectsPlane(this)},i.coplanarPoint=function(t){return t===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new T),t.copy(this.normal).multiplyScalar(-this.constant)},i.applyMatrix4=function(t,r){var n=r||lf.getNormalMatrix(t),a=this.coplanarPoint($s).applyMatrix4(t),o=this.normal.applyMatrix3(n).normalize();return this.constant=-a.dot(o),this},i.translate=function(t){return this.constant-=t.dot(this.normal),this},i.equals=function(t){return t.normal.equals(this.normal)&&t.constant===this.constant},e}(),Qt=new T,Rr=new T,el=new T,Pr=new T,rn=new T,nn=new T,ch=new T,tl=new T,rl=new T,il=new T,$t=function(){function e(t,r,n){this.a=t!==void 0?t:new T,this.b=r!==void 0?r:new T,this.c=n!==void 0?n:new T}e.getNormal=function(t,r,n,a){a===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),a=new T),a.subVectors(n,r),Qt.subVectors(t,r),a.cross(Qt);var o=a.lengthSq();return o>0?a.multiplyScalar(1/Math.sqrt(o)):a.set(0,0,0)},e.getBarycoord=function(t,r,n,a,o){Qt.subVectors(a,r),Rr.subVectors(n,r),el.subVectors(t,r);var s=Qt.dot(Qt),l=Qt.dot(Rr),c=Qt.dot(el),h=Rr.dot(Rr),u=Rr.dot(el),p=s*h-l*l;if(o===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),o=new T),p===0)return o.set(-2,-1,-1);var d=1/p,m=(h*c-l*u)*d,g=(s*u-l*c)*d;return o.set(1-m-g,g,m)},e.containsPoint=function(t,r,n,a){return this.getBarycoord(t,r,n,a,Pr),Pr.x>=0&&Pr.y>=0&&Pr.x+Pr.y<=1},e.getUV=function(t,r,n,a,o,s,l,c){return this.getBarycoord(t,r,n,a,Pr),c.set(0,0),c.addScaledVector(o,Pr.x),c.addScaledVector(s,Pr.y),c.addScaledVector(l,Pr.z),c},e.isFrontFacing=function(t,r,n,a){return Qt.subVectors(n,r),Rr.subVectors(t,r),Qt.cross(Rr).dot(a)<0};var i=e.prototype;return i.set=function(t,r,n){return this.a.copy(t),this.b.copy(r),this.c.copy(n),this},i.setFromPointsAndIndices=function(t,r,n,a){return this.a.copy(t[r]),this.b.copy(t[n]),this.c.copy(t[a]),this},i.clone=function(){return new this.constructor().copy(this)},i.copy=function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},i.getArea=function(){return Qt.subVectors(this.c,this.b),Rr.subVectors(this.a,this.b),Qt.cross(Rr).length()*.5},i.getMidpoint=function(t){return t===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new T),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},i.getNormal=function(t){return e.getNormal(this.a,this.b,this.c,t)},i.getPlane=function(t){return t===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new dr),t.setFromCoplanarPoints(this.a,this.b,this.c)},i.getBarycoord=function(t,r){return e.getBarycoord(t,this.a,this.b,this.c,r)},i.getUV=function(t,r,n,a,o){return e.getUV(t,this.a,this.b,this.c,r,n,a,o)},i.containsPoint=function(t){return e.containsPoint(t,this.a,this.b,this.c)},i.isFrontFacing=function(t){return e.isFrontFacing(this.a,this.b,this.c,t)},i.intersectsBox=function(t){return t.intersectsTriangle(this)},i.closestPointToPoint=function(t,r){r===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),r=new T);var n=this.a,a=this.b,o=this.c,s,l;rn.subVectors(a,n),nn.subVectors(o,n),tl.subVectors(t,n);var c=rn.dot(tl),h=nn.dot(tl);if(c<=0&&h<=0)return r.copy(n);rl.subVectors(t,a);var u=rn.dot(rl),p=nn.dot(rl);if(u>=0&&p<=u)return r.copy(a);var d=c*p-u*h;if(d<=0&&c>=0&&u<=0)return s=c/(c-u),r.copy(n).addScaledVector(rn,s);il.subVectors(t,o);var m=rn.dot(il),g=nn.dot(il);if(g>=0&&m<=g)return r.copy(o);var b=m*h-c*g;if(b<=0&&h>=0&&g<=0)return l=h/(h-g),r.copy(n).addScaledVector(nn,l);var v=u*g-m*p;if(v<=0&&p-u>=0&&m-g>=0)return ch.subVectors(o,a),l=(p-u)/(p-u+(m-g)),r.copy(a).addScaledVector(ch,l);var f=1/(v+b+d);return s=b*f,l=d*f,r.copy(n).addScaledVector(rn,s).addScaledVector(nn,l)},i.equals=function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},e}(),uh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},er={h:0,s:0,l:0},lo={h:0,s:0,l:0};function nl(e,i,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+(i-e)*6*t:t<1/2?i:t<2/3?e+(i-e)*6*(2/3-t):e}function al(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function ol(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var ie=function(){function e(t,r,n){return Object.defineProperty(this,"isColor",{value:!0}),r===void 0&&n===void 0?this.set(t):this.setRGB(t,r,n)}var i=e.prototype;return i.set=function(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this},i.setScalar=function(t){return this.r=t,this.g=t,this.b=t,this},i.setHex=function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,this},i.setRGB=function(t,r,n){return this.r=t,this.g=r,this.b=n,this},i.setHSL=function(t,r,n){if(t=be.euclideanModulo(t,1),r=be.clamp(r,0,1),n=be.clamp(n,0,1),r===0)this.r=this.g=this.b=n;else{var a=n<=.5?n*(1+r):n+r-n*r,o=2*n-a;this.r=nl(o,a,t+1/3),this.g=nl(o,a,t),this.b=nl(o,a,t-1/3)}return this},i.setStyle=function(t){function r(d){d!==void 0&&parseFloat(d)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var a,o=n[1],s=n[2];switch(o){case"rgb":case"rgba":if(a=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,r(a[4]),this;if(a=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,r(a[4]),this;break;case"hsl":case"hsla":if(a=/^(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){var l=parseFloat(a[1])/360,c=parseInt(a[2],10)/100,h=parseInt(a[3],10)/100;return r(a[4]),this.setHSL(l,c,h)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){var u=n[1],p=u.length;if(p===3)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(p===6)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},i.setColorName=function(t){var r=uh[t];return r!==void 0?this.setHex(r):console.warn("THREE.Color: Unknown color "+t),this},i.clone=function(){return new this.constructor(this.r,this.g,this.b)},i.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},i.copyGammaToLinear=function(t,r){return r===void 0&&(r=2),this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this},i.copyLinearToGamma=function(t,r){r===void 0&&(r=2);var n=r>0?1/r:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},i.convertGammaToLinear=function(t){return this.copyGammaToLinear(this,t),this},i.convertLinearToGamma=function(t){return this.copyLinearToGamma(this,t),this},i.copySRGBToLinear=function(t){return this.r=al(t.r),this.g=al(t.g),this.b=al(t.b),this},i.copyLinearToSRGB=function(t){return this.r=ol(t.r),this.g=ol(t.g),this.b=ol(t.b),this},i.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},i.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},i.getHex=function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},i.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},i.getHSL=function(t){t===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var r=this.r,n=this.g,a=this.b,o=Math.max(r,n,a),s=Math.min(r,n,a),l,c,h=(s+o)/2;if(s===o)l=0,c=0;else{var u=o-s;switch(c=h<=.5?u/(o+s):u/(2-o-s),o){case r:l=(n-a)/u+(n<a?6:0);break;case n:l=(a-r)/u+2;break;case a:l=(r-n)/u+4;break}l/=6}return t.h=l,t.s=c,t.l=h,t},i.getStyle=function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},i.offsetHSL=function(t,r,n){return this.getHSL(er),er.h+=t,er.s+=r,er.l+=n,this.setHSL(er.h,er.s,er.l),this},i.add=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},i.addColors=function(t,r){return this.r=t.r+r.r,this.g=t.g+r.g,this.b=t.b+r.b,this},i.addScalar=function(t){return this.r+=t,this.g+=t,this.b+=t,this},i.sub=function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},i.multiply=function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},i.multiplyScalar=function(t){return this.r*=t,this.g*=t,this.b*=t,this},i.lerp=function(t,r){return this.r+=(t.r-this.r)*r,this.g+=(t.g-this.g)*r,this.b+=(t.b-this.b)*r,this},i.lerpHSL=function(t,r){this.getHSL(er),t.getHSL(lo);var n=be.lerp(er.h,lo.h,r),a=be.lerp(er.s,lo.s,r),o=be.lerp(er.l,lo.l,r);return this.setHSL(n,a,o),this},i.equals=function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},i.fromArray=function(t,r){return r===void 0&&(r=0),this.r=t[r],this.g=t[r+1],this.b=t[r+2],this},i.toArray=function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.r,t[r+1]=this.g,t[r+2]=this.b,t},i.fromBufferAttribute=function(t,r){return this.r=t.getX(r),this.g=t.getY(r),this.b=t.getZ(r),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this},i.toJSON=function(){return this.getHex()},e}();ie.NAMES=uh,ie.prototype.r=1,ie.prototype.g=1,ie.prototype.b=1;var $n=function(){function e(t,r,n,a,o,s){s===void 0&&(s=0),this.a=t,this.b=r,this.c=n,this.normal=a&&a.isVector3?a:new T,this.vertexNormals=Array.isArray(a)?a:[],this.color=o&&o.isColor?o:new ie,this.vertexColors=Array.isArray(o)?o:[],this.materialIndex=s}var i=e.prototype;return i.clone=function(){return new this.constructor().copy(this)},i.copy=function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var r=0,n=t.vertexNormals.length;r<n;r++)this.vertexNormals[r]=t.vertexNormals[r].clone();for(var a=0,o=t.vertexColors.length;a<o;a++)this.vertexColors[a]=t.vertexColors[a].clone();return this},e}(),cf=0;function ye(){Object.defineProperty(this,"id",{value:cf++}),this.uuid=be.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=ki,this.side=Hi,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Es,this.blendDst=As,this.blendEquation=ui,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ka,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=$u,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Qa,this.stencilZFail=Qa,this.stencilZPass=Qa,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}ye.prototype=Object.assign(Object.create(ur.prototype),{constructor:ye,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(e!==void 0)for(var i in e){var t=e[i];if(t===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}if(i==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===bs;continue}var r=this[i];if(r===void 0){console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.");continue}r&&r.isColor?r.set(t):r&&r.isVector3&&t&&t.isVector3?r.copy(t):this[i]=t}},toJSON:function(e){var i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{}});var t={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.color&&this.color.isColor&&(t.color=this.color.getHex()),this.roughness!==void 0&&(t.roughness=this.roughness),this.metalness!==void 0&&(t.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(t.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(t.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(t.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(t.specular=this.specular.getHex()),this.shininess!==void 0&&(t.shininess=this.shininess),this.clearcoat!==void 0&&(t.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(t.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(t.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(t.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(t.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,t.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(t.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(t.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(t.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(t.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(t.aoMap=this.aoMap.toJSON(e).uuid,t.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(t.bumpMap=this.bumpMap.toJSON(e).uuid,t.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(t.normalMap=this.normalMap.toJSON(e).uuid,t.normalMapType=this.normalMapType,t.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(t.displacementMap=this.displacementMap.toJSON(e).uuid,t.displacementScale=this.displacementScale,t.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(t.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(t.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(t.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(t.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(t.envMap=this.envMap.toJSON(e).uuid,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,this.combine!==void 0&&(t.combine=this.combine),this.envMapIntensity!==void 0&&(t.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(t.gradientMap=this.gradientMap.toJSON(e).uuid),this.size!==void 0&&(t.size=this.size),this.sizeAttenuation!==void 0&&(t.sizeAttenuation=this.sizeAttenuation),this.blending!==ki&&(t.blending=this.blending),this.flatShading===!0&&(t.flatShading=this.flatShading),this.side!==Hi&&(t.side=this.side),this.vertexColors&&(t.vertexColors=!0),this.opacity<1&&(t.opacity=this.opacity),this.transparent===!0&&(t.transparent=this.transparent),t.depthFunc=this.depthFunc,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,t.stencilWrite=this.stencilWrite,t.stencilWriteMask=this.stencilWriteMask,t.stencilFunc=this.stencilFunc,t.stencilRef=this.stencilRef,t.stencilFuncMask=this.stencilFuncMask,t.stencilFail=this.stencilFail,t.stencilZFail=this.stencilZFail,t.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(t.rotation=this.rotation),this.polygonOffset===!0&&(t.polygonOffset=!0),this.polygonOffsetFactor!==0&&(t.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(t.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(t.linewidth=this.linewidth),this.dashSize!==void 0&&(t.dashSize=this.dashSize),this.gapSize!==void 0&&(t.gapSize=this.gapSize),this.scale!==void 0&&(t.scale=this.scale),this.dithering===!0&&(t.dithering=!0),this.alphaTest>0&&(t.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(t.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(t.wireframe=this.wireframe),this.wireframeLinewidth>1&&(t.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(t.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(t.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(t.morphTargets=!0),this.morphNormals===!0&&(t.morphNormals=!0),this.skinning===!0&&(t.skinning=!0),this.visible===!1&&(t.visible=!1),this.toneMapped===!1&&(t.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(t.userData=this.userData);function r(o){var s=[];for(var l in o){var c=o[l];delete c.metadata,s.push(c)}return s}if(i){var n=r(e.textures),a=r(e.images);n.length>0&&(t.textures=n),a.length>0&&(t.images=a)}return t},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var i=e.clippingPlanes,t=null;if(i!==null){var r=i.length;t=new Array(r);for(var n=0;n!==r;++n)t[n]=i[n].clone()}return this.clippingPlanes=t,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(ye.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});function qt(e){ye.call(this),this.type="MeshBasicMaterial",this.color=new ie(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Dn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}qt.prototype=Object.create(ye.prototype),qt.prototype.constructor=qt,qt.prototype.isMeshBasicMaterial=!0,qt.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var Xe=new T,co=new X;function fe(e,i,t){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=i,this.count=e!==void 0?e.length/i:0,this.normalized=t===!0,this.usage=Yn,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(fe.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(fe.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,i,t){e*=this.itemSize,t*=i.itemSize;for(var r=0,n=this.itemSize;r<n;r++)this.array[e+r]=i.array[t+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var i=this.array,t=0,r=0,n=e.length;r<n;r++){var a=e[r];a===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new ie),i[t++]=a.r,i[t++]=a.g,i[t++]=a.b}return this},copyVector2sArray:function(e){for(var i=this.array,t=0,r=0,n=e.length;r<n;r++){var a=e[r];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new X),i[t++]=a.x,i[t++]=a.y}return this},copyVector3sArray:function(e){for(var i=this.array,t=0,r=0,n=e.length;r<n;r++){var a=e[r];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new T),i[t++]=a.x,i[t++]=a.y,i[t++]=a.z}return this},copyVector4sArray:function(e){for(var i=this.array,t=0,r=0,n=e.length;r<n;r++){var a=e[r];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new We),i[t++]=a.x,i[t++]=a.y,i[t++]=a.z,i[t++]=a.w}return this},applyMatrix3:function(e){if(this.itemSize===2)for(var i=0,t=this.count;i<t;i++)co.fromBufferAttribute(this,i),co.applyMatrix3(e),this.setXY(i,co.x,co.y);else if(this.itemSize===3)for(var r=0,n=this.count;r<n;r++)Xe.fromBufferAttribute(this,r),Xe.applyMatrix3(e),this.setXYZ(r,Xe.x,Xe.y,Xe.z);return this},applyMatrix4:function(e){for(var i=0,t=this.count;i<t;i++)Xe.x=this.getX(i),Xe.y=this.getY(i),Xe.z=this.getZ(i),Xe.applyMatrix4(e),this.setXYZ(i,Xe.x,Xe.y,Xe.z);return this},applyNormalMatrix:function(e){for(var i=0,t=this.count;i<t;i++)Xe.x=this.getX(i),Xe.y=this.getY(i),Xe.z=this.getZ(i),Xe.applyNormalMatrix(e),this.setXYZ(i,Xe.x,Xe.y,Xe.z);return this},transformDirection:function(e){for(var i=0,t=this.count;i<t;i++)Xe.x=this.getX(i),Xe.y=this.getY(i),Xe.z=this.getZ(i),Xe.transformDirection(e),this.setXYZ(i,Xe.x,Xe.y,Xe.z);return this},set:function(e,i){return i===void 0&&(i=0),this.array.set(e,i),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,i){return this.array[e*this.itemSize]=i,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,i){return this.array[e*this.itemSize+1]=i,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,i){return this.array[e*this.itemSize+2]=i,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,i){return this.array[e*this.itemSize+3]=i,this},setXY:function(e,i,t){return e*=this.itemSize,this.array[e+0]=i,this.array[e+1]=t,this},setXYZ:function(e,i,t,r){return e*=this.itemSize,this.array[e+0]=i,this.array[e+1]=t,this.array[e+2]=r,this},setXYZW:function(e,i,t,r,n){return e*=this.itemSize,this.array[e+0]=i,this.array[e+1]=t,this.array[e+2]=r,this.array[e+3]=n,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function ea(e,i,t){fe.call(this,new Int8Array(e),i,t)}ea.prototype=Object.create(fe.prototype),ea.prototype.constructor=ea;function ta(e,i,t){fe.call(this,new Uint8Array(e),i,t)}ta.prototype=Object.create(fe.prototype),ta.prototype.constructor=ta;function ra(e,i,t){fe.call(this,new Uint8ClampedArray(e),i,t)}ra.prototype=Object.create(fe.prototype),ra.prototype.constructor=ra;function ia(e,i,t){fe.call(this,new Int16Array(e),i,t)}ia.prototype=Object.create(fe.prototype),ia.prototype.constructor=ia;function bi(e,i,t){fe.call(this,new Uint16Array(e),i,t)}bi.prototype=Object.create(fe.prototype),bi.prototype.constructor=bi;function na(e,i,t){fe.call(this,new Int32Array(e),i,t)}na.prototype=Object.create(fe.prototype),na.prototype.constructor=na;function _i(e,i,t){fe.call(this,new Uint32Array(e),i,t)}_i.prototype=Object.create(fe.prototype),_i.prototype.constructor=_i;function aa(e,i,t){fe.call(this,new Uint16Array(e),i,t)}aa.prototype=Object.create(fe.prototype),aa.prototype.constructor=aa,aa.prototype.isFloat16BufferAttribute=!0;function te(e,i,t){fe.call(this,new Float32Array(e),i,t)}te.prototype=Object.create(fe.prototype),te.prototype.constructor=te;function oa(e,i,t){fe.call(this,new Float64Array(e),i,t)}oa.prototype=Object.create(fe.prototype),oa.prototype.constructor=oa;var uf=function(){function e(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}var i=e.prototype;return i.computeGroups=function(t){var r=[],n,a,o=void 0,s=t.faces;for(a=0;a<s.length;a++){var l=s[a];l.materialIndex!==o&&(o=l.materialIndex,n!==void 0&&(n.count=a*3-n.start,r.push(n)),n={start:a*3,materialIndex:o})}n!==void 0&&(n.count=a*3-n.start,r.push(n)),this.groups=r},i.fromGeometry=function(t){var r=t.faces,n=t.vertices,a=t.faceVertexUvs,o=a[0]&&a[0].length>0,s=a[1]&&a[1].length>0,l=t.morphTargets,c=l.length,h;if(c>0){h=[];for(var u=0;u<c;u++)h[u]={name:l[u].name,data:[]};this.morphTargets.position=h}var p=t.morphNormals,d=p.length,m;if(d>0){m=[];for(var g=0;g<d;g++)m[g]={name:p[g].name,data:[]};this.morphTargets.normal=m}var b=t.skinIndices,v=t.skinWeights,f=b.length===n.length,M=v.length===n.length;n.length>0&&r.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var _=0;_<r.length;_++){var w=r[_];this.vertices.push(n[w.a],n[w.b],n[w.c]);var x=w.vertexNormals;if(x.length===3)this.normals.push(x[0],x[1],x[2]);else{var S=w.normal;this.normals.push(S,S,S)}var A=w.vertexColors;if(A.length===3)this.colors.push(A[0],A[1],A[2]);else{var I=w.color;this.colors.push(I,I,I)}if(o===!0){var P=a[0][_];P!==void 0?this.uvs.push(P[0],P[1],P[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",_),this.uvs.push(new X,new X,new X))}if(s===!0){var R=a[1][_];R!==void 0?this.uvs2.push(R[0],R[1],R[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",_),this.uvs2.push(new X,new X,new X))}for(var N=0;N<c;N++){var D=l[N].vertices;h[N].data.push(D[w.a],D[w.b],D[w.c])}for(var B=0;B<d;B++){var O=p[B].vertexNormals[_];m[B].data.push(O.a,O.b,O.c)}f&&this.skinIndices.push(b[w.a],b[w.b],b[w.c]),M&&this.skinWeights.push(v[w.a],v[w.b],v[w.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this},e}();function hh(e){if(e.length===0)return-Infinity;for(var i=e[0],t=1,r=e.length;t<r;++t)e[t]>i&&(i=e[t]);return i}var hf={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray!="undefined"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function sa(e,i){return new hf[e](i)}var df=1,pr=new Te,sl=new se,an=new T,Ut=new hr,la=new hr,vt=new T;function pe(){Object.defineProperty(this,"id",{value:df+=2}),this.uuid=be.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:Infinity},this.userData={}}pe.prototype=Object.assign(Object.create(ur.prototype),{constructor:pe,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){return Array.isArray(e)?this.index=new(hh(e)>65535?_i:bi)(e,1):this.index=e,this},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,i){return this.attributes[e]=i,this},deleteAttribute:function(e){return delete this.attributes[e],this},hasAttribute:function(e){return this.attributes[e]!==void 0},addGroup:function(e,i,t){t===void 0&&(t=0),this.groups.push({start:e,count:i,materialIndex:t})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,i){this.drawRange.start=e,this.drawRange.count=i},applyMatrix4:function(e){var i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);var t=this.attributes.normal;if(t!==void 0){var r=new Rt().getNormalMatrix(e);t.applyNormalMatrix(r),t.needsUpdate=!0}var n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(e){return pr.makeRotationX(e),this.applyMatrix4(pr),this},rotateY:function(e){return pr.makeRotationY(e),this.applyMatrix4(pr),this},rotateZ:function(e){return pr.makeRotationZ(e),this.applyMatrix4(pr),this},translate:function(e,i,t){return pr.makeTranslation(e,i,t),this.applyMatrix4(pr),this},scale:function(e,i,t){return pr.makeScale(e,i,t),this.applyMatrix4(pr),this},lookAt:function(e){return sl.lookAt(e),sl.updateMatrix(),this.applyMatrix4(sl.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(an).negate(),this.translate(an.x,an.y,an.z),this},setFromObject:function(e){var i=e.geometry;if(e.isPoints||e.isLine){var t=new te(i.vertices.length*3,3),r=new te(i.colors.length*3,3);if(this.setAttribute("position",t.copyVector3sArray(i.vertices)),this.setAttribute("color",r.copyColorsArray(i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){var n=new te(i.lineDistances.length,1);this.setAttribute("lineDistance",n.copyArray(i.lineDistances))}i.boundingSphere!==null&&(this.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(this.boundingBox=i.boundingBox.clone())}else e.isMesh&&i&&i.isGeometry&&this.fromGeometry(i);return this},setFromPoints:function(e){for(var i=[],t=0,r=e.length;t<r;t++){var n=e[t];i.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new te(i,3)),this},updateFromObject:function(e){var i=e.geometry;if(e.isMesh){var t=i.__directGeometry;if(i.elementsNeedUpdate===!0&&(t=void 0,i.elementsNeedUpdate=!1),t===void 0)return this.fromGeometry(i);t.verticesNeedUpdate=i.verticesNeedUpdate,t.normalsNeedUpdate=i.normalsNeedUpdate,t.colorsNeedUpdate=i.colorsNeedUpdate,t.uvsNeedUpdate=i.uvsNeedUpdate,t.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=t}if(i.verticesNeedUpdate===!0){var r=this.attributes.position;r!==void 0&&(r.copyVector3sArray(i.vertices),r.needsUpdate=!0),i.verticesNeedUpdate=!1}if(i.normalsNeedUpdate===!0){var n=this.attributes.normal;n!==void 0&&(n.copyVector3sArray(i.normals),n.needsUpdate=!0),i.normalsNeedUpdate=!1}if(i.colorsNeedUpdate===!0){var a=this.attributes.color;a!==void 0&&(a.copyColorsArray(i.colors),a.needsUpdate=!0),i.colorsNeedUpdate=!1}if(i.uvsNeedUpdate){var o=this.attributes.uv;o!==void 0&&(o.copyVector2sArray(i.uvs),o.needsUpdate=!0),i.uvsNeedUpdate=!1}if(i.lineDistancesNeedUpdate){var s=this.attributes.lineDistance;s!==void 0&&(s.copyArray(i.lineDistances),s.needsUpdate=!0),i.lineDistancesNeedUpdate=!1}return i.groupsNeedUpdate&&(i.computeGroups(e.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new uf().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var i=new Float32Array(e.vertices.length*3);if(this.setAttribute("position",new fe(i,3).copyVector3sArray(e.vertices)),e.normals.length>0){var t=new Float32Array(e.normals.length*3);this.setAttribute("normal",new fe(t,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var r=new Float32Array(e.colors.length*3);this.setAttribute("color",new fe(r,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var n=new Float32Array(e.uvs.length*2);this.setAttribute("uv",new fe(n,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(e.uvs2.length*2);this.setAttribute("uv2",new fe(a,2).copyVector2sArray(e.uvs2))}this.groups=e.groups;for(var o in e.morphTargets){for(var s=[],l=e.morphTargets[o],c=0,h=l.length;c<h;c++){var u=l[c],p=new te(u.data.length*3,3);p.name=u.name,s.push(p.copyVector3sArray(u.data))}this.morphAttributes[o]=s}if(e.skinIndices.length>0){var d=new te(e.skinIndices.length*4,4);this.setAttribute("skinIndex",d.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var m=new te(e.skinWeights.length*4,4);this.setAttribute("skinWeight",m.copyVector4sArray(e.skinWeights))}return e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new hr);var e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new T(-Infinity,-Infinity,-Infinity),new T(Infinity,Infinity,Infinity));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(var t=0,r=i.length;t<r;t++){var n=i[t];Ut.setFromBufferAttribute(n),this.morphTargetsRelative?(vt.addVectors(this.boundingBox.min,Ut.min),this.boundingBox.expandByPoint(vt),vt.addVectors(this.boundingBox.max,Ut.max),this.boundingBox.expandByPoint(vt)):(this.boundingBox.expandByPoint(Ut.min),this.boundingBox.expandByPoint(Ut.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Er);var e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new T,Infinity);return}if(e){var t=this.boundingSphere.center;if(Ut.setFromBufferAttribute(e),i)for(var r=0,n=i.length;r<n;r++){var a=i[r];la.setFromBufferAttribute(a),this.morphTargetsRelative?(vt.addVectors(Ut.min,la.min),Ut.expandByPoint(vt),vt.addVectors(Ut.max,la.max),Ut.expandByPoint(vt)):(Ut.expandByPoint(la.min),Ut.expandByPoint(la.max))}Ut.getCenter(t);for(var o=0,s=0,l=e.count;s<l;s++)vt.fromBufferAttribute(e,s),o=Math.max(o,t.distanceToSquared(vt));if(i)for(var c=0,h=i.length;c<h;c++)for(var u=i[c],p=this.morphTargetsRelative,d=0,m=u.count;d<m;d++)vt.fromBufferAttribute(u,d),p&&(an.fromBufferAttribute(e,d),vt.add(an)),o=Math.max(o,t.distanceToSquared(vt));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,i=this.getAttribute("position");if(i!==void 0){var t=this.getAttribute("normal");if(t===void 0)t=new fe(new Float32Array(i.count*3),3),this.setAttribute("normal",t);else for(var r=0,n=t.count;r<n;r++)t.setXYZ(r,0,0,0);var a=new T,o=new T,s=new T,l=new T,c=new T,h=new T,u=new T,p=new T;if(e)for(var d=0,m=e.count;d<m;d+=3){var g=e.getX(d+0),b=e.getX(d+1),v=e.getX(d+2);a.fromBufferAttribute(i,g),o.fromBufferAttribute(i,b),s.fromBufferAttribute(i,v),u.subVectors(s,o),p.subVectors(a,o),u.cross(p),l.fromBufferAttribute(t,g),c.fromBufferAttribute(t,b),h.fromBufferAttribute(t,v),l.add(u),c.add(u),h.add(u),t.setXYZ(g,l.x,l.y,l.z),t.setXYZ(b,c.x,c.y,c.z),t.setXYZ(v,h.x,h.y,h.z)}else for(var f=0,M=i.count;f<M;f+=3)a.fromBufferAttribute(i,f+0),o.fromBufferAttribute(i,f+1),s.fromBufferAttribute(i,f+2),u.subVectors(s,o),p.subVectors(a,o),u.cross(p),t.setXYZ(f+0,u.x,u.y,u.z),t.setXYZ(f+1,u.x,u.y,u.z),t.setXYZ(f+2,u.x,u.y,u.z);this.normalizeNormals(),t.needsUpdate=!0}},merge:function(e,i){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}i===void 0&&(i=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var t=this.attributes;for(var r in t)if(e.attributes[r]!==void 0)for(var n=t[r],a=n.array,o=e.attributes[r],s=o.array,l=o.itemSize*i,c=Math.min(s.length,a.length-l),h=0,u=l;h<c;h++,u++)a[u]=s[h];return this},normalizeNormals:function(){for(var e=this.attributes.normal,i=0,t=e.count;i<t;i++)vt.fromBufferAttribute(e,i),vt.normalize(),e.setXYZ(i,vt.x,vt.y,vt.z)},toNonIndexed:function(){function e(M,_){for(var w=M.array,x=M.itemSize,S=M.normalized,A=new w.constructor(_.length*x),I=0,P=0,R=0,N=_.length;R<N;R++){I=_[R]*x;for(var D=0;D<x;D++)A[P++]=w[I++]}return new fe(A,x,S)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var i=new pe,t=this.index.array,r=this.attributes;for(var n in r){var a=r[n],o=e(a,t);i.setAttribute(n,o)}var s=this.morphAttributes;for(var l in s){for(var c=[],h=s[l],u=0,p=h.length;u<p;u++){var d=h[u],m=e(d,t);c.push(m)}i.morphAttributes[l]=c}i.morphTargetsRelative=this.morphTargetsRelative;for(var g=this.groups,b=0,v=g.length;b<v;b++){var f=g[b];i.addGroup(f.start,f.count,f.materialIndex)}return i},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){var i=this.parameters;for(var t in i)i[t]!==void 0&&(e[t]=i[t]);return e}e.data={attributes:{}};var r=this.index;r!==null&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var n=this.attributes;for(var a in n){var o=n[a],s=o.toJSON(e.data);o.name!==""&&(s.name=o.name),e.data.attributes[a]=s}var l={},c=!1;for(var h in this.morphAttributes){for(var u=this.morphAttributes[h],p=[],d=0,m=u.length;d<m;d++){var g=u[d],b=g.toJSON(e.data);g.name!==""&&(b.name=g.name),p.push(b)}p.length>0&&(l[h]=p,c=!0)}c&&(e.data.morphAttributes=l,e.data.morphTargetsRelative=this.morphTargetsRelative);var v=this.groups;v.length>0&&(e.data.groups=JSON.parse(JSON.stringify(v)));var f=this.boundingSphere;return f!==null&&(e.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),e},clone:function(){return new pe().copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var i={};this.name=e.name;var t=e.index;t!==null&&this.setIndex(t.clone(i));var r=e.attributes;for(var n in r){var a=r[n];this.setAttribute(n,a.clone(i))}var o=e.morphAttributes;for(var s in o){for(var l=[],c=o[s],h=0,u=c.length;h<u;h++)l.push(c[h].clone(i));this.morphAttributes[s]=l}this.morphTargetsRelative=e.morphTargetsRelative;for(var p=e.groups,d=0,m=p.length;d<m;d++){var g=p[d];this.addGroup(g.start,g.count,g.materialIndex)}var b=e.boundingBox;b!==null&&(this.boundingBox=b.clone());var v=e.boundingSphere;return v!==null&&(this.boundingSphere=v.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var dh=new Te,wi=new $i,ll=new Er,qr=new T,Xr=new T,Yr=new T,cl=new T,ul=new T,hl=new T,uo=new T,ho=new T,po=new T,on=new X,sn=new X,ln=new X,ca=new T,fo=new T;function Je(e,i){e===void 0&&(e=new pe),i===void 0&&(i=new qt),se.call(this),this.type="Mesh",this.geometry=e,this.material=i,this.updateMorphTargets()}Je.prototype=Object.assign(Object.create(se.prototype),{constructor:Je,isMesh:!0,copy:function(e){return se.prototype.copy.call(this,e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var i=e.morphAttributes,t=Object.keys(i);if(t.length>0){var r=i[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var n=0,a=r.length;n<a;n++){var o=r[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}else{var s=e.morphTargets;s!==void 0&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,i){var t=this.geometry,r=this.material,n=this.matrixWorld;if(r!==void 0&&(t.boundingSphere===null&&t.computeBoundingSphere(),ll.copy(t.boundingSphere),ll.applyMatrix4(n),e.ray.intersectsSphere(ll)!==!1&&(dh.copy(n).invert(),wi.copy(e.ray).applyMatrix4(dh),!(t.boundingBox!==null&&wi.intersectsBox(t.boundingBox)===!1)))){var a;if(t.isBufferGeometry){var o=t.index,s=t.attributes.position,l=t.morphAttributes.position,c=t.morphTargetsRelative,h=t.attributes.uv,u=t.attributes.uv2,p=t.groups,d=t.drawRange;if(o!==null)if(Array.isArray(r))for(var m=0,g=p.length;m<g;m++)for(var b=p[m],v=r[b.materialIndex],f=Math.max(b.start,d.start),M=Math.min(b.start+b.count,d.start+d.count),_=f,w=M;_<w;_+=3){var x=o.getX(_),S=o.getX(_+1),A=o.getX(_+2);a=mo(this,v,e,wi,s,l,c,h,u,x,S,A),a&&(a.faceIndex=Math.floor(_/3),a.face.materialIndex=b.materialIndex,i.push(a))}else for(var I=Math.max(0,d.start),P=Math.min(o.count,d.start+d.count),R=I,N=P;R<N;R+=3){var D=o.getX(R),B=o.getX(R+1),O=o.getX(R+2);a=mo(this,r,e,wi,s,l,c,h,u,D,B,O),a&&(a.faceIndex=Math.floor(R/3),i.push(a))}else if(s!==void 0)if(Array.isArray(r))for(var U=0,F=p.length;U<F;U++)for(var k=p[U],W=r[k.materialIndex],Y=Math.max(k.start,d.start),j=Math.min(k.start+k.count,d.start+d.count),Z=Y,ae=j;Z<ae;Z+=3){var me=Z,H=Z+1,Ee=Z+2;a=mo(this,W,e,wi,s,l,c,h,u,me,H,Ee),a&&(a.faceIndex=Math.floor(Z/3),a.face.materialIndex=k.materialIndex,i.push(a))}else for(var ce=Math.max(0,d.start),Ce=Math.min(s.count,d.start+d.count),ue=ce,Ne=Ce;ue<Ne;ue+=3){var xe=ue,Fe=ue+1,Be=ue+2;a=mo(this,r,e,wi,s,l,c,h,u,xe,Fe,Be),a&&(a.faceIndex=Math.floor(ue/3),i.push(a))}}else if(t.isGeometry){var qe=Array.isArray(r),Ze=t.vertices,pt=t.faces,it,Qe=t.faceVertexUvs[0];Qe.length>0&&(it=Qe);for(var C=0,L=pt.length;C<L;C++){var Q=pt[C],K=qe?r[Q.materialIndex]:r;if(K!==void 0){var ge=Ze[Q.a],z=Ze[Q.b],ne=Ze[Q.c];if(a=ph(this,K,e,wi,ge,z,ne,ca),a){if(it&&it[C]){var re=it[C];on.copy(re[0]),sn.copy(re[1]),ln.copy(re[2]),a.uv=$t.getUV(ca,ge,z,ne,on,sn,ln,new X)}a.face=Q,a.faceIndex=C,i.push(a)}}}}}}});function ph(e,i,t,r,n,a,o,s){var l;if(i.side===ht?l=r.intersectTriangle(o,a,n,!0,s):l=r.intersectTriangle(n,a,o,i.side!==In,s),l===null)return null;fo.copy(s),fo.applyMatrix4(e.matrixWorld);var c=t.ray.origin.distanceTo(fo);return c<t.near||c>t.far?null:{distance:c,point:fo.clone(),object:e}}function mo(e,i,t,r,n,a,o,s,l,c,h,u){qr.fromBufferAttribute(n,c),Xr.fromBufferAttribute(n,h),Yr.fromBufferAttribute(n,u);var p=e.morphTargetInfluences;if(i.morphTargets&&a&&p){uo.set(0,0,0),ho.set(0,0,0),po.set(0,0,0);for(var d=0,m=a.length;d<m;d++){var g=p[d],b=a[d];g!==0&&(cl.fromBufferAttribute(b,c),ul.fromBufferAttribute(b,h),hl.fromBufferAttribute(b,u),o?(uo.addScaledVector(cl,g),ho.addScaledVector(ul,g),po.addScaledVector(hl,g)):(uo.addScaledVector(cl.sub(qr),g),ho.addScaledVector(ul.sub(Xr),g),po.addScaledVector(hl.sub(Yr),g)))}qr.add(uo),Xr.add(ho),Yr.add(po)}e.isSkinnedMesh&&(e.boneTransform(c,qr),e.boneTransform(h,Xr),e.boneTransform(u,Yr));var v=ph(e,i,t,r,qr,Xr,Yr,ca);if(v){s&&(on.fromBufferAttribute(s,c),sn.fromBufferAttribute(s,h),ln.fromBufferAttribute(s,u),v.uv=$t.getUV(ca,qr,Xr,Yr,on,sn,ln,new X)),l&&(on.fromBufferAttribute(l,c),sn.fromBufferAttribute(l,h),ln.fromBufferAttribute(l,u),v.uv2=$t.getUV(ca,qr,Xr,Yr,on,sn,ln,new X));var f=new $n(c,h,u);$t.getNormal(qr,Xr,Yr,f.normal),v.face=f}return v}var ua=function(e){le(i,e);function i(t,r,n,a,o,s){var l;t===void 0&&(t=1),r===void 0&&(r=1),n===void 0&&(n=1),a===void 0&&(a=1),o===void 0&&(o=1),s===void 0&&(s=1),l=e.call(this)||this,l.type="BoxBufferGeometry",l.parameters={width:t,height:r,depth:n,widthSegments:a,heightSegments:o,depthSegments:s};var c=Yi(l);a=Math.floor(a),o=Math.floor(o),s=Math.floor(s);var h=[],u=[],p=[],d=[],m=0,g=0;b("z","y","x",-1,-1,n,r,t,s,o,0),b("z","y","x",1,-1,n,r,-t,s,o,1),b("x","z","y",1,1,t,n,r,a,s,2),b("x","z","y",1,-1,t,n,-r,a,s,3),b("x","y","z",1,-1,t,r,n,a,o,4),b("x","y","z",-1,-1,t,r,-n,a,o,5),l.setIndex(h),l.setAttribute("position",new te(u,3)),l.setAttribute("normal",new te(p,3)),l.setAttribute("uv",new te(d,2));function b(v,f,M,_,w,x,S,A,I,P,R){for(var N=x/I,D=S/P,B=x/2,O=S/2,U=A/2,F=I+1,k=P+1,W=0,Y=0,j=new T,Z=0;Z<k;Z++)for(var ae=Z*D-O,me=0;me<F;me++){var H=me*N-B;j[v]=H*_,j[f]=ae*w,j[M]=U,u.push(j.x,j.y,j.z),j[v]=0,j[f]=0,j[M]=A>0?1:-1,p.push(j.x,j.y,j.z),d.push(me/I),d.push(1-Z/P),W+=1}for(var Ee=0;Ee<P;Ee++)for(var ce=0;ce<I;ce++){var Ce=m+ce+F*Ee,ue=m+ce+F*(Ee+1),Ne=m+(ce+1)+F*(Ee+1),xe=m+(ce+1)+F*Ee;h.push(Ce,ue,xe),h.push(ue,Ne,xe),Y+=6}c.addGroup(g,Y,R),g+=Y,m+=W}return l}return i}(pe);function cn(e){var i={};for(var t in e){i[t]={};for(var r in e[t]){var n=e[t][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture)?i[t][r]=n.clone():Array.isArray(n)?i[t][r]=n.slice():i[t][r]=n}}return i}function wt(e){for(var i={},t=0;t<e.length;t++){var r=cn(e[t]);for(var n in r)i[n]=r[n]}return i}var fh={clone:cn,merge:wt},pf=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,ff=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function Pt(e){ye.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=pf,this.fragmentShader=ff,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}Pt.prototype=Object.create(ye.prototype),Pt.prototype.constructor=Pt,Pt.prototype.isShaderMaterial=!0,Pt.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=cn(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this},Pt.prototype.toJSON=function(e){var i=ye.prototype.toJSON.call(this,e);i.glslVersion=this.glslVersion,i.uniforms={};for(var t in this.uniforms){var r=this.uniforms[t],n=r.value;n&&n.isTexture?i.uniforms[t]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?i.uniforms[t]={type:"c",value:n.getHex()}:n&&n.isVector2?i.uniforms[t]={type:"v2",value:n.toArray()}:n&&n.isVector3?i.uniforms[t]={type:"v3",value:n.toArray()}:n&&n.isVector4?i.uniforms[t]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?i.uniforms[t]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?i.uniforms[t]={type:"m4",value:n.toArray()}:i.uniforms[t]={value:n}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader;var a={};for(var o in this.extensions)this.extensions[o]===!0&&(a[o]=!0);return Object.keys(a).length>0&&(i.extensions=a),i};function fr(){se.call(this),this.type="Camera",this.matrixWorldInverse=new Te,this.projectionMatrix=new Te,this.projectionMatrixInverse=new Te}fr.prototype=Object.assign(Object.create(se.prototype),{constructor:fr,isCamera:!0,copy:function(e,i){return se.prototype.copy.call(this,e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new T),this.updateWorldMatrix(!0,!1);var i=this.matrixWorld.elements;return e.set(-i[8],-i[9],-i[10]).normalize()},updateMatrixWorld:function(e){se.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(e,i){se.prototype.updateWorldMatrix.call(this,e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return new this.constructor().copy(this)}});function ct(e,i,t,r){e===void 0&&(e=50),i===void 0&&(i=1),t===void 0&&(t=.1),r===void 0&&(r=2e3),fr.call(this),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=t,this.far=r,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}ct.prototype=Object.assign(Object.create(fr.prototype),{constructor:ct,isPerspectiveCamera:!0,copy:function(e,i){return fr.prototype.copy.call(this,e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var i=.5*this.getFilmHeight()/e;this.fov=be.RAD2DEG*2*Math.atan(i),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(be.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return be.RAD2DEG*2*Math.atan(Math.tan(be.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,i,t,r,n,a){this.aspect=e/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=t,this.view.offsetY=r,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,i=e*Math.tan(be.DEG2RAD*.5*this.fov)/this.zoom,t=2*i,r=this.aspect*t,n=-.5*r,a=this.view;if(this.view!==null&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;n+=a.offsetX*r/o,i-=a.offsetY*t/s,r*=a.width/o,t*=a.height/s}var l=this.filmOffset;l!==0&&(n+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+r,i,i-t,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(e){var i=se.prototype.toJSON.call(this,e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}});var un=90,hn=1;function Mi(e,i,t){if(se.call(this),this.type="CubeCamera",t.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=t;var r=new ct(un,hn,e,i);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new T(1,0,0)),this.add(r);var n=new ct(un,hn,e,i);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new T(-1,0,0)),this.add(n);var a=new ct(un,hn,e,i);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new T(0,1,0)),this.add(a);var o=new ct(un,hn,e,i);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new T(0,-1,0)),this.add(o);var s=new ct(un,hn,e,i);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new T(0,0,1)),this.add(s);var l=new ct(un,hn,e,i);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new T(0,0,-1)),this.add(l),this.update=function(c,h){this.parent===null&&this.updateMatrixWorld();var u=c.xr.enabled,p=c.getRenderTarget();c.xr.enabled=!1;var d=t.texture.generateMipmaps;t.texture.generateMipmaps=!1,c.setRenderTarget(t,0),c.render(h,r),c.setRenderTarget(t,1),c.render(h,n),c.setRenderTarget(t,2),c.render(h,a),c.setRenderTarget(t,3),c.render(h,o),c.setRenderTarget(t,4),c.render(h,s),t.texture.generateMipmaps=d,c.setRenderTarget(t,5),c.render(h,l),c.setRenderTarget(p),c.xr.enabled=u}}Mi.prototype=Object.create(se.prototype),Mi.prototype.constructor=Mi;function mr(e,i,t,r,n,a,o,s,l,c){e=e!==void 0?e:[],i=i!==void 0?i:Bn,o=o!==void 0?o:Hr,Ve.call(this,e,i,t,r,n,a,o,s,l,c),this.flipY=!1,this._needsFlipEnvMap=!0}mr.prototype=Object.create(Ve.prototype),mr.prototype.constructor=mr,mr.prototype.isCubeTexture=!0,Object.defineProperty(mr.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});function Cr(e,i,t){Number.isInteger(i)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),i=t),Bt.call(this,e,e,i),i=i||{},this.texture=new mr(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture._needsFlipEnvMap=!1}Cr.prototype=Object.create(Bt.prototype),Cr.prototype.constructor=Cr,Cr.prototype.isWebGLCubeRenderTarget=!0,Cr.prototype.fromEquirectangularTexture=function(e,i){this.texture.type=i.type,this.texture.format=Dt,this.texture.encoding=i.encoding,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;var t={uniforms:{tEquirect:{value:null}},vertexShader:`

			varying vec3 vWorldDirection;

			vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

				return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

			}

			void main() {

				vWorldDirection = transformDirection( position, modelMatrix );

				#include <begin_vertex>
				#include <project_vertex>

			}
		`,fragmentShader:`

			uniform sampler2D tEquirect;

			varying vec3 vWorldDirection;

			#include <common>

			void main() {

				vec3 direction = normalize( vWorldDirection );

				vec2 sampleUV = equirectUv( direction );

				gl_FragColor = texture2D( tEquirect, sampleUV );

			}
		`},r=new ua(5,5,5),n=new Pt({name:"CubemapFromEquirect",uniforms:cn(t.uniforms),vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,side:ht,blending:Mr});n.uniforms.tEquirect.value=i;var a=new Je(r,n),o=i.minFilter;i.minFilter===Wi&&(i.minFilter=mt);var s=new Mi(1,10,this);return s.update(e,a),i.minFilter=o,a.geometry.dispose(),a.material.dispose(),this},Cr.prototype.clear=function(e,i,t,r){for(var n=e.getRenderTarget(),a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(i,t,r);e.setRenderTarget(n)};function Nr(e,i,t,r,n,a,o,s,l,c,h,u){Ve.call(this,null,a,o,s,l,c,r,n,h,u),this.image={data:e||null,width:i||1,height:t||1},this.magFilter=l!==void 0?l:dt,this.minFilter=c!==void 0?c:dt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Nr.prototype=Object.create(Ve.prototype),Nr.prototype.constructor=Nr,Nr.prototype.isDataTexture=!0;var dn=new Er,vo=new T,ha=function(){function e(t,r,n,a,o,s){this.planes=[t!==void 0?t:new dr,r!==void 0?r:new dr,n!==void 0?n:new dr,a!==void 0?a:new dr,o!==void 0?o:new dr,s!==void 0?s:new dr]}var i=e.prototype;return i.set=function(t,r,n,a,o,s){var l=this.planes;return l[0].copy(t),l[1].copy(r),l[2].copy(n),l[3].copy(a),l[4].copy(o),l[5].copy(s),this},i.clone=function(){return new this.constructor().copy(this)},i.copy=function(t){for(var r=this.planes,n=0;n<6;n++)r[n].copy(t.planes[n]);return this},i.setFromProjectionMatrix=function(t){var r=this.planes,n=t.elements,a=n[0],o=n[1],s=n[2],l=n[3],c=n[4],h=n[5],u=n[6],p=n[7],d=n[8],m=n[9],g=n[10],b=n[11],v=n[12],f=n[13],M=n[14],_=n[15];return r[0].setComponents(l-a,p-c,b-d,_-v).normalize(),r[1].setComponents(l+a,p+c,b+d,_+v).normalize(),r[2].setComponents(l+o,p+h,b+m,_+f).normalize(),r[3].setComponents(l-o,p-h,b-m,_-f).normalize(),r[4].setComponents(l-s,p-u,b-g,_-M).normalize(),r[5].setComponents(l+s,p+u,b+g,_+M).normalize(),this},i.intersectsObject=function(t){var r=t.geometry;return r.boundingSphere===null&&r.computeBoundingSphere(),dn.copy(r.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(dn)},i.intersectsSprite=function(t){return dn.center.set(0,0,0),dn.radius=.7071067811865476,dn.applyMatrix4(t.matrixWorld),this.intersectsSphere(dn)},i.intersectsSphere=function(t){for(var r=this.planes,n=t.center,a=-t.radius,o=0;o<6;o++){var s=r[o].distanceToPoint(n);if(s<a)return!1}return!0},i.intersectsBox=function(t){for(var r=this.planes,n=0;n<6;n++){var a=r[n];if(vo.x=a.normal.x>0?t.max.x:t.min.x,vo.y=a.normal.y>0?t.max.y:t.min.y,vo.z=a.normal.z>0?t.max.z:t.min.z,a.distanceToPoint(vo)<0)return!1}return!0},i.containsPoint=function(t){for(var r=this.planes,n=0;n<6;n++)if(r[n].distanceToPoint(t)<0)return!1;return!0},e}();function mh(){var e=null,i=!1,t=null,r=null;function n(a,o){t(a,o),r=e.requestAnimationFrame(n)}return{start:function(){i!==!0&&t!==null&&(r=e.requestAnimationFrame(n),i=!0)},stop:function(){e.cancelAnimationFrame(r),i=!1},setAnimationLoop:function(a){t=a},setContext:function(a){e=a}}}function mf(e,i){var t=i.isWebGL2,r=new WeakMap;function n(c,h){var u=c.array,p=c.usage,d=e.createBuffer();e.bindBuffer(h,d),e.bufferData(h,u,p),c.onUploadCallback();var m=5126;return u instanceof Float32Array?m=5126:u instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):u instanceof Uint16Array?c.isFloat16BufferAttribute?t?m=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):m=5123:u instanceof Int16Array?m=5122:u instanceof Uint32Array?m=5125:u instanceof Int32Array?m=5124:u instanceof Int8Array?m=5120:u instanceof Uint8Array&&(m=5121),{buffer:d,type:m,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function a(c,h,u){var p=h.array,d=h.updateRange;e.bindBuffer(u,c),d.count===-1?e.bufferSubData(u,0,p):(t?e.bufferSubData(u,d.offset*p.BYTES_PER_ELEMENT,p,d.offset,d.count):e.bufferSubData(u,d.offset*p.BYTES_PER_ELEMENT,p.subarray(d.offset,d.offset+d.count)),d.count=-1)}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),r.get(c)}function s(c){c.isInterleavedBufferAttribute&&(c=c.data);var h=r.get(c);h&&(e.deleteBuffer(h.buffer),r.delete(c))}function l(c,h){if(c.isGLBufferAttribute){var u=r.get(c);(!u||u.version<c.version)&&r.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);var p=r.get(c);p===void 0?r.set(c,n(c,h)):p.version<c.version&&(a(p.buffer,c,h),p.version=c.version)}return{get:o,remove:s,update:l}}var go=function(e){le(i,e);function i(t,r,n,a){var o;t===void 0&&(t=1),r===void 0&&(r=1),n===void 0&&(n=1),a===void 0&&(a=1),o=e.call(this)||this,o.type="PlaneBufferGeometry",o.parameters={width:t,height:r,widthSegments:n,heightSegments:a};for(var s=t/2,l=r/2,c=Math.floor(n),h=Math.floor(a),u=c+1,p=h+1,d=t/c,m=r/h,g=[],b=[],v=[],f=[],M=0;M<p;M++)for(var _=M*m-l,w=0;w<u;w++){var x=w*d-s;b.push(x,-_,0),v.push(0,0,1),f.push(w/c),f.push(1-M/h)}for(var S=0;S<h;S++)for(var A=0;A<c;A++){var I=A+u*S,P=A+u*(S+1),R=A+1+u*(S+1),N=A+1+u*S;g.push(I,P,N),g.push(P,R,N)}return o.setIndex(g),o.setAttribute("position",new te(b,3)),o.setAttribute("normal",new te(v,3)),o.setAttribute("uv",new te(f,2)),o}return i}(pe),vf=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,gf=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,yf=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,xf=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,bf=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,_f="vec3 transformed = vec3( position );",wf=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Mf=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,Sf=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Tf=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Ef=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Af=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Lf=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Rf=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,Pf=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,Cf=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Nf=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Of=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,If=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Df=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Bf=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,zf=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Uf=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Ff=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Gf="gl_FragColor = linearToOutputTexel( gl_FragColor );",Hf=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,kf=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Vf=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Wf=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,jf=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,qf=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Xf=`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,Yf=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,Zf=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Jf=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Kf=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,Qf=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,$f=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,em=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,tm=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,rm=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,im=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,nm=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,am=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,om=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,sm=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lm=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(		0, 1,		0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,cm=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,um=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,hm=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,dm=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,pm=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,fm=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,mm=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,vm=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,gm=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,ym=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,xm=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,bm=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,_m=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,wm=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,Mm=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,Sm=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,Tm=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Em=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,Am=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,Lm=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Rm=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,Pm=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Cm=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Nm=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Om=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Im=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Dm=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Bm=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,zm=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Um=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
							f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
							f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Fm=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Gm=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,Hm=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,km=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Vm=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,Wm=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,jm=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,qm=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Xm=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Ym=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Zm=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,	1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Jm=`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,Km=`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,Qm=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,$m=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,ev=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,tv=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,rv=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,iv=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,nv=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,av=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,ov=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,sv=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,lv=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cv=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,uv=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,hv=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,dv=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,pv=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,fv=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,mv=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vv=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,gv=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yv=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,xv=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bv=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_v=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wv=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Mv=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Sv=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Tv=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ev=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Av=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Lv=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Rv=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,Pv=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Cv=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Nv=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Ov=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Iv=`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Dv=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Bv=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Re={alphamap_fragment:vf,alphamap_pars_fragment:gf,alphatest_fragment:yf,aomap_fragment:xf,aomap_pars_fragment:bf,begin_vertex:_f,beginnormal_vertex:wf,bsdfs:Mf,bumpmap_pars_fragment:Sf,clipping_planes_fragment:Tf,clipping_planes_pars_fragment:Ef,clipping_planes_pars_vertex:Af,clipping_planes_vertex:Lf,color_fragment:Rf,color_pars_fragment:Pf,color_pars_vertex:Cf,color_vertex:Nf,common:Of,cube_uv_reflection_fragment:If,defaultnormal_vertex:Df,displacementmap_pars_vertex:Bf,displacementmap_vertex:zf,emissivemap_fragment:Uf,emissivemap_pars_fragment:Ff,encodings_fragment:Gf,encodings_pars_fragment:Hf,envmap_fragment:kf,envmap_common_pars_fragment:Vf,envmap_pars_fragment:Wf,envmap_pars_vertex:jf,envmap_physical_pars_fragment:rm,envmap_vertex:qf,fog_vertex:Xf,fog_pars_vertex:Yf,fog_fragment:Zf,fog_pars_fragment:Jf,gradientmap_pars_fragment:Kf,lightmap_fragment:Qf,lightmap_pars_fragment:$f,lights_lambert_vertex:em,lights_pars_begin:tm,lights_toon_fragment:im,lights_toon_pars_fragment:nm,lights_phong_fragment:am,lights_phong_pars_fragment:om,lights_physical_fragment:sm,lights_physical_pars_fragment:lm,lights_fragment_begin:cm,lights_fragment_maps:um,lights_fragment_end:hm,logdepthbuf_fragment:dm,logdepthbuf_pars_fragment:pm,logdepthbuf_pars_vertex:fm,logdepthbuf_vertex:mm,map_fragment:vm,map_pars_fragment:gm,map_particle_fragment:ym,map_particle_pars_fragment:xm,metalnessmap_fragment:bm,metalnessmap_pars_fragment:_m,morphnormal_vertex:wm,morphtarget_pars_vertex:Mm,morphtarget_vertex:Sm,normal_fragment_begin:Tm,normal_fragment_maps:Em,normalmap_pars_fragment:Am,clearcoat_normal_fragment_begin:Lm,clearcoat_normal_fragment_maps:Rm,clearcoat_pars_fragment:Pm,packing:Cm,premultiplied_alpha_fragment:Nm,project_vertex:Om,dithering_fragment:Im,dithering_pars_fragment:Dm,roughnessmap_fragment:Bm,roughnessmap_pars_fragment:zm,shadowmap_pars_fragment:Um,shadowmap_pars_vertex:Fm,shadowmap_vertex:Gm,shadowmask_pars_fragment:Hm,skinbase_vertex:km,skinning_pars_vertex:Vm,skinning_vertex:Wm,skinnormal_vertex:jm,specularmap_fragment:qm,specularmap_pars_fragment:Xm,tonemapping_fragment:Ym,tonemapping_pars_fragment:Zm,transmissionmap_fragment:Jm,transmissionmap_pars_fragment:Km,uv_pars_fragment:Qm,uv_pars_vertex:$m,uv_vertex:ev,uv2_pars_fragment:tv,uv2_pars_vertex:rv,uv2_vertex:iv,worldpos_vertex:nv,background_frag:av,background_vert:ov,cube_frag:sv,cube_vert:lv,depth_frag:cv,depth_vert:uv,distanceRGBA_frag:hv,distanceRGBA_vert:dv,equirect_frag:pv,equirect_vert:fv,linedashed_frag:mv,linedashed_vert:vv,meshbasic_frag:gv,meshbasic_vert:yv,meshlambert_frag:xv,meshlambert_vert:bv,meshmatcap_frag:_v,meshmatcap_vert:wv,meshtoon_frag:Mv,meshtoon_vert:Sv,meshphong_frag:Tv,meshphong_vert:Ev,meshphysical_frag:Av,meshphysical_vert:Lv,normal_frag:Rv,normal_vert:Pv,points_frag:Cv,points_vert:Nv,shadow_frag:Ov,shadow_vert:Iv,sprite_frag:Dv,sprite_vert:Bv},ee={common:{diffuse:{value:new ie(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Rt},uv2Transform:{value:new Rt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new X(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ie(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ie(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Rt}},sprite:{diffuse:{value:new ie(15658734)},opacity:{value:1},center:{value:new X(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Rt}}},tr={basic:{uniforms:wt([ee.common,ee.specularmap,ee.envmap,ee.aomap,ee.lightmap,ee.fog]),vertexShader:Re.meshbasic_vert,fragmentShader:Re.meshbasic_frag},lambert:{uniforms:wt([ee.common,ee.specularmap,ee.envmap,ee.aomap,ee.lightmap,ee.emissivemap,ee.fog,ee.lights,{emissive:{value:new ie(0)}}]),vertexShader:Re.meshlambert_vert,fragmentShader:Re.meshlambert_frag},phong:{uniforms:wt([ee.common,ee.specularmap,ee.envmap,ee.aomap,ee.lightmap,ee.emissivemap,ee.bumpmap,ee.normalmap,ee.displacementmap,ee.fog,ee.lights,{emissive:{value:new ie(0)},specular:{value:new ie(1118481)},shininess:{value:30}}]),vertexShader:Re.meshphong_vert,fragmentShader:Re.meshphong_frag},standard:{uniforms:wt([ee.common,ee.envmap,ee.aomap,ee.lightmap,ee.emissivemap,ee.bumpmap,ee.normalmap,ee.displacementmap,ee.roughnessmap,ee.metalnessmap,ee.fog,ee.lights,{emissive:{value:new ie(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Re.meshphysical_vert,fragmentShader:Re.meshphysical_frag},toon:{uniforms:wt([ee.common,ee.aomap,ee.lightmap,ee.emissivemap,ee.bumpmap,ee.normalmap,ee.displacementmap,ee.gradientmap,ee.fog,ee.lights,{emissive:{value:new ie(0)}}]),vertexShader:Re.meshtoon_vert,fragmentShader:Re.meshtoon_frag},matcap:{uniforms:wt([ee.common,ee.bumpmap,ee.normalmap,ee.displacementmap,ee.fog,{matcap:{value:null}}]),vertexShader:Re.meshmatcap_vert,fragmentShader:Re.meshmatcap_frag},points:{uniforms:wt([ee.points,ee.fog]),vertexShader:Re.points_vert,fragmentShader:Re.points_frag},dashed:{uniforms:wt([ee.common,ee.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Re.linedashed_vert,fragmentShader:Re.linedashed_frag},depth:{uniforms:wt([ee.common,ee.displacementmap]),vertexShader:Re.depth_vert,fragmentShader:Re.depth_frag},normal:{uniforms:wt([ee.common,ee.bumpmap,ee.normalmap,ee.displacementmap,{opacity:{value:1}}]),vertexShader:Re.normal_vert,fragmentShader:Re.normal_frag},sprite:{uniforms:wt([ee.sprite,ee.fog]),vertexShader:Re.sprite_vert,fragmentShader:Re.sprite_frag},background:{uniforms:{uvTransform:{value:new Rt},t2D:{value:null}},vertexShader:Re.background_vert,fragmentShader:Re.background_frag},cube:{uniforms:wt([ee.envmap,{opacity:{value:1}}]),vertexShader:Re.cube_vert,fragmentShader:Re.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Re.equirect_vert,fragmentShader:Re.equirect_frag},distanceRGBA:{uniforms:wt([ee.common,ee.displacementmap,{referencePosition:{value:new T},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Re.distanceRGBA_vert,fragmentShader:Re.distanceRGBA_frag},shadow:{uniforms:wt([ee.lights,ee.fog,{color:{value:new ie(0)},opacity:{value:1}}]),vertexShader:Re.shadow_vert,fragmentShader:Re.shadow_frag}};tr.physical={uniforms:wt([tr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new X(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new ie(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Re.meshphysical_vert,fragmentShader:Re.meshphysical_frag};function zv(e,i,t,r,n){var a=new ie(0),o=0,s,l,c=null,h=0,u=null;function p(m,g,b,v){var f=g.isScene===!0?g.background:null;f&&f.isTexture&&(f=i.get(f));var M=e.xr,_=M.getSession&&M.getSession();_&&_.environmentBlendMode==="additive"&&(f=null),f===null?d(a,o):f&&f.isColor&&(d(f,1),v=!0),(e.autoClear||v)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),f&&(f.isCubeTexture||f.isWebGLCubeRenderTarget||f.mapping===Vi)?(l===void 0&&(l=new Je(new ua(1,1,1),new Pt({name:"BackgroundCubeMaterial",uniforms:cn(tr.cube.uniforms),vertexShader:tr.cube.vertexShader,fragmentShader:tr.cube.fragmentShader,side:ht,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(w,x,S){this.matrixWorld.copyPosition(S.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(l)),f.isWebGLCubeRenderTarget&&(f=f.texture),l.material.uniforms.envMap.value=f,l.material.uniforms.flipEnvMap.value=f.isCubeTexture&&f._needsFlipEnvMap?-1:1,(c!==f||h!==f.version||u!==e.toneMapping)&&(l.material.needsUpdate=!0,c=f,h=f.version,u=e.toneMapping),m.unshift(l,l.geometry,l.material,0,0,null)):f&&f.isTexture&&(s===void 0&&(s=new Je(new go(2,2),new Pt({name:"BackgroundMaterial",uniforms:cn(tr.background.uniforms),vertexShader:tr.background.vertexShader,fragmentShader:tr.background.fragmentShader,side:Hi,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(s)),s.material.uniforms.t2D.value=f,f.matrixAutoUpdate===!0&&f.updateMatrix(),s.material.uniforms.uvTransform.value.copy(f.matrix),(c!==f||h!==f.version||u!==e.toneMapping)&&(s.material.needsUpdate=!0,c=f,h=f.version,u=e.toneMapping),m.unshift(s,s.geometry,s.material,0,0,null))}function d(m,g){t.buffers.color.setClear(m.r,m.g,m.b,g,n)}return{getClearColor:function(){return a},setClearColor:function(m,g){g===void 0&&(g=1),a.set(m),o=g,d(a,o)},getClearAlpha:function(){return o},setClearAlpha:function(m){o=m,d(a,o)},render:p}}function Uv(e,i,t,r){var n=e.getParameter(34921),a=r.isWebGL2?null:i.get("OES_vertex_array_object"),o=r.isWebGL2||a!==null,s={},l=g(null),c=l;function h(D,B,O,U,F){var k=!1;if(o){var W=m(U,O,B);c!==W&&(c=W,p(c.object)),k=b(U,F),k&&v(U,F)}else{var Y=B.wireframe===!0;(c.geometry!==U.id||c.program!==O.id||c.wireframe!==Y)&&(c.geometry=U.id,c.program=O.id,c.wireframe=Y,k=!0)}D.isInstancedMesh===!0&&(k=!0),F!==null&&t.update(F,34963),k&&(S(D,B,O,U),F!==null&&e.bindBuffer(34963,t.get(F).buffer))}function u(){return r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()}function p(D){return r.isWebGL2?e.bindVertexArray(D):a.bindVertexArrayOES(D)}function d(D){return r.isWebGL2?e.deleteVertexArray(D):a.deleteVertexArrayOES(D)}function m(D,B,O){var U=O.wireframe===!0,F=s[D.id];F===void 0&&(F={},s[D.id]=F);var k=F[B.id];k===void 0&&(k={},F[B.id]=k);var W=k[U];return W===void 0&&(W=g(u()),k[U]=W),W}function g(D){for(var B=[],O=[],U=[],F=0;F<n;F++)B[F]=0,O[F]=0,U[F]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:B,enabledAttributes:O,attributeDivisors:U,object:D,attributes:{},index:null}}function b(D,B){var O=c.attributes,U=D.attributes,F=0;for(var k in U){var W=O[k],Y=U[k];if(W===void 0||W.attribute!==Y||W.data!==Y.data)return!0;F++}return c.attributesNum!==F||c.index!==B}function v(D,B){var O={},U=D.attributes,F=0;for(var k in U){var W=U[k],Y={};Y.attribute=W,W.data&&(Y.data=W.data),O[k]=Y,F++}c.attributes=O,c.attributesNum=F,c.index=B}function f(){for(var D=c.newAttributes,B=0,O=D.length;B<O;B++)D[B]=0}function M(D){_(D,0)}function _(D,B){var O=c.newAttributes,U=c.enabledAttributes,F=c.attributeDivisors;if(O[D]=1,U[D]===0&&(e.enableVertexAttribArray(D),U[D]=1),F[D]!==B){var k=r.isWebGL2?e:i.get("ANGLE_instanced_arrays");k[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](D,B),F[D]=B}}function w(){for(var D=c.newAttributes,B=c.enabledAttributes,O=0,U=B.length;O<U;O++)B[O]!==D[O]&&(e.disableVertexAttribArray(O),B[O]=0)}function x(D,B,O,U,F,k){r.isWebGL2===!0&&(O===5124||O===5125)?e.vertexAttribIPointer(D,B,O,F,k):e.vertexAttribPointer(D,B,O,U,F,k)}function S(D,B,O,U){if(!(r.isWebGL2===!1&&(D.isInstancedMesh||U.isInstancedBufferGeometry)&&i.get("ANGLE_instanced_arrays")===null)){f();var F=U.attributes,k=O.getAttributes(),W=B.defaultAttributeValues;for(var Y in k){var j=k[Y];if(j>=0){var Z=F[Y];if(Z!==void 0){var ae=Z.normalized,me=Z.itemSize,H=t.get(Z);if(H===void 0)continue;var Ee=H.buffer,ce=H.type,Ce=H.bytesPerElement;if(Z.isInterleavedBufferAttribute){var ue=Z.data,Ne=ue.stride,xe=Z.offset;ue&&ue.isInstancedInterleavedBuffer?(_(j,ue.meshPerAttribute),U._maxInstanceCount===void 0&&(U._maxInstanceCount=ue.meshPerAttribute*ue.count)):M(j),e.bindBuffer(34962,Ee),x(j,me,ce,ae,Ne*Ce,xe*Ce)}else Z.isInstancedBufferAttribute?(_(j,Z.meshPerAttribute),U._maxInstanceCount===void 0&&(U._maxInstanceCount=Z.meshPerAttribute*Z.count)):M(j),e.bindBuffer(34962,Ee),x(j,me,ce,ae,0,0)}else if(Y==="instanceMatrix"){var Fe=t.get(D.instanceMatrix);if(Fe===void 0)continue;var Be=Fe.buffer,qe=Fe.type;_(j+0,1),_(j+1,1),_(j+2,1),_(j+3,1),e.bindBuffer(34962,Be),e.vertexAttribPointer(j+0,4,qe,!1,64,0),e.vertexAttribPointer(j+1,4,qe,!1,64,16),e.vertexAttribPointer(j+2,4,qe,!1,64,32),e.vertexAttribPointer(j+3,4,qe,!1,64,48)}else if(Y==="instanceColor"){var Ze=t.get(D.instanceColor);if(Ze===void 0)continue;var pt=Ze.buffer,it=Ze.type;_(j,1),e.bindBuffer(34962,pt),e.vertexAttribPointer(j,3,it,!1,12,0)}else if(W!==void 0){var Qe=W[Y];if(Qe!==void 0)switch(Qe.length){case 2:e.vertexAttrib2fv(j,Qe);break;case 3:e.vertexAttrib3fv(j,Qe);break;case 4:e.vertexAttrib4fv(j,Qe);break;default:e.vertexAttrib1fv(j,Qe)}}}}w()}}function A(){R();for(var D in s){var B=s[D];for(var O in B){var U=B[O];for(var F in U)d(U[F].object),delete U[F];delete B[O]}delete s[D]}}function I(D){if(s[D.id]!==void 0){var B=s[D.id];for(var O in B){var U=B[O];for(var F in U)d(U[F].object),delete U[F];delete B[O]}delete s[D.id]}}function P(D){for(var B in s){var O=s[B];if(O[D.id]!==void 0){var U=O[D.id];for(var F in U)d(U[F].object),delete U[F];delete O[D.id]}}}function R(){N(),c!==l&&(c=l,p(c.object))}function N(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:R,resetDefaultState:N,dispose:A,releaseStatesOfGeometry:I,releaseStatesOfProgram:P,initAttributes:f,enableAttribute:M,disableUnusedAttributes:w}}function Fv(e,i,t,r){var n=r.isWebGL2,a;function o(c){a=c}function s(c,h){e.drawArrays(a,c,h),t.update(h,a,1)}function l(c,h,u){if(u!==0){var p,d;if(n)p=e,d="drawArraysInstanced";else if(p=i.get("ANGLE_instanced_arrays"),d="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[d](a,c,h,u),t.update(h,a,u)}}this.setMode=o,this.render=s,this.renderInstances=l}function Gv(e,i,t){var r;function n(){if(r!==void 0)return r;var x=i.get("EXT_texture_filter_anisotropic");return x!==null?r=e.getParameter(x.MAX_TEXTURE_MAX_ANISOTROPY_EXT):r=0,r}function a(x){if(x==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";x="mediump"}return x==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o=typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&e instanceof WebGL2ComputeRenderingContext,s=t.precision!==void 0?t.precision:"highp",l=a(s);l!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",l,"instead."),s=l);var c=t.logarithmicDepthBuffer===!0,h=e.getParameter(34930),u=e.getParameter(35660),p=e.getParameter(3379),d=e.getParameter(34076),m=e.getParameter(34921),g=e.getParameter(36347),b=e.getParameter(36348),v=e.getParameter(36349),f=u>0,M=o||!!i.get("OES_texture_float"),_=f&&M,w=o?e.getParameter(36183):0;return{isWebGL2:o,getMaxAnisotropy:n,getMaxPrecision:a,precision:s,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:u,maxTextureSize:p,maxCubemapSize:d,maxAttributes:m,maxVertexUniforms:g,maxVaryings:b,maxFragmentUniforms:v,vertexTextures:f,floatFragmentTextures:M,floatVertexTextures:_,maxSamples:w}}function Hv(e){var i=this,t=null,r=0,n=!1,a=!1,o=new dr,s=new Rt,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,p,d){var m=u.length!==0||p||r!==0||n;return n=p,t=h(u,d,0),r=u.length,m},this.beginShadows=function(){a=!0,h(null)},this.endShadows=function(){a=!1,c()},this.setState=function(u,p,d){var m=u.clippingPlanes,g=u.clipIntersection,b=u.clipShadows,v=e.get(u);if(!n||m===null||m.length===0||a&&!b)a?h(null):c();else{var f=a?0:r,M=f*4,_=v.clippingState||null;l.value=_,_=h(m,p,M,d);for(var w=0;w!==M;++w)_[w]=t[w];v.clippingState=_,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=f}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),i.numPlanes=r,i.numIntersection=0}function h(u,p,d,m){var g=u!==null?u.length:0,b=null;if(g!==0){if(b=l.value,m!==!0||b===null){var v=d+g*4,f=p.matrixWorldInverse;s.getNormalMatrix(f),(b===null||b.length<v)&&(b=new Float32Array(v));for(var M=0,_=d;M!==g;++M,_+=4)o.copy(u[M]).applyMatrix4(f,s),o.normal.toArray(b,_),b[_+3]=o.constant}l.value=b,l.needsUpdate=!0}return i.numPlanes=g,i.numIntersection=0,b}}function kv(e){var i=new WeakMap;function t(o,s){return s===Wa?o.mapping=Bn:s===ja&&(o.mapping=zn),o}function r(o){if(o&&o.isTexture){var s=o.mapping;if(s===Wa||s===ja)if(i.has(o)){var l=i.get(o).texture;return t(l,o.mapping)}else{var c=o.image;if(c&&c.height>0){var h=e.getRenderList(),u=e.getRenderTarget(),p=new Cr(c.height/2);return p.fromEquirectangularTexture(e,o),i.set(o,p),e.setRenderTarget(u),e.setRenderList(h),o.addEventListener("dispose",n),t(p.texture,o.mapping)}else return null}}return o}function n(o){var s=o.target;s.removeEventListener("dispose",n);var l=i.get(s);l!==void 0&&(i.delete(s),l.dispose())}function a(){i=new WeakMap}return{get:r,dispose:a}}function Vv(e){var i={};return{has:function(t){if(i[t]!==void 0)return i[t]!==null;var r;switch(t){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(t)}return i[t]=r,r!==null},get:function(t){return this.has(t)||console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),i[t]}}}function Wv(e,i,t,r){var n=new WeakMap,a=new WeakMap;function o(u){var p=u.target,d=n.get(p);d.index!==null&&i.remove(d.index);for(var m in d.attributes)i.remove(d.attributes[m]);p.removeEventListener("dispose",o),n.delete(p);var g=a.get(d);g&&(i.remove(g),a.delete(d)),r.releaseStatesOfGeometry(d),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function s(u,p){var d=n.get(p);return d||(p.addEventListener("dispose",o),p.isBufferGeometry?d=p:p.isGeometry&&(p._bufferGeometry===void 0&&(p._bufferGeometry=new pe().setFromObject(u)),d=p._bufferGeometry),n.set(p,d),t.memory.geometries++,d)}function l(u){var p=u.attributes;for(var d in p)i.update(p[d],34962);var m=u.morphAttributes;for(var g in m)for(var b=m[g],v=0,f=b.length;v<f;v++)i.update(b[v],34962)}function c(u){var p=[],d=u.index,m=u.attributes.position,g=0;if(d!==null){var b=d.array;g=d.version;for(var v=0,f=b.length;v<f;v+=3){var M=b[v+0],_=b[v+1],w=b[v+2];p.push(M,_,_,w,w,M)}}else{var x=m.array;g=m.version;for(var S=0,A=x.length/3-1;S<A;S+=3){var I=S+0,P=S+1,R=S+2;p.push(I,P,P,R,R,I)}}var N=new(hh(p)>65535?_i:bi)(p,1);N.version=g;var D=a.get(u);D&&i.remove(D),a.set(u,N)}function h(u){var p=a.get(u);if(p){var d=u.index;d!==null&&p.version<d.version&&c(u)}else c(u);return a.get(u)}return{get:s,update:l,getWireframeAttribute:h}}function jv(e,i,t,r){var n=r.isWebGL2,a;function o(p){a=p}var s,l;function c(p){s=p.type,l=p.bytesPerElement}function h(p,d){e.drawElements(a,d,s,p*l),t.update(d,a,1)}function u(p,d,m){if(m!==0){var g,b;if(n)g=e,b="drawElementsInstanced";else if(g=i.get("ANGLE_instanced_arrays"),b="drawElementsInstancedANGLE",g===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[b](a,d,s,p*l,m),t.update(d,a,m)}}this.setMode=o,this.setIndex=c,this.render=h,this.renderInstances=u}function qv(e){var i={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(a,o,s){switch(t.calls++,o){case 4:t.triangles+=s*(a/3);break;case 1:t.lines+=s*(a/2);break;case 3:t.lines+=s*(a-1);break;case 2:t.lines+=s*a;break;case 0:t.points+=s*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function n(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:i,render:t,programs:null,autoReset:!0,reset:n,update:r}}function Xv(e,i){return e[0]-i[0]}function Yv(e,i){return Math.abs(i[1])-Math.abs(e[1])}function Zv(e){for(var i={},t=new Float32Array(8),r=[],n=0;n<8;n++)r[n]=[n,0];function a(o,s,l,c){var h=o.morphTargetInfluences,u=h===void 0?0:h.length,p=i[s.id];if(p===void 0){p=[];for(var d=0;d<u;d++)p[d]=[d,0];i[s.id]=p}for(var m=0;m<u;m++){var g=p[m];g[0]=m,g[1]=h[m]}p.sort(Yv);for(var b=0;b<8;b++)b<u&&p[b][1]?(r[b][0]=p[b][0],r[b][1]=p[b][1]):(r[b][0]=Number.MAX_SAFE_INTEGER,r[b][1]=0);r.sort(Xv);for(var v=l.morphTargets&&s.morphAttributes.position,f=l.morphNormals&&s.morphAttributes.normal,M=0,_=0;_<8;_++){var w=r[_],x=w[0],S=w[1];x!==Number.MAX_SAFE_INTEGER&&S?(v&&s.getAttribute("morphTarget"+_)!==v[x]&&s.setAttribute("morphTarget"+_,v[x]),f&&s.getAttribute("morphNormal"+_)!==f[x]&&s.setAttribute("morphNormal"+_,f[x]),t[_]=S,M+=S):(v&&s.hasAttribute("morphTarget"+_)===!0&&s.deleteAttribute("morphTarget"+_),f&&s.hasAttribute("morphNormal"+_)===!0&&s.deleteAttribute("morphNormal"+_),t[_]=0)}var A=s.morphTargetsRelative?1:1-M;c.getUniforms().setValue(e,"morphTargetBaseInfluence",A),c.getUniforms().setValue(e,"morphTargetInfluences",t)}return{update:a}}function Jv(e,i,t,r){var n=new WeakMap;function a(l){var c=r.render.frame,h=l.geometry,u=i.get(l,h);return n.get(u)!==c&&(h.isGeometry&&u.updateFromObject(l),i.update(u),n.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",s)===!1&&l.addEventListener("dispose",s),t.update(l.instanceMatrix,34962),l.instanceColor!==null&&t.update(l.instanceColor,34962)),u}function o(){n=new WeakMap}function s(l){var c=l.target;c.removeEventListener("dispose",s),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:a,dispose:o}}function pn(e,i,t,r){e===void 0&&(e=null),i===void 0&&(i=1),t===void 0&&(t=1),r===void 0&&(r=1),Ve.call(this,null),this.image={data:e,width:i,height:t,depth:r},this.magFilter=dt,this.minFilter=dt,this.wrapR=At,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}pn.prototype=Object.create(Ve.prototype),pn.prototype.constructor=pn,pn.prototype.isDataTexture2DArray=!0;function fn(e,i,t,r){e===void 0&&(e=null),i===void 0&&(i=1),t===void 0&&(t=1),r===void 0&&(r=1),Ve.call(this,null),this.image={data:e,width:i,height:t,depth:r},this.magFilter=dt,this.minFilter=dt,this.wrapR=At,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}fn.prototype=Object.create(Ve.prototype),fn.prototype.constructor=fn,fn.prototype.isDataTexture3D=!0;var vh=new Ve,Kv=new pn,Qv=new fn,gh=new mr,yh=[],xh=[],bh=new Float32Array(16),_h=new Float32Array(9),wh=new Float32Array(4);function mn(e,i,t){var r=e[0];if(r<=0||r>0)return e;var n=i*t,a=yh[n];if(a===void 0&&(a=new Float32Array(n),yh[n]=a),i!==0){r.toArray(a,0);for(var o=1,s=0;o!==i;++o)s+=t,e[o].toArray(a,s)}return a}function Xt(e,i){if(e.length!==i.length)return!1;for(var t=0,r=e.length;t<r;t++)if(e[t]!==i[t])return!1;return!0}function Ft(e,i){for(var t=0,r=i.length;t<r;t++)e[t]=i[t]}function Mh(e,i){var t=xh[i];t===void 0&&(t=new Int32Array(i),xh[i]=t);for(var r=0;r!==i;++r)t[r]=e.allocateTextureUnit();return t}function $v(e,i){var t=this.cache;t[0]!==i&&(e.uniform1f(this.addr,i),t[0]=i)}function eg(e,i){var t=this.cache;if(i.x!==void 0)(t[0]!==i.x||t[1]!==i.y)&&(e.uniform2f(this.addr,i.x,i.y),t[0]=i.x,t[1]=i.y);else{if(Xt(t,i))return;e.uniform2fv(this.addr,i),Ft(t,i)}}function tg(e,i){var t=this.cache;if(i.x!==void 0)(t[0]!==i.x||t[1]!==i.y||t[2]!==i.z)&&(e.uniform3f(this.addr,i.x,i.y,i.z),t[0]=i.x,t[1]=i.y,t[2]=i.z);else if(i.r!==void 0)(t[0]!==i.r||t[1]!==i.g||t[2]!==i.b)&&(e.uniform3f(this.addr,i.r,i.g,i.b),t[0]=i.r,t[1]=i.g,t[2]=i.b);else{if(Xt(t,i))return;e.uniform3fv(this.addr,i),Ft(t,i)}}function rg(e,i){var t=this.cache;if(i.x!==void 0)(t[0]!==i.x||t[1]!==i.y||t[2]!==i.z||t[3]!==i.w)&&(e.uniform4f(this.addr,i.x,i.y,i.z,i.w),t[0]=i.x,t[1]=i.y,t[2]=i.z,t[3]=i.w);else{if(Xt(t,i))return;e.uniform4fv(this.addr,i),Ft(t,i)}}function ig(e,i){var t=this.cache,r=i.elements;if(r===void 0){if(Xt(t,i))return;e.uniformMatrix2fv(this.addr,!1,i),Ft(t,i)}else{if(Xt(t,r))return;wh.set(r),e.uniformMatrix2fv(this.addr,!1,wh),Ft(t,r)}}function ng(e,i){var t=this.cache,r=i.elements;if(r===void 0){if(Xt(t,i))return;e.uniformMatrix3fv(this.addr,!1,i),Ft(t,i)}else{if(Xt(t,r))return;_h.set(r),e.uniformMatrix3fv(this.addr,!1,_h),Ft(t,r)}}function ag(e,i){var t=this.cache,r=i.elements;if(r===void 0){if(Xt(t,i))return;e.uniformMatrix4fv(this.addr,!1,i),Ft(t,i)}else{if(Xt(t,r))return;bh.set(r),e.uniformMatrix4fv(this.addr,!1,bh),Ft(t,r)}}function og(e,i,t){var r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),t.safeSetTexture2D(i||vh,n)}function sg(e,i,t){var r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),t.setTexture2DArray(i||Kv,n)}function lg(e,i,t){var r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),t.setTexture3D(i||Qv,n)}function cg(e,i,t){var r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),t.safeSetTextureCube(i||gh,n)}function ug(e,i){var t=this.cache;t[0]!==i&&(e.uniform1i(this.addr,i),t[0]=i)}function hg(e,i){var t=this.cache;Xt(t,i)||(e.uniform2iv(this.addr,i),Ft(t,i))}function dg(e,i){var t=this.cache;Xt(t,i)||(e.uniform3iv(this.addr,i),Ft(t,i))}function pg(e,i){var t=this.cache;Xt(t,i)||(e.uniform4iv(this.addr,i),Ft(t,i))}function fg(e,i){var t=this.cache;t[0]!==i&&(e.uniform1ui(this.addr,i),t[0]=i)}function mg(e){switch(e){case 5126:return $v;case 35664:return eg;case 35665:return tg;case 35666:return rg;case 35674:return ig;case 35675:return ng;case 35676:return ag;case 5124:case 35670:return ug;case 35667:case 35671:return hg;case 35668:case 35672:return dg;case 35669:case 35673:return pg;case 5125:return fg;case 35678:case 36198:case 36298:case 36306:case 35682:return og;case 35679:case 36299:case 36307:return lg;case 35680:case 36300:case 36308:case 36293:return cg;case 36289:case 36303:case 36311:case 36292:return sg}}function vg(e,i){e.uniform1fv(this.addr,i)}function gg(e,i){e.uniform1iv(this.addr,i)}function yg(e,i){e.uniform2iv(this.addr,i)}function xg(e,i){e.uniform3iv(this.addr,i)}function bg(e,i){e.uniform4iv(this.addr,i)}function _g(e,i){var t=mn(i,this.size,2);e.uniform2fv(this.addr,t)}function wg(e,i){var t=mn(i,this.size,3);e.uniform3fv(this.addr,t)}function Mg(e,i){var t=mn(i,this.size,4);e.uniform4fv(this.addr,t)}function Sg(e,i){var t=mn(i,this.size,4);e.uniformMatrix2fv(this.addr,!1,t)}function Tg(e,i){var t=mn(i,this.size,9);e.uniformMatrix3fv(this.addr,!1,t)}function Eg(e,i){var t=mn(i,this.size,16);e.uniformMatrix4fv(this.addr,!1,t)}function Ag(e,i,t){var r=i.length,n=Mh(t,r);e.uniform1iv(this.addr,n);for(var a=0;a!==r;++a)t.safeSetTexture2D(i[a]||vh,n[a])}function Lg(e,i,t){var r=i.length,n=Mh(t,r);e.uniform1iv(this.addr,n);for(var a=0;a!==r;++a)t.safeSetTextureCube(i[a]||gh,n[a])}function Rg(e){switch(e){case 5126:return vg;case 35664:return _g;case 35665:return wg;case 35666:return Mg;case 35674:return Sg;case 35675:return Tg;case 35676:return Eg;case 5124:case 35670:return gg;case 35667:case 35671:return yg;case 35668:case 35672:return xg;case 35669:case 35673:return bg;case 35678:case 36198:case 36298:case 36306:case 35682:return Ag;case 35680:case 36300:case 36308:case 36293:return Lg}}function Pg(e,i,t){this.id=e,this.addr=t,this.cache=[],this.setValue=mg(i.type)}function Sh(e,i,t){this.id=e,this.addr=t,this.cache=[],this.size=i.size,this.setValue=Rg(i.type)}Sh.prototype.updateCache=function(e){var i=this.cache;e instanceof Float32Array&&i.length!==e.length&&(this.cache=new Float32Array(e.length)),Ft(i,e)};function Th(e){this.id=e,this.seq=[],this.map={}}Th.prototype.setValue=function(e,i,t){for(var r=this.seq,n=0,a=r.length;n!==a;++n){var o=r[n];o.setValue(e,i[o.id],t)}};var dl=/(\w+)(\])?(\[|\.)?/g;function Eh(e,i){e.seq.push(i),e.map[i.id]=i}function Cg(e,i,t){var r=e.name,n=r.length;for(dl.lastIndex=0;;){var a=dl.exec(r),o=dl.lastIndex,s=a[1],l=a[2]==="]",c=a[3];if(l&&(s=s|0),c===void 0||c==="["&&o+2===n){Eh(t,c===void 0?new Pg(s,e,i):new Sh(s,e,i));break}else{var h=t.map,u=h[s];u===void 0&&(u=new Th(s),Eh(t,u)),t=u}}}function Zr(e,i){this.seq=[],this.map={};for(var t=e.getProgramParameter(i,35718),r=0;r<t;++r){var n=e.getActiveUniform(i,r),a=e.getUniformLocation(i,n.name);Cg(n,a,this)}}Zr.prototype.setValue=function(e,i,t,r){var n=this.map[i];n!==void 0&&n.setValue(e,t,r)},Zr.prototype.setOptional=function(e,i,t){var r=i[t];r!==void 0&&this.setValue(e,t,r)},Zr.upload=function(e,i,t,r){for(var n=0,a=i.length;n!==a;++n){var o=i[n],s=t[o.id];s.needsUpdate!==!1&&o.setValue(e,s.value,r)}},Zr.seqWithValue=function(e,i){for(var t=[],r=0,n=e.length;r!==n;++r){var a=e[r];a.id in i&&t.push(a)}return t};function Ah(e,i,t){var r=e.createShader(i);return e.shaderSource(r,t),e.compileShader(r),r}var Ng=0;function Og(e){for(var i=e.split(`
`),t=0;t<i.length;t++)i[t]=t+1+": "+i[t];return i.join(`
`)}function Lh(e){switch(e){case Lt:return["Linear","( value )"];case Xn:return["sRGB","( value )"];case Ka:return["RGBE","( value )"];case Gs:return["RGBM","( value, 7.0 )"];case Hs:return["RGBM","( value, 16.0 )"];case ks:return["RGBD","( value, 256.0 )"];case Ja:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Zu:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function Rh(e,i,t){var r=e.getShaderParameter(i,35713),n=e.getShaderInfoLog(i).trim();if(r&&n==="")return"";var a=e.getShaderSource(i);return"THREE.WebGLShader: gl.getShaderInfoLog() "+t+`
`+n+Og(a)}function da(e,i){var t=Lh(i);return"vec4 "+e+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function Ig(e,i){var t=Lh(i);return"vec4 "+e+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Dg(e,i){var t;switch(i){case Yc:t="Linear";break;case Zc:t="Reinhard";break;case Jc:t="OptimizedCineon";break;case Kc:t="ACESFilmic";break;case Qc:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",i),t="Linear"}return"vec3 "+e+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Bg(e){var i=[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return i.filter(pa).join(`
`)}function zg(e){var i=[];for(var t in e){var r=e[t];r!==!1&&i.push("#define "+t+" "+r)}return i.join(`
`)}function Ug(e,i){for(var t={},r=e.getProgramParameter(i,35721),n=0;n<r;n++){var a=e.getActiveAttrib(i,n),o=a.name;t[o]=e.getAttribLocation(i,o)}return t}function pa(e){return e!==""}function Ph(e,i){return e.replace(/NUM_DIR_LIGHTS/g,i.numDirLights).replace(/NUM_SPOT_LIGHTS/g,i.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,i.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,i.numPointLights).replace(/NUM_HEMI_LIGHTS/g,i.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,i.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,i.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,i.numPointLightShadows)}function Ch(e,i){return e.replace(/NUM_CLIPPING_PLANES/g,i.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,i.numClippingPlanes-i.numClipIntersection)}var Fg=/^[ \t]*#include +<([\w\d./]+)>/gm;function pl(e){return e.replace(Fg,Gg)}function Gg(e,i){var t=Re[i];if(t===void 0)throw new Error("Can not resolve #include <"+i+">");return pl(t)}var Hg=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,kg=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Nh(e){return e.replace(kg,Oh).replace(Hg,Vg)}function Vg(e,i,t,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Oh(e,i,t,r)}function Oh(e,i,t,r){for(var n="",a=parseInt(i);a<parseInt(t);a++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return n}function Ih(e){var i="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?i+=`
#define HIGH_PRECISION`:e.precision==="mediump"?i+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(i+=`
#define LOW_PRECISION`),i}function Wg(e){var i="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===xs?i="SHADOWMAP_TYPE_PCF":e.shadowMapType===Ec?i="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Gi&&(i="SHADOWMAP_TYPE_VSM"),i}function jg(e){var i="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Bn:case zn:i="ENVMAP_TYPE_CUBE";break;case Vi:case Un:i="ENVMAP_TYPE_CUBE_UV";break}return i}function qg(e){var i="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case zn:case Un:i="ENVMAP_MODE_REFRACTION";break}return i}function Xg(e){var i="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case Dn:i="ENVMAP_BLENDING_MULTIPLY";break;case qc:i="ENVMAP_BLENDING_MIX";break;case Xc:i="ENVMAP_BLENDING_ADD";break}return i}function Yg(e,i,t,r){var n=e.getContext(),a=t.defines,o=t.vertexShader,s=t.fragmentShader,l=Wg(t),c=jg(t),h=qg(t),u=Xg(t),p=e.gammaFactor>0?e.gammaFactor:1,d=t.isWebGL2?"":Bg(t),m=zg(a),g=n.createProgram(),b,v,f=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(b=[m].filter(pa).join(`
`),b.length>0&&(b+=`
`),v=[d,m].filter(pa).join(`
`),v.length>0&&(v+=`
`)):(b=[Ih(t),"#define SHADER_NAME "+t.shaderName,m,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(pa).join(`
`),v=[d,Ih(t),"#define SHADER_NAME "+t.shaderName,m,t.alphaTest?"#define ALPHATEST "+t.alphaTest+(t.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.sheen?"#define USE_SHEEN":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==hi?"#define TONE_MAPPING":"",t.toneMapping!==hi?Re.tonemapping_pars_fragment:"",t.toneMapping!==hi?Dg("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",Re.encodings_pars_fragment,t.map?da("mapTexelToLinear",t.mapEncoding):"",t.matcap?da("matcapTexelToLinear",t.matcapEncoding):"",t.envMap?da("envMapTexelToLinear",t.envMapEncoding):"",t.emissiveMap?da("emissiveMapTexelToLinear",t.emissiveMapEncoding):"",t.lightMap?da("lightMapTexelToLinear",t.lightMapEncoding):"",Ig("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(pa).join(`
`)),o=pl(o),o=Ph(o,t),o=Ch(o,t),s=pl(s),s=Ph(s,t),s=Ch(s,t),o=Nh(o),s=Nh(s),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(f=`#version 300 es
`,b=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+b,v=["#define varying in",t.glslVersion===Vs?"":"out highp vec4 pc_fragColor;",t.glslVersion===Vs?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);var M=f+b+o,_=f+v+s,w=Ah(n,35633,M),x=Ah(n,35632,_);if(n.attachShader(g,w),n.attachShader(g,x),t.index0AttributeName!==void 0?n.bindAttribLocation(g,0,t.index0AttributeName):t.morphTargets===!0&&n.bindAttribLocation(g,0,"position"),n.linkProgram(g),e.debug.checkShaderErrors){var S=n.getProgramInfoLog(g).trim(),A=n.getShaderInfoLog(w).trim(),I=n.getShaderInfoLog(x).trim(),P=!0,R=!0;if(n.getProgramParameter(g,35714)===!1){P=!1;var N=Rh(n,w,"vertex"),D=Rh(n,x,"fragment");console.error("THREE.WebGLProgram: shader error: ",n.getError(),"35715",n.getProgramParameter(g,35715),"gl.getProgramInfoLog",S,N,D)}else S!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",S):(A===""||I==="")&&(R=!1);R&&(this.diagnostics={runnable:P,programLog:S,vertexShader:{log:A,prefix:b},fragmentShader:{log:I,prefix:v}})}n.deleteShader(w),n.deleteShader(x);var B;this.getUniforms=function(){return B===void 0&&(B=new Zr(n,g)),B};var O;return this.getAttributes=function(){return O===void 0&&(O=Ug(n,g)),O},this.destroy=function(){r.releaseStatesOfProgram(this),n.deleteProgram(g),this.program=void 0},this.name=t.shaderName,this.id=Ng++,this.cacheKey=i,this.usedTimes=1,this.program=g,this.vertexShader=w,this.fragmentShader=x,this}function Zg(e,i,t,r,n,a){var o=[],s=r.isWebGL2,l=r.logarithmicDepthBuffer,c=r.floatVertexTextures,h=r.maxVertexUniforms,u=r.vertexTextures,p=r.precision,d={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},m=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function g(x){var S=x.skeleton,A=S.bones;if(c)return 1024;var I=h,P=Math.floor((I-20)/4),R=Math.min(P,A.length);return R<A.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+A.length+" bones. This GPU supports "+R+"."),0):R}function b(x){var S;return x&&x.isTexture?S=x.encoding:x&&x.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),S=x.texture.encoding):S=Lt,S}function v(x,S,A,I,P){var R=I.fog,N=x.isMeshStandardMaterial?I.environment:null,D=i.get(x.envMap||N),B=d[x.type],O=P.isSkinnedMesh?g(P):0;x.precision!==null&&(p=r.getMaxPrecision(x.precision),p!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",p,"instead."));var U,F;if(B){var k=tr[B];U=k.vertexShader,F=k.fragmentShader}else U=x.vertexShader,F=x.fragmentShader;var W=e.getRenderTarget(),Y={isWebGL2:s,shaderID:B,shaderName:x.type,vertexShader:U,fragmentShader:F,defines:x.defines,isRawShaderMaterial:x.isRawShaderMaterial===!0,glslVersion:x.glslVersion,precision:p,instancing:P.isInstancedMesh===!0,instancingColor:P.isInstancedMesh===!0&&P.instanceColor!==null,supportsVertexTextures:u,outputEncoding:W!==null?b(W.texture):e.outputEncoding,map:!!x.map,mapEncoding:b(x.map),matcap:!!x.matcap,matcapEncoding:b(x.matcap),envMap:!!D,envMapMode:D&&D.mapping,envMapEncoding:b(D),envMapCubeUV:!!D&&(D.mapping===Vi||D.mapping===Un),lightMap:!!x.lightMap,lightMapEncoding:b(x.lightMap),aoMap:!!x.aoMap,emissiveMap:!!x.emissiveMap,emissiveMapEncoding:b(x.emissiveMap),bumpMap:!!x.bumpMap,normalMap:!!x.normalMap,objectSpaceNormalMap:x.normalMapType===Qu,tangentSpaceNormalMap:x.normalMapType===mi,clearcoatMap:!!x.clearcoatMap,clearcoatRoughnessMap:!!x.clearcoatRoughnessMap,clearcoatNormalMap:!!x.clearcoatNormalMap,displacementMap:!!x.displacementMap,roughnessMap:!!x.roughnessMap,metalnessMap:!!x.metalnessMap,specularMap:!!x.specularMap,alphaMap:!!x.alphaMap,gradientMap:!!x.gradientMap,sheen:!!x.sheen,transmissionMap:!!x.transmissionMap,combine:x.combine,vertexTangents:x.normalMap&&x.vertexTangents,vertexColors:x.vertexColors,vertexUvs:!!x.map||!!x.bumpMap||!!x.normalMap||!!x.specularMap||!!x.alphaMap||!!x.emissiveMap||!!x.roughnessMap||!!x.metalnessMap||!!x.clearcoatMap||!!x.clearcoatRoughnessMap||!!x.clearcoatNormalMap||!!x.displacementMap||!!x.transmissionMap,uvsVertexOnly:!(!!x.map||!!x.bumpMap||!!x.normalMap||!!x.specularMap||!!x.alphaMap||!!x.emissiveMap||!!x.roughnessMap||!!x.metalnessMap||!!x.clearcoatNormalMap||!!x.transmissionMap)&&!!x.displacementMap,fog:!!R,useFog:x.fog,fogExp2:R&&R.isFogExp2,flatShading:x.flatShading,sizeAttenuation:x.sizeAttenuation,logarithmicDepthBuffer:l,skinning:x.skinning&&O>0,maxBones:O,useVertexTexture:c,morphTargets:x.morphTargets,morphNormals:x.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:S.directional.length,numPointLights:S.point.length,numSpotLights:S.spot.length,numRectAreaLights:S.rectArea.length,numHemiLights:S.hemi.length,numDirLightShadows:S.directionalShadowMap.length,numPointLightShadows:S.pointShadowMap.length,numSpotLightShadows:S.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:x.dithering,shadowMapEnabled:e.shadowMap.enabled&&A.length>0,shadowMapType:e.shadowMap.type,toneMapping:x.toneMapped?e.toneMapping:hi,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:x.premultipliedAlpha,alphaTest:x.alphaTest,doubleSided:x.side===In,flipSided:x.side===ht,depthPacking:x.depthPacking!==void 0?x.depthPacking:!1,index0AttributeName:x.index0AttributeName,extensionDerivatives:x.extensions&&x.extensions.derivatives,extensionFragDepth:x.extensions&&x.extensions.fragDepth,extensionDrawBuffers:x.extensions&&x.extensions.drawBuffers,extensionShaderTextureLOD:x.extensions&&x.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||t.has("EXT_frag_depth"),rendererExtensionDrawBuffers:s||t.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:s||t.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()};return Y}function f(x){var S=[];if(x.shaderID?S.push(x.shaderID):(S.push(x.fragmentShader),S.push(x.vertexShader)),x.defines!==void 0)for(var A in x.defines)S.push(A),S.push(x.defines[A]);if(x.isRawShaderMaterial===!1){for(var I=0;I<m.length;I++)S.push(x[m[I]]);S.push(e.outputEncoding),S.push(e.gammaFactor)}return S.push(x.customProgramCacheKey),S.join()}function M(x){var S=d[x.type],A;if(S){var I=tr[S];A=fh.clone(I.uniforms)}else A=x.uniforms;return A}function _(x,S){for(var A,I=0,P=o.length;I<P;I++){var R=o[I];if(R.cacheKey===S){A=R,++A.usedTimes;break}}return A===void 0&&(A=new Yg(e,S,x,n),o.push(A)),A}function w(x){if(--x.usedTimes==0){var S=o.indexOf(x);o[S]=o[o.length-1],o.pop(),x.destroy()}}return{getParameters:v,getProgramCacheKey:f,getUniforms:M,acquireProgram:_,releaseProgram:w,programs:o}}function Jg(){var e=new WeakMap;function i(a){var o=e.get(a);return o===void 0&&(o={},e.set(a,o)),o}function t(a){e.delete(a)}function r(a,o,s){e.get(a)[o]=s}function n(){e=new WeakMap}return{get:i,remove:t,update:r,dispose:n}}function Kg(e,i){return e.groupOrder!==i.groupOrder?e.groupOrder-i.groupOrder:e.renderOrder!==i.renderOrder?e.renderOrder-i.renderOrder:e.program!==i.program?e.program.id-i.program.id:e.material.id!==i.material.id?e.material.id-i.material.id:e.z!==i.z?e.z-i.z:e.id-i.id}function Qg(e,i){return e.groupOrder!==i.groupOrder?e.groupOrder-i.groupOrder:e.renderOrder!==i.renderOrder?e.renderOrder-i.renderOrder:e.z!==i.z?i.z-e.z:e.id-i.id}function Dh(e){var i=[],t=0,r=[],n=[],a={id:-1};function o(){t=0,r.length=0,n.length=0}function s(p,d,m,g,b,v){var f=i[t],M=e.get(m);return f===void 0?(f={id:p.id,object:p,geometry:d,material:m,program:M.program||a,groupOrder:g,renderOrder:p.renderOrder,z:b,group:v},i[t]=f):(f.id=p.id,f.object=p,f.geometry=d,f.material=m,f.program=M.program||a,f.groupOrder=g,f.renderOrder=p.renderOrder,f.z=b,f.group=v),t++,f}function l(p,d,m,g,b,v){var f=s(p,d,m,g,b,v);(m.transparent===!0?n:r).push(f)}function c(p,d,m,g,b,v){var f=s(p,d,m,g,b,v);(m.transparent===!0?n:r).unshift(f)}function h(p,d){r.length>1&&r.sort(p||Kg),n.length>1&&n.sort(d||Qg)}function u(){for(var p=t,d=i.length;p<d;p++){var m=i[p];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.program=null,m.group=null}}return{opaque:r,transparent:n,init:o,push:l,unshift:c,finish:u,sort:h}}function $g(e){var i=new WeakMap;function t(n,a){var o=i.get(n),s;return o===void 0?(s=new Dh(e),i.set(n,new WeakMap),i.get(n).set(a,s)):(s=o.get(a),s===void 0&&(s=new Dh(e),o.set(a,s))),s}function r(){i=new WeakMap}return{get:t,dispose:r}}function e0(){var e={};return{get:function(i){if(e[i.id]!==void 0)return e[i.id];var t;switch(i.type){case"DirectionalLight":t={direction:new T,color:new ie};break;case"SpotLight":t={position:new T,direction:new T,color:new ie,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new T,color:new ie,distance:0,decay:0};break;case"HemisphereLight":t={direction:new T,skyColor:new ie,groundColor:new ie};break;case"RectAreaLight":t={color:new ie,position:new T,halfWidth:new T,halfHeight:new T};break}return e[i.id]=t,t}}}function t0(){var e={};return{get:function(i){if(e[i.id]!==void 0)return e[i.id];var t;switch(i.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new X};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new X};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new X,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[i.id]=t,t}}}var r0=0;function i0(e,i){return(i.castShadow?1:0)-(e.castShadow?1:0)}function n0(e,i){for(var t=new e0,r=t0(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},a=0;a<9;a++)n.probe.push(new T);var o=new T,s=new Te,l=new Te;function c(u){for(var p=0,d=0,m=0,g=0;g<9;g++)n.probe[g].set(0,0,0);var b=0,v=0,f=0,M=0,_=0,w=0,x=0,S=0;u.sort(i0);for(var A=0,I=u.length;A<I;A++){var P=u[A],R=P.color,N=P.intensity,D=P.distance,B=P.shadow&&P.shadow.map?P.shadow.map.texture:null;if(P.isAmbientLight)p+=R.r*N,d+=R.g*N,m+=R.b*N;else if(P.isLightProbe)for(var O=0;O<9;O++)n.probe[O].addScaledVector(P.sh.coefficients[O],N);else if(P.isDirectionalLight){var U=t.get(P);if(U.color.copy(P.color).multiplyScalar(P.intensity),P.castShadow){var F=P.shadow,k=r.get(P);k.shadowBias=F.bias,k.shadowNormalBias=F.normalBias,k.shadowRadius=F.radius,k.shadowMapSize=F.mapSize,n.directionalShadow[b]=k,n.directionalShadowMap[b]=B,n.directionalShadowMatrix[b]=P.shadow.matrix,w++}n.directional[b]=U,b++}else if(P.isSpotLight){var W=t.get(P);if(W.position.setFromMatrixPosition(P.matrixWorld),W.color.copy(R).multiplyScalar(N),W.distance=D,W.coneCos=Math.cos(P.angle),W.penumbraCos=Math.cos(P.angle*(1-P.penumbra)),W.decay=P.decay,P.castShadow){var Y=P.shadow,j=r.get(P);j.shadowBias=Y.bias,j.shadowNormalBias=Y.normalBias,j.shadowRadius=Y.radius,j.shadowMapSize=Y.mapSize,n.spotShadow[f]=j,n.spotShadowMap[f]=B,n.spotShadowMatrix[f]=P.shadow.matrix,S++}n.spot[f]=W,f++}else if(P.isRectAreaLight){var Z=t.get(P);Z.color.copy(R).multiplyScalar(N),Z.halfWidth.set(P.width*.5,0,0),Z.halfHeight.set(0,P.height*.5,0),n.rectArea[M]=Z,M++}else if(P.isPointLight){var ae=t.get(P);if(ae.color.copy(P.color).multiplyScalar(P.intensity),ae.distance=P.distance,ae.decay=P.decay,P.castShadow){var me=P.shadow,H=r.get(P);H.shadowBias=me.bias,H.shadowNormalBias=me.normalBias,H.shadowRadius=me.radius,H.shadowMapSize=me.mapSize,H.shadowCameraNear=me.camera.near,H.shadowCameraFar=me.camera.far,n.pointShadow[v]=H,n.pointShadowMap[v]=B,n.pointShadowMatrix[v]=P.shadow.matrix,x++}n.point[v]=ae,v++}else if(P.isHemisphereLight){var Ee=t.get(P);Ee.skyColor.copy(P.color).multiplyScalar(N),Ee.groundColor.copy(P.groundColor).multiplyScalar(N),n.hemi[_]=Ee,_++}}M>0&&(i.isWebGL2||e.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=ee.LTC_FLOAT_1,n.rectAreaLTC2=ee.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=ee.LTC_HALF_1,n.rectAreaLTC2=ee.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=p,n.ambient[1]=d,n.ambient[2]=m;var ce=n.hash;(ce.directionalLength!==b||ce.pointLength!==v||ce.spotLength!==f||ce.rectAreaLength!==M||ce.hemiLength!==_||ce.numDirectionalShadows!==w||ce.numPointShadows!==x||ce.numSpotShadows!==S)&&(n.directional.length=b,n.spot.length=f,n.rectArea.length=M,n.point.length=v,n.hemi.length=_,n.directionalShadow.length=w,n.directionalShadowMap.length=w,n.pointShadow.length=x,n.pointShadowMap.length=x,n.spotShadow.length=S,n.spotShadowMap.length=S,n.directionalShadowMatrix.length=w,n.pointShadowMatrix.length=x,n.spotShadowMatrix.length=S,ce.directionalLength=b,ce.pointLength=v,ce.spotLength=f,ce.rectAreaLength=M,ce.hemiLength=_,ce.numDirectionalShadows=w,ce.numPointShadows=x,ce.numSpotShadows=S,n.version=r0++)}function h(u,p){for(var d=0,m=0,g=0,b=0,v=0,f=p.matrixWorldInverse,M=0,_=u.length;M<_;M++){var w=u[M];if(w.isDirectionalLight){var x=n.directional[d];x.direction.setFromMatrixPosition(w.matrixWorld),o.setFromMatrixPosition(w.target.matrixWorld),x.direction.sub(o),x.direction.transformDirection(f),d++}else if(w.isSpotLight){var S=n.spot[g];S.position.setFromMatrixPosition(w.matrixWorld),S.position.applyMatrix4(f),S.direction.setFromMatrixPosition(w.matrixWorld),o.setFromMatrixPosition(w.target.matrixWorld),S.direction.sub(o),S.direction.transformDirection(f),g++}else if(w.isRectAreaLight){var A=n.rectArea[b];A.position.setFromMatrixPosition(w.matrixWorld),A.position.applyMatrix4(f),l.identity(),s.copy(w.matrixWorld),s.premultiply(f),l.extractRotation(s),A.halfWidth.set(w.width*.5,0,0),A.halfHeight.set(0,w.height*.5,0),A.halfWidth.applyMatrix4(l),A.halfHeight.applyMatrix4(l),b++}else if(w.isPointLight){var I=n.point[m];I.position.setFromMatrixPosition(w.matrixWorld),I.position.applyMatrix4(f),m++}else if(w.isHemisphereLight){var P=n.hemi[v];P.direction.setFromMatrixPosition(w.matrixWorld),P.direction.transformDirection(f),P.direction.normalize(),v++}}}return{setup:c,setupView:h,state:n}}function Bh(e,i){var t=new n0(e,i),r=[],n=[];function a(){r.length=0,n.length=0}function o(u){r.push(u)}function s(u){n.push(u)}function l(){t.setup(r)}function c(u){t.setupView(r,u)}var h={lightsArray:r,shadowsArray:n,lights:t};return{init:a,state:h,setupLights:l,setupLightsView:c,pushLight:o,pushShadow:s}}function a0(e,i){var t=new WeakMap;function r(a,o){o===void 0&&(o=0);var s;return t.has(a)===!1?(s=new Bh(e,i),t.set(a,[]),t.get(a).push(s)):o>=t.get(a).length?(s=new Bh(e,i),t.get(a).push(s)):s=t.get(a)[o],s}function n(){t=new WeakMap}return{get:r,dispose:n}}function Jr(e){ye.call(this),this.type="MeshDepthMaterial",this.depthPacking=Ju,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}Jr.prototype=Object.create(ye.prototype),Jr.prototype.constructor=Jr,Jr.prototype.isMeshDepthMaterial=!0,Jr.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this};function Kr(e){ye.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new T,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}Kr.prototype=Object.create(ye.prototype),Kr.prototype.constructor=Kr,Kr.prototype.isMeshDistanceMaterial=!0,Kr.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};var o0=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,s0=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function zh(e,i,t){var r=new ha,n=new X,a=new X,o=new We,s=[],l=[],c={},h={0:ht,1:Hi,2:In},u=new Pt({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new X},radius:{value:4}},vertexShader:s0,fragmentShader:o0}),p=u.clone();p.defines.HORIZONTAL_PASS=1;var d=new pe;d.setAttribute("position",new fe(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var m=new Je(d,u),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=xs,this.render=function(w,x,S){if(g.enabled!==!1&&!(g.autoUpdate===!1&&g.needsUpdate===!1)&&w.length!==0){var A=e.getRenderTarget(),I=e.getActiveCubeFace(),P=e.getActiveMipmapLevel(),R=e.state;R.setBlending(Mr),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);for(var N=0,D=w.length;N<D;N++){var B=w[N],O=B.shadow;if(O===void 0){console.warn("THREE.WebGLShadowMap:",B,"has no shadow.");continue}if(!(O.autoUpdate===!1&&O.needsUpdate===!1)){n.copy(O.mapSize);var U=O.getFrameExtents();if(n.multiply(U),a.copy(O.mapSize),(n.x>t||n.y>t)&&(n.x>t&&(a.x=Math.floor(t/U.x),n.x=a.x*U.x,O.mapSize.x=a.x),n.y>t&&(a.y=Math.floor(t/U.y),n.y=a.y*U.y,O.mapSize.y=a.y)),O.map===null&&!O.isPointLightShadow&&this.type===Gi){var F={minFilter:mt,magFilter:mt,format:Dt};O.map=new Bt(n.x,n.y,F),O.map.texture.name=B.name+".shadowMap",O.mapPass=new Bt(n.x,n.y,F),O.camera.updateProjectionMatrix()}if(O.map===null){var k={minFilter:dt,magFilter:dt,format:Dt};O.map=new Bt(n.x,n.y,k),O.map.texture.name=B.name+".shadowMap",O.camera.updateProjectionMatrix()}e.setRenderTarget(O.map),e.clear();for(var W=O.getViewportCount(),Y=0;Y<W;Y++){var j=O.getViewport(Y);o.set(a.x*j.x,a.y*j.y,a.x*j.z,a.y*j.w),R.viewport(o),O.updateMatrices(B,Y),r=O.getFrustum(),_(x,S,O.camera,B,this.type)}!O.isPointLightShadow&&this.type===Gi&&b(O,S),O.needsUpdate=!1}}g.needsUpdate=!1,e.setRenderTarget(A,I,P)}};function b(w,x){var S=i.update(m);u.uniforms.shadow_pass.value=w.map.texture,u.uniforms.resolution.value=w.mapSize,u.uniforms.radius.value=w.radius,e.setRenderTarget(w.mapPass),e.clear(),e.renderBufferDirect(x,null,S,u,m,null),p.uniforms.shadow_pass.value=w.mapPass.texture,p.uniforms.resolution.value=w.mapSize,p.uniforms.radius.value=w.radius,e.setRenderTarget(w.map),e.clear(),e.renderBufferDirect(x,null,S,p,m,null)}function v(w,x,S){var A=w<<0|x<<1|S<<2,I=s[A];return I===void 0&&(I=new Jr({depthPacking:Ku,morphTargets:w,skinning:x}),s[A]=I),I}function f(w,x,S){var A=w<<0|x<<1|S<<2,I=l[A];return I===void 0&&(I=new Kr({morphTargets:w,skinning:x}),l[A]=I),I}function M(w,x,S,A,I,P,R){var N=null,D=v,B=w.customDepthMaterial;if(A.isPointLight===!0&&(D=f,B=w.customDistanceMaterial),B===void 0){var O=!1;S.morphTargets===!0&&(O=x.morphAttributes&&x.morphAttributes.position&&x.morphAttributes.position.length>0);var U=!1;w.isSkinnedMesh===!0&&(S.skinning===!0?U=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",w));var F=w.isInstancedMesh===!0;N=D(O,U,F)}else N=B;if(e.localClippingEnabled&&S.clipShadows===!0&&S.clippingPlanes.length!==0){var k=N.uuid,W=S.uuid,Y=c[k];Y===void 0&&(Y={},c[k]=Y);var j=Y[W];j===void 0&&(j=N.clone(),Y[W]=j),N=j}return N.visible=S.visible,N.wireframe=S.wireframe,R===Gi?N.side=S.shadowSide!==null?S.shadowSide:S.side:N.side=S.shadowSide!==null?S.shadowSide:h[S.side],N.clipShadows=S.clipShadows,N.clippingPlanes=S.clippingPlanes,N.clipIntersection=S.clipIntersection,N.wireframeLinewidth=S.wireframeLinewidth,N.linewidth=S.linewidth,A.isPointLight===!0&&N.isMeshDistanceMaterial===!0&&(N.referencePosition.setFromMatrixPosition(A.matrixWorld),N.nearDistance=I,N.farDistance=P),N}function _(w,x,S,A,I){if(w.visible!==!1){var P=w.layers.test(x.layers);if(P&&(w.isMesh||w.isLine||w.isPoints)&&(w.castShadow||w.receiveShadow&&I===Gi)&&(!w.frustumCulled||r.intersectsObject(w))){w.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,w.matrixWorld);var R=i.update(w),N=w.material;if(Array.isArray(N))for(var D=R.groups,B=0,O=D.length;B<O;B++){var U=D[B],F=N[U.materialIndex];if(F&&F.visible){var k=M(w,R,F,A,S.near,S.far,I);e.renderBufferDirect(S,null,R,k,w,U)}}else if(N.visible){var W=M(w,R,N,A,S.near,S.far,I);e.renderBufferDirect(S,null,R,W,w,null)}}for(var Y=w.children,j=0,Z=Y.length;j<Z;j++)_(Y[j],x,S,A,I)}}}function l0(e,i,t){var r,n,a=t.isWebGL2;function o(){var z=!1,ne=new We,re=null,ve=new We(0,0,0,0);return{setMask:function(J){re!==J&&!z&&(e.colorMask(J,J,J,J),re=J)},setLocked:function(J){z=J},setClear:function(J,oe,we,Se,ft){ft===!0&&(J*=Se,oe*=Se,we*=Se),ne.set(J,oe,we,Se),ve.equals(ne)===!1&&(e.clearColor(J,oe,we,Se),ve.copy(ne))},reset:function(){z=!1,re=null,ve.set(-1,0,0,0)}}}function s(){var z=!1,ne=null,re=null,ve=null;return{setTest:function(J){J?Z(2929):ae(2929)},setMask:function(J){ne!==J&&!z&&(e.depthMask(J),ne=J)},setFunc:function(J){if(re!==J){if(J)switch(J){case Fc:e.depthFunc(512);break;case Gc:e.depthFunc(519);break;case Hc:e.depthFunc(513);break;case ka:e.depthFunc(515);break;case kc:e.depthFunc(514);break;case Vc:e.depthFunc(518);break;case Wc:e.depthFunc(516);break;case jc:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);re=J}},setLocked:function(J){z=J},setClear:function(J){ve!==J&&(e.clearDepth(J),ve=J)},reset:function(){z=!1,ne=null,re=null,ve=null}}}function l(){var z=!1,ne=null,re=null,ve=null,J=null,oe=null,we=null,Se=null,ft=null;return{setTest:function(Ae){z||(Ae?Z(2960):ae(2960))},setMask:function(Ae){ne!==Ae&&!z&&(e.stencilMask(Ae),ne=Ae)},setFunc:function(Ae,ot,Ge){(re!==Ae||ve!==ot||J!==Ge)&&(e.stencilFunc(Ae,ot,Ge),re=Ae,ve=ot,J=Ge)},setOp:function(Ae,ot,Ge){(oe!==Ae||we!==ot||Se!==Ge)&&(e.stencilOp(Ae,ot,Ge),oe=Ae,we=ot,Se=Ge)},setLocked:function(Ae){z=Ae},setClear:function(Ae){ft!==Ae&&(e.clearStencil(Ae),ft=Ae)},reset:function(){z=!1,ne=null,re=null,ve=null,J=null,oe=null,we=null,Se=null,ft=null}}}var c=new o,h=new s,u=new l,p={},d=null,m=null,g=null,b=null,v=null,f=null,M=null,_=null,w=null,x=!1,S=null,A=null,I=null,P=null,R=null,N=e.getParameter(35661),D=!1,B=0,O=e.getParameter(7938);O.indexOf("WebGL")!==-1?(B=parseFloat(/^WebGL (\d)/.exec(O)[1]),D=B>=1):O.indexOf("OpenGL ES")!==-1&&(B=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),D=B>=2);var U=null,F={},k=new We,W=new We;function Y(z,ne,re){var ve=new Uint8Array(4),J=e.createTexture();e.bindTexture(z,J),e.texParameteri(z,10241,9728),e.texParameteri(z,10240,9728);for(var oe=0;oe<re;oe++)e.texImage2D(ne+oe,0,6408,1,1,0,6408,5121,ve);return J}var j={};j[3553]=Y(3553,3553,1),j[34067]=Y(34067,34069,6),c.setClear(0,0,0,1),h.setClear(1),u.setClear(0),Z(2929),h.setFunc(ka),Ne(!1),xe(ys),Z(2884),Ce(Mr);function Z(z){p[z]!==!0&&(e.enable(z),p[z]=!0)}function ae(z){p[z]!==!1&&(e.disable(z),p[z]=!1)}function me(z){return d!==z?(e.useProgram(z),d=z,!0):!1}var H=(r={},r[ui]=32774,r[Lc]=32778,r[Rc]=32779,r);if(a)H[Ss]=32775,H[Ts]=32776;else{var Ee=i.get("EXT_blend_minmax");Ee!==null&&(H[Ss]=Ee.MIN_EXT,H[Ts]=Ee.MAX_EXT)}var ce=(n={},n[Pc]=0,n[Cc]=1,n[Nc]=768,n[Es]=770,n[Uc]=776,n[Bc]=774,n[Ic]=772,n[Oc]=769,n[As]=771,n[zc]=775,n[Dc]=773,n);function Ce(z,ne,re,ve,J,oe,we,Se){if(z===Mr){m&&(ae(3042),m=!1);return}if(m||(Z(3042),m=!0),z!==Ac){if(z!==g||Se!==x){if((b!==ui||M!==ui)&&(e.blendEquation(32774),b=ui,M=ui),Se)switch(z){case ki:e.blendFuncSeparate(1,771,1,771);break;case _s:e.blendFunc(1,1);break;case ws:e.blendFuncSeparate(0,0,769,771);break;case Ms:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",z);break}else switch(z){case ki:e.blendFuncSeparate(770,771,1,771);break;case _s:e.blendFunc(770,1);break;case ws:e.blendFunc(0,769);break;case Ms:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",z);break}v=null,f=null,_=null,w=null,g=z,x=Se}return}J=J||ne,oe=oe||re,we=we||ve,(ne!==b||J!==M)&&(e.blendEquationSeparate(H[ne],H[J]),b=ne,M=J),(re!==v||ve!==f||oe!==_||we!==w)&&(e.blendFuncSeparate(ce[re],ce[ve],ce[oe],ce[we]),v=re,f=ve,_=oe,w=we),g=z,x=null}function ue(z,ne){z.side===In?ae(2884):Z(2884);var re=z.side===ht;ne&&(re=!re),Ne(re),z.blending===ki&&z.transparent===!1?Ce(Mr):Ce(z.blending,z.blendEquation,z.blendSrc,z.blendDst,z.blendEquationAlpha,z.blendSrcAlpha,z.blendDstAlpha,z.premultipliedAlpha),h.setFunc(z.depthFunc),h.setTest(z.depthTest),h.setMask(z.depthWrite),c.setMask(z.colorWrite);var ve=z.stencilWrite;u.setTest(ve),ve&&(u.setMask(z.stencilWriteMask),u.setFunc(z.stencilFunc,z.stencilRef,z.stencilFuncMask),u.setOp(z.stencilFail,z.stencilZFail,z.stencilZPass)),Be(z.polygonOffset,z.polygonOffsetFactor,z.polygonOffsetUnits)}function Ne(z){S!==z&&(z?e.frontFace(2304):e.frontFace(2305),S=z)}function xe(z){z!==Sc?(Z(2884),z!==A&&(z===ys?e.cullFace(1029):z===Tc?e.cullFace(1028):e.cullFace(1032))):ae(2884),A=z}function Fe(z){z!==I&&(D&&e.lineWidth(z),I=z)}function Be(z,ne,re){z?(Z(32823),(P!==ne||R!==re)&&(e.polygonOffset(ne,re),P=ne,R=re)):ae(32823)}function qe(z){z?Z(3089):ae(3089)}function Ze(z){z===void 0&&(z=33984+N-1),U!==z&&(e.activeTexture(z),U=z)}function pt(z,ne){U===null&&Ze();var re=F[U];re===void 0&&(re={type:void 0,texture:void 0},F[U]=re),(re.type!==z||re.texture!==ne)&&(e.bindTexture(z,ne||j[z]),re.type=z,re.texture=ne)}function it(){var z=F[U];z!==void 0&&z.type!==void 0&&(e.bindTexture(z.type,null),z.type=void 0,z.texture=void 0)}function Qe(){try{e.compressedTexImage2D.apply(e,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function C(){try{e.texImage2D.apply(e,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function L(){try{e.texImage3D.apply(e,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function Q(z){k.equals(z)===!1&&(e.scissor(z.x,z.y,z.z,z.w),k.copy(z))}function K(z){W.equals(z)===!1&&(e.viewport(z.x,z.y,z.z,z.w),W.copy(z))}function ge(){p={},U=null,F={},d=null,m=null,g=null,b=null,v=null,f=null,M=null,_=null,w=null,x=!1,S=null,A=null,I=null,P=null,R=null,c.reset(),h.reset(),u.reset()}return{buffers:{color:c,depth:h,stencil:u},enable:Z,disable:ae,useProgram:me,setBlending:Ce,setMaterial:ue,setFlipSided:Ne,setCullFace:xe,setLineWidth:Fe,setPolygonOffset:Be,setScissorTest:qe,activeTexture:Ze,bindTexture:pt,unbindTexture:it,compressedTexImage2D:Qe,texImage2D:C,texImage3D:L,scissor:Q,viewport:K,reset:ge}}function c0(e,i,t,r,n,a,o){var s,l,c=n.isWebGL2,h=n.maxTextures,u=n.maxCubemapSize,p=n.maxTextureSize,d=n.maxSamples,m=new WeakMap,g,b=!1;try{b=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(C){}function v(C,L){return b?new OffscreenCanvas(C,L):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function f(C,L,Q,K){var ge=1;if((C.width>K||C.height>K)&&(ge=K/Math.max(C.width,C.height)),ge<1||L===!0)if(typeof HTMLImageElement!="undefined"&&C instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&C instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&C instanceof ImageBitmap){var z=L?be.floorPowerOfTwo:Math.floor,ne=z(ge*C.width),re=z(ge*C.height);g===void 0&&(g=v(ne,re));var ve=Q?v(ne,re):g;ve.width=ne,ve.height=re;var J=ve.getContext("2d");return J.drawImage(C,0,0,ne,re),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+C.width+"x"+C.height+") to ("+ne+"x"+re+")."),ve}else return"data"in C&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+C.width+"x"+C.height+")."),C;return C}function M(C){return be.isPowerOfTwo(C.width)&&be.isPowerOfTwo(C.height)}function _(C){return c?!1:C.wrapS!==At||C.wrapT!==At||C.minFilter!==dt&&C.minFilter!==mt}function w(C,L){return C.generateMipmaps&&L&&C.minFilter!==dt&&C.minFilter!==mt}function x(C,L,Q,K){e.generateMipmap(C);var ge=r.get(L);ge.__maxMipLevel=Math.log(Math.max(Q,K))*Math.LOG2E}function S(C,L,Q){if(c===!1)return L;if(C!==null){if(e[C]!==void 0)return e[C];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+C+"'")}var K=L;return L===6403&&(Q===5126&&(K=33326),Q===5131&&(K=33325),Q===5121&&(K=33321)),L===6407&&(Q===5126&&(K=34837),Q===5131&&(K=34843),Q===5121&&(K=32849)),L===6408&&(Q===5126&&(K=34836),Q===5131&&(K=34842),Q===5121&&(K=32856)),(K===33325||K===33326||K===34842||K===34836)&&i.get("EXT_color_buffer_float"),K}function A(C){return C===dt||C===qa||C===Xa?9728:9729}function I(C){var L=C.target;L.removeEventListener("dispose",I),R(L),L.isVideoTexture&&m.delete(L),o.memory.textures--}function P(C){var L=C.target;L.removeEventListener("dispose",P),N(L),o.memory.textures--}function R(C){var L=r.get(C);L.__webglInit!==void 0&&(e.deleteTexture(L.__webglTexture),r.remove(C))}function N(C){var L=r.get(C),Q=r.get(C.texture);if(C){if(Q.__webglTexture!==void 0&&e.deleteTexture(Q.__webglTexture),C.depthTexture&&C.depthTexture.dispose(),C.isWebGLCubeRenderTarget)for(var K=0;K<6;K++)e.deleteFramebuffer(L.__webglFramebuffer[K]),L.__webglDepthbuffer&&e.deleteRenderbuffer(L.__webglDepthbuffer[K]);else e.deleteFramebuffer(L.__webglFramebuffer),L.__webglDepthbuffer&&e.deleteRenderbuffer(L.__webglDepthbuffer),L.__webglMultisampledFramebuffer&&e.deleteFramebuffer(L.__webglMultisampledFramebuffer),L.__webglColorRenderbuffer&&e.deleteRenderbuffer(L.__webglColorRenderbuffer),L.__webglDepthRenderbuffer&&e.deleteRenderbuffer(L.__webglDepthRenderbuffer);r.remove(C.texture),r.remove(C)}}var D=0;function B(){D=0}function O(){var C=D;return C>=h&&console.warn("THREE.WebGLTextures: Trying to use "+C+" texture units while this GPU supports only "+h),D+=1,C}function U(C,L){var Q=r.get(C);if(C.isVideoTexture&&qe(C),C.version>0&&Q.__version!==C.version){var K=C.image;if(K===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(K.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{me(Q,C,L);return}}t.activeTexture(33984+L),t.bindTexture(3553,Q.__webglTexture)}function F(C,L){var Q=r.get(C);if(C.version>0&&Q.__version!==C.version){me(Q,C,L);return}t.activeTexture(33984+L),t.bindTexture(35866,Q.__webglTexture)}function k(C,L){var Q=r.get(C);if(C.version>0&&Q.__version!==C.version){me(Q,C,L);return}t.activeTexture(33984+L),t.bindTexture(32879,Q.__webglTexture)}function W(C,L){var Q=r.get(C);if(C.version>0&&Q.__version!==C.version){H(Q,C,L);return}t.activeTexture(33984+L),t.bindTexture(34067,Q.__webglTexture)}var Y=(s={},s[Fn]=10497,s[At]=33071,s[Gn]=33648,s),j=(l={},l[dt]=9728,l[qa]=9984,l[Xa]=9986,l[mt]=9729,l[Ls]=9985,l[Wi]=9987,l);function Z(C,L,Q){Q?(e.texParameteri(C,10242,Y[L.wrapS]),e.texParameteri(C,10243,Y[L.wrapT]),(C===32879||C===35866)&&e.texParameteri(C,32882,Y[L.wrapR]),e.texParameteri(C,10240,j[L.magFilter]),e.texParameteri(C,10241,j[L.minFilter])):(e.texParameteri(C,10242,33071),e.texParameteri(C,10243,33071),(C===32879||C===35866)&&e.texParameteri(C,32882,33071),(L.wrapS!==At||L.wrapT!==At)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(C,10240,A(L.magFilter)),e.texParameteri(C,10241,A(L.minFilter)),L.minFilter!==dt&&L.minFilter!==mt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var K=i.get("EXT_texture_filter_anisotropic");if(K){if(L.type===Sr&&i.get("OES_texture_float_linear")===null||L.type===Vn&&(c||i.get("OES_texture_half_float_linear"))===null)return;(L.anisotropy>1||r.get(L).__currentAnisotropy)&&(e.texParameterf(C,K.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(L.anisotropy,n.getMaxAnisotropy())),r.get(L).__currentAnisotropy=L.anisotropy)}}function ae(C,L){C.__webglInit===void 0&&(C.__webglInit=!0,L.addEventListener("dispose",I),C.__webglTexture=e.createTexture(),o.memory.textures++)}function me(C,L,Q){var K=3553;L.isDataTexture2DArray&&(K=35866),L.isDataTexture3D&&(K=32879),ae(C,L),t.activeTexture(33984+Q),t.bindTexture(K,C.__webglTexture),e.pixelStorei(37440,L.flipY),e.pixelStorei(37441,L.premultiplyAlpha),e.pixelStorei(3317,L.unpackAlignment);var ge=_(L)&&M(L.image)===!1,z=f(L.image,ge,!1,p),ne=M(z)||c,re=a.convert(L.format),ve=a.convert(L.type),J=S(L.internalFormat,re,ve);Z(K,L,ne);var oe,we=L.mipmaps;if(L.isDepthTexture)J=6402,c?L.type===Sr?J=36012:L.type===kn?J=33190:L.type===qi?J=35056:J=33189:L.type===Sr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),L.format===di&&J===6402&&L.type!==Hn&&L.type!==kn&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),L.type=Hn,ve=a.convert(L.type)),L.format===Xi&&J===6402&&(J=34041,L.type!==qi&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),L.type=qi,ve=a.convert(L.type))),t.texImage2D(3553,0,J,z.width,z.height,0,re,ve,null);else if(L.isDataTexture)if(we.length>0&&ne){for(var Se=0,ft=we.length;Se<ft;Se++)oe=we[Se],t.texImage2D(3553,Se,J,oe.width,oe.height,0,re,ve,oe.data);L.generateMipmaps=!1,C.__maxMipLevel=we.length-1}else t.texImage2D(3553,0,J,z.width,z.height,0,re,ve,z.data),C.__maxMipLevel=0;else if(L.isCompressedTexture){for(var Ae=0,ot=we.length;Ae<ot;Ae++)oe=we[Ae],L.format!==Dt&&L.format!==Hr?re!==null?t.compressedTexImage2D(3553,Ae,J,oe.width,oe.height,0,oe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):t.texImage2D(3553,Ae,J,oe.width,oe.height,0,re,ve,oe.data);C.__maxMipLevel=we.length-1}else if(L.isDataTexture2DArray)t.texImage3D(35866,0,J,z.width,z.height,z.depth,0,re,ve,z.data),C.__maxMipLevel=0;else if(L.isDataTexture3D)t.texImage3D(32879,0,J,z.width,z.height,z.depth,0,re,ve,z.data),C.__maxMipLevel=0;else if(we.length>0&&ne){for(var Ge=0,Wt=we.length;Ge<Wt;Ge++)oe=we[Ge],t.texImage2D(3553,Ge,J,re,ve,oe);L.generateMipmaps=!1,C.__maxMipLevel=we.length-1}else t.texImage2D(3553,0,J,re,ve,z),C.__maxMipLevel=0;w(L,ne)&&x(K,L,z.width,z.height),C.__version=L.version,L.onUpdate&&L.onUpdate(L)}function H(C,L,Q){if(L.image.length===6){ae(C,L),t.activeTexture(33984+Q),t.bindTexture(34067,C.__webglTexture),e.pixelStorei(37440,L.flipY);for(var K=L&&(L.isCompressedTexture||L.image[0].isCompressedTexture),ge=L.image[0]&&L.image[0].isDataTexture,z=[],ne=0;ne<6;ne++)!K&&!ge?z[ne]=f(L.image[ne],!1,!0,u):z[ne]=ge?L.image[ne].image:L.image[ne];var re=z[0],ve=M(re)||c,J=a.convert(L.format),oe=a.convert(L.type),we=S(L.internalFormat,J,oe);Z(34067,L,ve);var Se;if(K){for(var ft=0;ft<6;ft++){Se=z[ft].mipmaps;for(var Ae=0;Ae<Se.length;Ae++){var ot=Se[Ae];L.format!==Dt&&L.format!==Hr?J!==null?t.compressedTexImage2D(34069+ft,Ae,we,ot.width,ot.height,0,ot.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):t.texImage2D(34069+ft,Ae,we,ot.width,ot.height,0,J,oe,ot.data)}}C.__maxMipLevel=Se.length-1}else{Se=L.mipmaps;for(var Ge=0;Ge<6;Ge++)if(ge){t.texImage2D(34069+Ge,0,we,z[Ge].width,z[Ge].height,0,J,oe,z[Ge].data);for(var Wt=0;Wt<Se.length;Wt++){var On=Se[Wt],si=On.image[Ge].image;t.texImage2D(34069+Ge,Wt+1,we,si.width,si.height,0,J,oe,si.data)}}else{t.texImage2D(34069+Ge,0,we,J,oe,z[Ge]);for(var cr=0;cr<Se.length;cr++){var Ur=Se[cr];t.texImage2D(34069+Ge,cr+1,we,J,oe,Ur.image[Ge])}}C.__maxMipLevel=Se.length}w(L,ve)&&x(34067,L,re.width,re.height),C.__version=L.version,L.onUpdate&&L.onUpdate(L)}}function Ee(C,L,Q,K){var ge=a.convert(L.texture.format),z=a.convert(L.texture.type),ne=S(L.texture.internalFormat,ge,z);t.texImage2D(K,0,ne,L.width,L.height,0,ge,z,null),e.bindFramebuffer(36160,C),e.framebufferTexture2D(36160,Q,K,r.get(L.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function ce(C,L,Q){if(e.bindRenderbuffer(36161,C),L.depthBuffer&&!L.stencilBuffer){var K=33189;if(Q){var ge=L.depthTexture;ge&&ge.isDepthTexture&&(ge.type===Sr?K=36012:ge.type===kn&&(K=33190));var z=Be(L);e.renderbufferStorageMultisample(36161,z,K,L.width,L.height)}else e.renderbufferStorage(36161,K,L.width,L.height);e.framebufferRenderbuffer(36160,36096,36161,C)}else if(L.depthBuffer&&L.stencilBuffer){if(Q){var ne=Be(L);e.renderbufferStorageMultisample(36161,ne,35056,L.width,L.height)}else e.renderbufferStorage(36161,34041,L.width,L.height);e.framebufferRenderbuffer(36160,33306,36161,C)}else{var re=a.convert(L.texture.format),ve=a.convert(L.texture.type),J=S(L.texture.internalFormat,re,ve);if(Q){var oe=Be(L);e.renderbufferStorageMultisample(36161,oe,J,L.width,L.height)}else e.renderbufferStorage(36161,J,L.width,L.height)}e.bindRenderbuffer(36161,null)}function Ce(C,L){var Q=L&&L.isWebGLCubeRenderTarget;if(Q)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,C),!(L.depthTexture&&L.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(L.depthTexture).__webglTexture||L.depthTexture.image.width!==L.width||L.depthTexture.image.height!==L.height)&&(L.depthTexture.image.width=L.width,L.depthTexture.image.height=L.height,L.depthTexture.needsUpdate=!0),U(L.depthTexture,0);var K=r.get(L.depthTexture).__webglTexture;if(L.depthTexture.format===di)e.framebufferTexture2D(36160,36096,3553,K,0);else if(L.depthTexture.format===Xi)e.framebufferTexture2D(36160,33306,3553,K,0);else throw new Error("Unknown depthTexture format")}function ue(C){var L=r.get(C),Q=C.isWebGLCubeRenderTarget===!0;if(C.depthTexture){if(Q)throw new Error("target.depthTexture not supported in Cube render targets");Ce(L.__webglFramebuffer,C)}else if(Q){L.__webglDepthbuffer=[];for(var K=0;K<6;K++)e.bindFramebuffer(36160,L.__webglFramebuffer[K]),L.__webglDepthbuffer[K]=e.createRenderbuffer(),ce(L.__webglDepthbuffer[K],C,!1)}else e.bindFramebuffer(36160,L.__webglFramebuffer),L.__webglDepthbuffer=e.createRenderbuffer(),ce(L.__webglDepthbuffer,C,!1);e.bindFramebuffer(36160,null)}function Ne(C){var L=r.get(C),Q=r.get(C.texture);C.addEventListener("dispose",P),Q.__webglTexture=e.createTexture(),o.memory.textures++;var K=C.isWebGLCubeRenderTarget===!0,ge=C.isWebGLMultisampleRenderTarget===!0,z=M(C)||c;if(c&&C.texture.format===Hr&&(C.texture.type===Sr||C.texture.type===Vn)&&(C.texture.format=Dt,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),K){L.__webglFramebuffer=[];for(var ne=0;ne<6;ne++)L.__webglFramebuffer[ne]=e.createFramebuffer()}else if(L.__webglFramebuffer=e.createFramebuffer(),ge)if(c){L.__webglMultisampledFramebuffer=e.createFramebuffer(),L.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,L.__webglColorRenderbuffer);var re=a.convert(C.texture.format),ve=a.convert(C.texture.type),J=S(C.texture.internalFormat,re,ve),oe=Be(C);e.renderbufferStorageMultisample(36161,oe,J,C.width,C.height),e.bindFramebuffer(36160,L.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,L.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),C.depthBuffer&&(L.__webglDepthRenderbuffer=e.createRenderbuffer(),ce(L.__webglDepthRenderbuffer,C,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(K){t.bindTexture(34067,Q.__webglTexture),Z(34067,C.texture,z);for(var we=0;we<6;we++)Ee(L.__webglFramebuffer[we],C,36064,34069+we);w(C.texture,z)&&x(34067,C.texture,C.width,C.height),t.bindTexture(34067,null)}else t.bindTexture(3553,Q.__webglTexture),Z(3553,C.texture,z),Ee(L.__webglFramebuffer,C,36064,3553),w(C.texture,z)&&x(3553,C.texture,C.width,C.height),t.bindTexture(3553,null);C.depthBuffer&&ue(C)}function xe(C){var L=C.texture,Q=M(C)||c;if(w(L,Q)){var K=C.isWebGLCubeRenderTarget?34067:3553,ge=r.get(L).__webglTexture;t.bindTexture(K,ge),x(K,L,C.width,C.height),t.bindTexture(K,null)}}function Fe(C){if(C.isWebGLMultisampleRenderTarget)if(c){var L=r.get(C);e.bindFramebuffer(36008,L.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,L.__webglFramebuffer);var Q=C.width,K=C.height,ge=16384;C.depthBuffer&&(ge|=256),C.stencilBuffer&&(ge|=1024),e.blitFramebuffer(0,0,Q,K,0,0,Q,K,ge,9728),e.bindFramebuffer(36160,L.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function Be(C){return c&&C.isWebGLMultisampleRenderTarget?Math.min(d,C.samples):0}function qe(C){var L=o.render.frame;m.get(C)!==L&&(m.set(C,L),C.update())}var Ze=!1,pt=!1;function it(C,L){C&&C.isWebGLRenderTarget&&(Ze===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Ze=!0),C=C.texture),U(C,L)}function Qe(C,L){C&&C.isWebGLCubeRenderTarget&&(pt===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),pt=!0),C=C.texture),W(C,L)}this.allocateTextureUnit=O,this.resetTextureUnits=B,this.setTexture2D=U,this.setTexture2DArray=F,this.setTexture3D=k,this.setTextureCube=W,this.setupRenderTarget=Ne,this.updateRenderTargetMipmap=xe,this.updateMultisampleRenderTarget=Fe,this.safeSetTexture2D=it,this.safeSetTextureCube=Qe}function Uh(e,i,t){var r=t.isWebGL2;function n(a){var o;if(a===ji)return 5121;if(a===ru)return 32819;if(a===iu)return 32820;if(a===nu)return 33635;if(a===$c)return 5120;if(a===eu)return 5122;if(a===Hn)return 5123;if(a===tu)return 5124;if(a===kn)return 5125;if(a===Sr)return 5126;if(a===Vn)return r?5131:(o=i.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(a===au)return 6406;if(a===Hr)return 6407;if(a===Dt)return 6408;if(a===ou)return 6409;if(a===su)return 6410;if(a===di)return 6402;if(a===Xi)return 34041;if(a===cu)return 6403;if(a===uu)return 36244;if(a===hu)return 33319;if(a===du)return 33320;if(a===pu)return 36248;if(a===fu)return 36249;if(a===Rs||a===Ps||a===Cs||a===Ns)if(o=i.get("WEBGL_compressed_texture_s3tc"),o!==null){if(a===Rs)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===Ps)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===Cs)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===Ns)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===Os||a===Is||a===Ds||a===Bs)if(o=i.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(a===Os)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===Is)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===Ds)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===Bs)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===mu)return o=i.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if((a===zs||a===Us)&&(o=i.get("WEBGL_compressed_texture_etc"),o!==null)){if(a===zs)return o.COMPRESSED_RGB8_ETC2;if(a===Us)return o.COMPRESSED_RGBA8_ETC2_EAC}if(a===vu||a===gu||a===yu||a===xu||a===bu||a===_u||a===wu||a===Mu||a===Su||a===Tu||a===Eu||a===Au||a===Lu||a===Ru||a===Cu||a===Nu||a===Ou||a===Iu||a===Du||a===Bu||a===zu||a===Uu||a===Fu||a===Gu||a===Hu||a===ku||a===Vu||a===Wu)return o=i.get("WEBGL_compressed_texture_astc"),o!==null?a:null;if(a===Pu)return o=i.get("EXT_texture_compression_bptc"),o!==null?a:null;if(a===qi)return r?34042:(o=i.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:n}}function yo(e){e===void 0&&(e=[]),ct.call(this),this.cameras=e}yo.prototype=Object.assign(Object.create(ct.prototype),{constructor:yo,isArrayCamera:!0});function Qr(){se.call(this),this.type="Group"}Qr.prototype=Object.assign(Object.create(se.prototype),{constructor:Qr,isGroup:!0});function fa(){this._targetRay=null,this._grip=null,this._hand=null}Object.assign(fa.prototype,{constructor:fa,getHandSpace:function(){if(this._hand===null&&(this._hand=new Qr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(var e=0;e<=window.XRHand.LITTLE_PHALANX_TIP;e++){var i=new Qr;i.matrixAutoUpdate=!1,i.visible=!1,this._hand.joints.push(i),this._hand.add(i)}return this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Qr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Qr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(e,i,t){var r=null,n=null,a=null,o=this._targetRay,s=this._grip,l=this._hand;if(e&&i.session.visibilityState!=="visible-blurred")if(l&&e.hand){a=!0;for(var c=0;c<=window.XRHand.LITTLE_PHALANX_TIP;c++)if(e.hand[c]){var h=i.getJointPose(e.hand[c],t),u=l.joints[c];h!==null&&(u.matrix.fromArray(h.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.jointRadius=h.radius),u.visible=h!==null;var p=l.joints[window.XRHand.INDEX_PHALANX_TIP],d=l.joints[window.XRHand.THUMB_PHALANX_TIP],m=p.position.distanceTo(d.position),g=.02,b=.005;l.inputState.pinching&&m>g+b?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&m<=g-b&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}}else o!==null&&(r=i.getPose(e.targetRaySpace,t),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale))),s!==null&&e.gripSpace&&(n=i.getPose(e.gripSpace,t),n!==null&&(s.matrix.fromArray(n.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale)));return o!==null&&(o.visible=r!==null),s!==null&&(s.visible=n!==null),l!==null&&(l.visible=a!==null),this}});function Fh(e,i){var t=this,r=null,n=1,a=null,o="local-floor",s=null,l=[],c=new Map,h=new ct;h.layers.enable(1),h.viewport=new We;var u=new ct;u.layers.enable(2),u.viewport=new We;var p=[h,u],d=new yo;d.layers.enable(1),d.layers.enable(2);var m=null,g=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(R){var N=l[R];return N===void 0&&(N=new fa,l[R]=N),N.getTargetRaySpace()},this.getControllerGrip=function(R){var N=l[R];return N===void 0&&(N=new fa,l[R]=N),N.getGripSpace()},this.getHand=function(R){var N=l[R];return N===void 0&&(N=new fa,l[R]=N),N.getHandSpace()};function b(R){var N=c.get(R.inputSource);N&&N.dispatchEvent({type:R.type,data:R.inputSource})}function v(){c.forEach(function(R,N){R.disconnect(N)}),c.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),P.stop(),t.isPresenting=!1,t.dispatchEvent({type:"sessionend"})}function f(R){a=R,P.setContext(r),P.start(),t.isPresenting=!0,t.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(R){n=R,t.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(R){o=R,t.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return r},this.setSession=function(R){if(r=R,r!==null){r.addEventListener("select",b),r.addEventListener("selectstart",b),r.addEventListener("selectend",b),r.addEventListener("squeeze",b),r.addEventListener("squeezestart",b),r.addEventListener("squeezeend",b),r.addEventListener("end",v);var N=i.getContextAttributes();N.xrCompatible!==!0&&i.makeXRCompatible();var D={antialias:N.antialias,alpha:N.alpha,depth:N.depth,stencil:N.stencil,framebufferScaleFactor:n},B=new XRWebGLLayer(r,i,D);r.updateRenderState({baseLayer:B}),r.requestReferenceSpace(o).then(f),r.addEventListener("inputsourceschange",M)}};function M(R){for(var N=r.inputSources,D=0;D<l.length;D++)c.set(N[D],l[D]);for(var B=0;B<R.removed.length;B++){var O=R.removed[B],U=c.get(O);U&&(U.dispatchEvent({type:"disconnected",data:O}),c.delete(O))}for(var F=0;F<R.added.length;F++){var k=R.added[F],W=c.get(k);W&&W.dispatchEvent({type:"connected",data:k})}}var _=new T,w=new T;function x(R,N,D){_.setFromMatrixPosition(N.matrixWorld),w.setFromMatrixPosition(D.matrixWorld);var B=_.distanceTo(w),O=N.projectionMatrix.elements,U=D.projectionMatrix.elements,F=O[14]/(O[10]-1),k=O[14]/(O[10]+1),W=(O[9]+1)/O[5],Y=(O[9]-1)/O[5],j=(O[8]-1)/O[0],Z=(U[8]+1)/U[0],ae=F*j,me=F*Z,H=B/(-j+Z),Ee=H*-j;N.matrixWorld.decompose(R.position,R.quaternion,R.scale),R.translateX(Ee),R.translateZ(H),R.matrixWorld.compose(R.position,R.quaternion,R.scale),R.matrixWorldInverse.copy(R.matrixWorld).invert();var ce=F+H,Ce=k+H,ue=ae-Ee,Ne=me+(B-Ee),xe=W*k/Ce*ce,Fe=Y*k/Ce*ce;R.projectionMatrix.makePerspective(ue,Ne,xe,Fe,ce,Ce)}function S(R,N){N===null?R.matrixWorld.copy(R.matrix):R.matrixWorld.multiplyMatrices(N.matrixWorld,R.matrix),R.matrixWorldInverse.copy(R.matrixWorld).invert()}this.getCamera=function(R){d.near=u.near=h.near=R.near,d.far=u.far=h.far=R.far,(m!==d.near||g!==d.far)&&(r.updateRenderState({depthNear:d.near,depthFar:d.far}),m=d.near,g=d.far);var N=R.parent,D=d.cameras;S(d,N);for(var B=0;B<D.length;B++)S(D[B],N);R.matrixWorld.copy(d.matrixWorld);for(var O=R.children,U=0,F=O.length;U<F;U++)O[U].updateMatrixWorld(!0);return D.length===2?x(d,h,u):d.projectionMatrix.copy(h.projectionMatrix),d};var A=null;function I(R,N){if(s=N.getViewerPose(a),s!==null){var D=s.views,B=r.renderState.baseLayer;e.setFramebuffer(B.framebuffer);var O=!1;D.length!==d.cameras.length&&(d.cameras.length=0,O=!0);for(var U=0;U<D.length;U++){var F=D[U],k=B.getViewport(F),W=p[U];W.matrix.fromArray(F.transform.matrix),W.projectionMatrix.fromArray(F.projectionMatrix),W.viewport.set(k.x,k.y,k.width,k.height),U===0&&d.matrix.copy(W.matrix),O===!0&&d.cameras.push(W)}}for(var Y=r.inputSources,j=0;j<l.length;j++){var Z=l[j],ae=Y[j];Z.update(ae,N,a)}A&&A(R,N)}var P=new mh;P.setAnimationLoop(I),this.setAnimationLoop=function(R){A=R},this.dispose=function(){}}Object.assign(Fh.prototype,ur.prototype);function u0(e){function i(v,f){v.fogColor.value.copy(f.color),f.isFog?(v.fogNear.value=f.near,v.fogFar.value=f.far):f.isFogExp2&&(v.fogDensity.value=f.density)}function t(v,f,M,_){f.isMeshBasicMaterial?r(v,f):f.isMeshLambertMaterial?(r(v,f),l(v,f)):f.isMeshToonMaterial?(r(v,f),h(v,f)):f.isMeshPhongMaterial?(r(v,f),c(v,f)):f.isMeshStandardMaterial?(r(v,f),f.isMeshPhysicalMaterial?p(v,f):u(v,f)):f.isMeshMatcapMaterial?(r(v,f),d(v,f)):f.isMeshDepthMaterial?(r(v,f),m(v,f)):f.isMeshDistanceMaterial?(r(v,f),g(v,f)):f.isMeshNormalMaterial?(r(v,f),b(v,f)):f.isLineBasicMaterial?(n(v,f),f.isLineDashedMaterial&&a(v,f)):f.isPointsMaterial?o(v,f,M,_):f.isSpriteMaterial?s(v,f):f.isShadowMaterial?(v.color.value.copy(f.color),v.opacity.value=f.opacity):f.isShaderMaterial&&(f.uniformsNeedUpdate=!1)}function r(v,f){v.opacity.value=f.opacity,f.color&&v.diffuse.value.copy(f.color),f.emissive&&v.emissive.value.copy(f.emissive).multiplyScalar(f.emissiveIntensity),f.map&&(v.map.value=f.map),f.alphaMap&&(v.alphaMap.value=f.alphaMap),f.specularMap&&(v.specularMap.value=f.specularMap);var M=e.get(f).envMap;if(M){v.envMap.value=M,v.flipEnvMap.value=M.isCubeTexture&&M._needsFlipEnvMap?-1:1,v.reflectivity.value=f.reflectivity,v.refractionRatio.value=f.refractionRatio;var _=e.get(M).__maxMipLevel;_!==void 0&&(v.maxMipLevel.value=_)}f.lightMap&&(v.lightMap.value=f.lightMap,v.lightMapIntensity.value=f.lightMapIntensity),f.aoMap&&(v.aoMap.value=f.aoMap,v.aoMapIntensity.value=f.aoMapIntensity);var w;f.map?w=f.map:f.specularMap?w=f.specularMap:f.displacementMap?w=f.displacementMap:f.normalMap?w=f.normalMap:f.bumpMap?w=f.bumpMap:f.roughnessMap?w=f.roughnessMap:f.metalnessMap?w=f.metalnessMap:f.alphaMap?w=f.alphaMap:f.emissiveMap?w=f.emissiveMap:f.clearcoatMap?w=f.clearcoatMap:f.clearcoatNormalMap?w=f.clearcoatNormalMap:f.clearcoatRoughnessMap&&(w=f.clearcoatRoughnessMap),w!==void 0&&(w.isWebGLRenderTarget&&(w=w.texture),w.matrixAutoUpdate===!0&&w.updateMatrix(),v.uvTransform.value.copy(w.matrix));var x;f.aoMap?x=f.aoMap:f.lightMap&&(x=f.lightMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),v.uv2Transform.value.copy(x.matrix))}function n(v,f){v.diffuse.value.copy(f.color),v.opacity.value=f.opacity}function a(v,f){v.dashSize.value=f.dashSize,v.totalSize.value=f.dashSize+f.gapSize,v.scale.value=f.scale}function o(v,f,M,_){v.diffuse.value.copy(f.color),v.opacity.value=f.opacity,v.size.value=f.size*M,v.scale.value=_*.5,f.map&&(v.map.value=f.map),f.alphaMap&&(v.alphaMap.value=f.alphaMap);var w;f.map?w=f.map:f.alphaMap&&(w=f.alphaMap),w!==void 0&&(w.matrixAutoUpdate===!0&&w.updateMatrix(),v.uvTransform.value.copy(w.matrix))}function s(v,f){v.diffuse.value.copy(f.color),v.opacity.value=f.opacity,v.rotation.value=f.rotation,f.map&&(v.map.value=f.map),f.alphaMap&&(v.alphaMap.value=f.alphaMap);var M;f.map?M=f.map:f.alphaMap&&(M=f.alphaMap),M!==void 0&&(M.matrixAutoUpdate===!0&&M.updateMatrix(),v.uvTransform.value.copy(M.matrix))}function l(v,f){f.emissiveMap&&(v.emissiveMap.value=f.emissiveMap)}function c(v,f){v.specular.value.copy(f.specular),v.shininess.value=Math.max(f.shininess,1e-4),f.emissiveMap&&(v.emissiveMap.value=f.emissiveMap),f.bumpMap&&(v.bumpMap.value=f.bumpMap,v.bumpScale.value=f.bumpScale,f.side===ht&&(v.bumpScale.value*=-1)),f.normalMap&&(v.normalMap.value=f.normalMap,v.normalScale.value.copy(f.normalScale),f.side===ht&&v.normalScale.value.negate()),f.displacementMap&&(v.displacementMap.value=f.displacementMap,v.displacementScale.value=f.displacementScale,v.displacementBias.value=f.displacementBias)}function h(v,f){f.gradientMap&&(v.gradientMap.value=f.gradientMap),f.emissiveMap&&(v.emissiveMap.value=f.emissiveMap),f.bumpMap&&(v.bumpMap.value=f.bumpMap,v.bumpScale.value=f.bumpScale,f.side===ht&&(v.bumpScale.value*=-1)),f.normalMap&&(v.normalMap.value=f.normalMap,v.normalScale.value.copy(f.normalScale),f.side===ht&&v.normalScale.value.negate()),f.displacementMap&&(v.displacementMap.value=f.displacementMap,v.displacementScale.value=f.displacementScale,v.displacementBias.value=f.displacementBias)}function u(v,f){v.roughness.value=f.roughness,v.metalness.value=f.metalness,f.roughnessMap&&(v.roughnessMap.value=f.roughnessMap),f.metalnessMap&&(v.metalnessMap.value=f.metalnessMap),f.emissiveMap&&(v.emissiveMap.value=f.emissiveMap),f.bumpMap&&(v.bumpMap.value=f.bumpMap,v.bumpScale.value=f.bumpScale,f.side===ht&&(v.bumpScale.value*=-1)),f.normalMap&&(v.normalMap.value=f.normalMap,v.normalScale.value.copy(f.normalScale),f.side===ht&&v.normalScale.value.negate()),f.displacementMap&&(v.displacementMap.value=f.displacementMap,v.displacementScale.value=f.displacementScale,v.displacementBias.value=f.displacementBias);var M=e.get(f).envMap;M&&(v.envMapIntensity.value=f.envMapIntensity)}function p(v,f){u(v,f),v.reflectivity.value=f.reflectivity,v.clearcoat.value=f.clearcoat,v.clearcoatRoughness.value=f.clearcoatRoughness,f.sheen&&v.sheen.value.copy(f.sheen),f.clearcoatMap&&(v.clearcoatMap.value=f.clearcoatMap),f.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=f.clearcoatRoughnessMap),f.clearcoatNormalMap&&(v.clearcoatNormalScale.value.copy(f.clearcoatNormalScale),v.clearcoatNormalMap.value=f.clearcoatNormalMap,f.side===ht&&v.clearcoatNormalScale.value.negate()),v.transmission.value=f.transmission,f.transmissionMap&&(v.transmissionMap.value=f.transmissionMap)}function d(v,f){f.matcap&&(v.matcap.value=f.matcap),f.bumpMap&&(v.bumpMap.value=f.bumpMap,v.bumpScale.value=f.bumpScale,f.side===ht&&(v.bumpScale.value*=-1)),f.normalMap&&(v.normalMap.value=f.normalMap,v.normalScale.value.copy(f.normalScale),f.side===ht&&v.normalScale.value.negate()),f.displacementMap&&(v.displacementMap.value=f.displacementMap,v.displacementScale.value=f.displacementScale,v.displacementBias.value=f.displacementBias)}function m(v,f){f.displacementMap&&(v.displacementMap.value=f.displacementMap,v.displacementScale.value=f.displacementScale,v.displacementBias.value=f.displacementBias)}function g(v,f){f.displacementMap&&(v.displacementMap.value=f.displacementMap,v.displacementScale.value=f.displacementScale,v.displacementBias.value=f.displacementBias),v.referencePosition.value.copy(f.referencePosition),v.nearDistance.value=f.nearDistance,v.farDistance.value=f.farDistance}function b(v,f){f.bumpMap&&(v.bumpMap.value=f.bumpMap,v.bumpScale.value=f.bumpScale,f.side===ht&&(v.bumpScale.value*=-1)),f.normalMap&&(v.normalMap.value=f.normalMap,v.normalScale.value.copy(f.normalScale),f.side===ht&&v.normalScale.value.negate()),f.displacementMap&&(v.displacementMap.value=f.displacementMap,v.displacementScale.value=f.displacementScale,v.displacementBias.value=f.displacementBias)}return{refreshFogUniforms:i,refreshMaterialUniforms:t}}function h0(){var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return e.style.display="block",e}function ma(e){e=e||{};var i=e.canvas!==void 0?e.canvas:h0(),t=e.context!==void 0?e.context:null,r=e.alpha!==void 0?e.alpha:!1,n=e.depth!==void 0?e.depth:!0,a=e.stencil!==void 0?e.stencil:!0,o=e.antialias!==void 0?e.antialias:!1,s=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,l=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,c=e.powerPreference!==void 0?e.powerPreference:"default",h=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,u=null,p=null,d=[];this.domElement=i,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Lt,this.physicallyCorrectLights=!1,this.toneMapping=hi,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var m=this,g=!1,b=null,v=0,f=0,M=null,_=null,w=-1,x=null,S=new We,A=new We,I=null,P=i.width,R=i.height,N=1,D=null,B=null,O=new We(0,0,P,R),U=new We(0,0,P,R),F=!1,k=new ha,W=!1,Y=!1,j=new Te,Z=new T,ae={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function me(){return M===null?N:1}var H=t;function Ee(E,V){for(var G=0;G<E.length;G++){var q=E[G],$=i.getContext(q,V);if($!==null)return $}return null}try{var ce={alpha:r,depth:n,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:h};if(i.addEventListener("webglcontextlost",Ae,!1),i.addEventListener("webglcontextrestored",ot,!1),H===null){var Ce=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&Ce.shift(),H=Ee(Ce,ce),H===null)throw Ee(Ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}H.getShaderPrecisionFormat===void 0&&(H.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(E){throw console.error("THREE.WebGLRenderer: "+E.message),E}var ue,Ne,xe,Fe,Be,qe,Ze,pt,it,Qe,C,L,Q,K,ge,z,ne,re,ve,J,oe;function we(){ue=new Vv(H),Ne=new Gv(H,ue,e),Ne.isWebGL2===!1&&(ue.get("WEBGL_depth_texture"),ue.get("OES_texture_float"),ue.get("OES_texture_half_float"),ue.get("OES_texture_half_float_linear"),ue.get("OES_standard_derivatives"),ue.get("OES_element_index_uint"),ue.get("OES_vertex_array_object"),ue.get("ANGLE_instanced_arrays")),ue.get("OES_texture_float_linear"),J=new Uh(H,ue,Ne),xe=new l0(H,ue,Ne),xe.scissor(A.copy(U).multiplyScalar(N).floor()),xe.viewport(S.copy(O).multiplyScalar(N).floor()),Fe=new qv(H),Be=new Jg,qe=new c0(H,ue,xe,Be,Ne,J,Fe),Ze=new kv(m),pt=new mf(H,Ne),oe=new Uv(H,ue,pt,Ne),it=new Wv(H,pt,Fe,oe),Qe=new Jv(H,it,pt,Fe),ne=new Zv(H),ge=new Hv(Be),C=new Zg(m,Ze,ue,Ne,oe,ge),L=new u0(Be),Q=new $g(Be),K=new a0(ue,Ne),z=new zv(m,Ze,xe,Qe,s),re=new Fv(H,ue,Fe,Ne),ve=new jv(H,ue,Fe,Ne),Fe.programs=C.programs,m.capabilities=Ne,m.extensions=ue,m.properties=Be,m.renderLists=Q,m.state=xe,m.info=Fe}we();var Se=new Fh(m,H);this.xr=Se;var ft=new zh(m,Qe,Ne.maxTextureSize);this.shadowMap=ft,this.getContext=function(){return H},this.getContextAttributes=function(){return H.getContextAttributes()},this.forceContextLoss=function(){var E=ue.get("WEBGL_lose_context");E&&E.loseContext()},this.forceContextRestore=function(){var E=ue.get("WEBGL_lose_context");E&&E.restoreContext()},this.getPixelRatio=function(){return N},this.setPixelRatio=function(E){E!==void 0&&(N=E,this.setSize(P,R,!1))},this.getSize=function(E){return E===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),E=new X),E.set(P,R)},this.setSize=function(E,V,G){if(Se.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}P=E,R=V,i.width=Math.floor(E*N),i.height=Math.floor(V*N),G!==!1&&(i.style.width=E+"px",i.style.height=V+"px"),this.setViewport(0,0,E,V)},this.getDrawingBufferSize=function(E){return E===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),E=new X),E.set(P*N,R*N).floor()},this.setDrawingBufferSize=function(E,V,G){P=E,R=V,N=G,i.width=Math.floor(E*G),i.height=Math.floor(V*G),this.setViewport(0,0,E,V)},this.getCurrentViewport=function(E){return E===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),E=new We),E.copy(S)},this.getViewport=function(E){return E.copy(O)},this.setViewport=function(E,V,G,q){E.isVector4?O.set(E.x,E.y,E.z,E.w):O.set(E,V,G,q),xe.viewport(S.copy(O).multiplyScalar(N).floor())},this.getScissor=function(E){return E.copy(U)},this.setScissor=function(E,V,G,q){E.isVector4?U.set(E.x,E.y,E.z,E.w):U.set(E,V,G,q),xe.scissor(A.copy(U).multiplyScalar(N).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(E){xe.setScissorTest(F=E)},this.setOpaqueSort=function(E){D=E},this.setTransparentSort=function(E){B=E},this.getClearColor=function(E){return E===void 0&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),E=new ie),E.copy(z.getClearColor())},this.setClearColor=function(){z.setClearColor.apply(z,arguments)},this.getClearAlpha=function(){return z.getClearAlpha()},this.setClearAlpha=function(){z.setClearAlpha.apply(z,arguments)},this.clear=function(E,V,G){var q=0;(E===void 0||E)&&(q|=16384),(V===void 0||V)&&(q|=256),(G===void 0||G)&&(q|=1024),H.clear(q)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",Ae,!1),i.removeEventListener("webglcontextrestored",ot,!1),Q.dispose(),K.dispose(),Be.dispose(),Ze.dispose(),Qe.dispose(),oe.dispose(),Se.dispose(),wr.stop()};function Ae(E){E.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function ot(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1,we()}function Ge(E){var V=E.target;V.removeEventListener("dispose",Ge),Wt(V)}function Wt(E){On(E),Be.remove(E)}function On(E){var V=Be.get(E).program;V!==void 0&&C.releaseProgram(V)}function si(E,V){E.render(function(G){m.renderBufferImmediate(G,V)})}this.renderBufferImmediate=function(E,V){oe.initAttributes();var G=Be.get(E);E.hasPositions&&!G.position&&(G.position=H.createBuffer()),E.hasNormals&&!G.normal&&(G.normal=H.createBuffer()),E.hasUvs&&!G.uv&&(G.uv=H.createBuffer()),E.hasColors&&!G.color&&(G.color=H.createBuffer());var q=V.getAttributes();E.hasPositions&&(H.bindBuffer(34962,G.position),H.bufferData(34962,E.positionArray,35048),oe.enableAttribute(q.position),H.vertexAttribPointer(q.position,3,5126,!1,0,0)),E.hasNormals&&(H.bindBuffer(34962,G.normal),H.bufferData(34962,E.normalArray,35048),oe.enableAttribute(q.normal),H.vertexAttribPointer(q.normal,3,5126,!1,0,0)),E.hasUvs&&(H.bindBuffer(34962,G.uv),H.bufferData(34962,E.uvArray,35048),oe.enableAttribute(q.uv),H.vertexAttribPointer(q.uv,2,5126,!1,0,0)),E.hasColors&&(H.bindBuffer(34962,G.color),H.bufferData(34962,E.colorArray,35048),oe.enableAttribute(q.color),H.vertexAttribPointer(q.color,3,5126,!1,0,0)),oe.disableUnusedAttributes(),H.drawArrays(4,0,E.count),E.count=0},this.renderBufferDirect=function(E,V,G,q,$,Oe){V===null&&(V=ae);var Le=$.isMesh&&$.matrixWorld.determinant()<0,He=Ga(E,V,q,$);xe.setMaterial(q,Le);var _e=G.index,st=G.attributes.position;if(_e===null){if(st===void 0||st.count===0)return}else if(_e.count===0)return;var tt=1;q.wireframe===!0&&(_e=it.getWireframeAttribute(G),tt=2),(q.morphTargets||q.morphNormals)&&ne.update($,G,q,He),oe.setup($,q,He,G,_e);var lt,he=re;_e!==null&&(lt=pt.get(_e),he=ve,he.setIndex(lt));var gt=_e!==null?_e.count:st.count,yt=G.drawRange.start*tt,ze=G.drawRange.count*tt,ut=Oe!==null?Oe.start*tt:0,De=Oe!==null?Oe.count*tt:Infinity,Me=Math.max(yt,ut),Ue=Math.min(gt,yt+ze,ut+De)-1,Pe=Math.max(0,Ue-Me+1);if(Pe!==0){if($.isMesh)q.wireframe===!0?(xe.setLineWidth(q.wireframeLinewidth*me()),he.setMode(1)):he.setMode(4);else if($.isLine){var Ie=q.linewidth;Ie===void 0&&(Ie=1),xe.setLineWidth(Ie*me()),$.isLineSegments?he.setMode(1):$.isLineLoop?he.setMode(2):he.setMode(3)}else $.isPoints?he.setMode(0):$.isSprite&&he.setMode(4);if($.isInstancedMesh)he.renderInstances(Me,Pe,$.count);else if(G.isInstancedBufferGeometry){var $e=Math.min(G.instanceCount,G._maxInstanceCount);he.renderInstances(Me,Pe,$e)}else he.render(Me,Pe)}},this.compile=function(E,V){p=K.get(E),p.init(),E.traverseVisible(function(q){q.isLight&&q.layers.test(V.layers)&&(p.pushLight(q),q.castShadow&&p.pushShadow(q))}),p.setupLights();var G=new WeakMap;E.traverse(function(q){var $=q.material;if($)if(Array.isArray($))for(var Oe=0;Oe<$.length;Oe++){var Le=$[Oe];G.has(Le)===!1&&(ci(Le,E,q),G.set(Le))}else G.has($)===!1&&(ci($,E,q),G.set($))})};var cr=null;function Ur(E){Se.isPresenting||cr&&cr(E)}var wr=new mh;wr.setAnimationLoop(Ur),typeof window!="undefined"&&wr.setContext(window),this.setAnimationLoop=function(E){cr=E,Se.setAnimationLoop(E),E===null?wr.stop():wr.start()},this.render=function(E,V){var G,q;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),G=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),q=arguments[3]),V!==void 0&&V.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g!==!0){oe.resetDefaultState(),w=-1,x=null,E.autoUpdate===!0&&E.updateMatrixWorld(),V.parent===null&&V.updateMatrixWorld(),Se.enabled===!0&&Se.isPresenting===!0&&(V=Se.getCamera(V)),E.isScene===!0&&E.onBeforeRender(m,E,V,G||M),p=K.get(E,d.length),p.init(),d.push(p),j.multiplyMatrices(V.projectionMatrix,V.matrixWorldInverse),k.setFromProjectionMatrix(j),Y=this.localClippingEnabled,W=ge.init(this.clippingPlanes,Y,V),u=Q.get(E,V),u.init(),Fr(E,V,0,m.sortObjects),u.finish(),m.sortObjects===!0&&u.sort(D,B),W===!0&&ge.beginShadows();var $=p.state.shadowsArray;ft.render($,E,V),p.setupLights(),p.setupLightsView(V),W===!0&&ge.endShadows(),this.info.autoReset===!0&&this.info.reset(),G!==void 0&&this.setRenderTarget(G),z.render(u,E,V,q);var Oe=u.opaque,Le=u.transparent;Oe.length>0&&li(Oe,E,V),Le.length>0&&li(Le,E,V),E.isScene===!0&&E.onAfterRender(m,E,V),M!==null&&(qe.updateRenderTargetMipmap(M),qe.updateMultisampleRenderTarget(M)),xe.buffers.depth.setTest(!0),xe.buffers.depth.setMask(!0),xe.buffers.color.setMask(!0),xe.setPolygonOffset(!1),d.pop(),d.length>0?p=d[d.length-1]:p=null,u=null}};function Fr(E,V,G,q){if(E.visible!==!1){var $=E.layers.test(V.layers);if($){if(E.isGroup)G=E.renderOrder;else if(E.isLOD)E.autoUpdate===!0&&E.update(V);else if(E.isLight)p.pushLight(E),E.castShadow&&p.pushShadow(E);else if(E.isSprite){if(!E.frustumCulled||k.intersectsSprite(E)){q&&Z.setFromMatrixPosition(E.matrixWorld).applyMatrix4(j);var Oe=Qe.update(E),Le=E.material;Le.visible&&u.push(E,Oe,Le,G,Z.z,null)}}else if(E.isImmediateRenderObject)q&&Z.setFromMatrixPosition(E.matrixWorld).applyMatrix4(j),u.push(E,null,E.material,G,Z.z,null);else if((E.isMesh||E.isLine||E.isPoints)&&(E.isSkinnedMesh&&E.skeleton.frame!==Fe.render.frame&&(E.skeleton.update(),E.skeleton.frame=Fe.render.frame),!E.frustumCulled||k.intersectsObject(E))){q&&Z.setFromMatrixPosition(E.matrixWorld).applyMatrix4(j);var He=Qe.update(E),_e=E.material;if(Array.isArray(_e))for(var st=He.groups,tt=0,lt=st.length;tt<lt;tt++){var he=st[tt],gt=_e[he.materialIndex];gt&&gt.visible&&u.push(E,He,gt,G,Z.z,he)}else _e.visible&&u.push(E,He,_e,G,Z.z,null)}}for(var yt=E.children,ze=0,ut=yt.length;ze<ut;ze++)Fr(yt[ze],V,G,q)}}function li(E,V,G){for(var q=V.isScene===!0?V.overrideMaterial:null,$=0,Oe=E.length;$<Oe;$++){var Le=E[$],He=Le.object,_e=Le.geometry,st=q===null?Le.material:q,tt=Le.group;if(G.isArrayCamera)for(var lt=G.cameras,he=0,gt=lt.length;he<gt;he++){var yt=lt[he];He.layers.test(yt.layers)&&(xe.viewport(S.copy(yt.viewport)),p.setupLightsView(yt),Ui(He,V,yt,_e,st,tt))}else Ui(He,V,G,_e,st,tt)}}function Ui(E,V,G,q,$,Oe){if(E.onBeforeRender(m,V,G,q,$,Oe),E.modelViewMatrix.multiplyMatrices(G.matrixWorldInverse,E.matrixWorld),E.normalMatrix.getNormalMatrix(E.modelViewMatrix),E.isImmediateRenderObject){var Le=Ga(G,V,$,E);xe.setMaterial($),oe.reset(),si(E,Le)}else m.renderBufferDirect(G,V,q,$,E,Oe);E.onAfterRender(m,V,G,q,$,Oe)}function ci(E,V,G){V.isScene!==!0&&(V=ae);var q=Be.get(E),$=p.state.lights,Oe=p.state.shadowsArray,Le=$.state.version,He=C.getParameters(E,$.state,Oe,V,G),_e=C.getProgramCacheKey(He),st=q.program,tt=!0;if(st===void 0)E.addEventListener("dispose",Ge);else if(st.cacheKey!==_e)On(E);else if(q.lightsStateVersion!==Le)tt=!1;else if(He.shaderID!==void 0){var lt=E.isMeshStandardMaterial?V.environment:null;q.envMap=Ze.get(E.envMap||lt);return}else tt=!1;tt&&(He.uniforms=C.getUniforms(E),E.onBeforeCompile(He,m),st=C.acquireProgram(He,_e),q.program=st,q.uniforms=He.uniforms,q.outputEncoding=He.outputEncoding);var he=q.uniforms;(!E.isShaderMaterial&&!E.isRawShaderMaterial||E.clipping===!0)&&(q.numClippingPlanes=ge.numPlanes,q.numIntersection=ge.numIntersection,he.clippingPlanes=ge.uniform),q.environment=E.isMeshStandardMaterial?V.environment:null,q.fog=V.fog,q.envMap=Ze.get(E.envMap||q.environment),q.needsLights=ms(E),q.lightsStateVersion=Le,q.needsLights&&(he.ambientLightColor.value=$.state.ambient,he.lightProbe.value=$.state.probe,he.directionalLights.value=$.state.directional,he.directionalLightShadows.value=$.state.directionalShadow,he.spotLights.value=$.state.spot,he.spotLightShadows.value=$.state.spotShadow,he.rectAreaLights.value=$.state.rectArea,he.ltc_1.value=$.state.rectAreaLTC1,he.ltc_2.value=$.state.rectAreaLTC2,he.pointLights.value=$.state.point,he.pointLightShadows.value=$.state.pointShadow,he.hemisphereLights.value=$.state.hemi,he.directionalShadowMap.value=$.state.directionalShadowMap,he.directionalShadowMatrix.value=$.state.directionalShadowMatrix,he.spotShadowMap.value=$.state.spotShadowMap,he.spotShadowMatrix.value=$.state.spotShadowMatrix,he.pointShadowMap.value=$.state.pointShadowMap,he.pointShadowMatrix.value=$.state.pointShadowMatrix);var gt=q.program.getUniforms(),yt=Zr.seqWithValue(gt.seq,he);q.uniformsList=yt}function Ga(E,V,G,q){V.isScene!==!0&&(V=ae),qe.resetTextureUnits();var $=V.fog,Oe=G.isMeshStandardMaterial?V.environment:null,Le=M===null?m.outputEncoding:M.texture.encoding,He=Ze.get(G.envMap||Oe),_e=Be.get(G),st=p.state.lights;if(W===!0&&(Y===!0||E!==x)){var tt=E===x&&G.id===w;ge.setState(G,E,tt)}G.version===_e.__version?(G.fog&&_e.fog!==$||_e.environment!==Oe||_e.needsLights&&_e.lightsStateVersion!==st.state.version||_e.numClippingPlanes!==void 0&&(_e.numClippingPlanes!==ge.numPlanes||_e.numIntersection!==ge.numIntersection)||_e.outputEncoding!==Le||_e.envMap!==He)&&ci(G,V,q):(ci(G,V,q),_e.__version=G.version);var lt=!1,he=!1,gt=!1,yt=_e.program,ze=yt.getUniforms(),ut=_e.uniforms;if(xe.useProgram(yt.program)&&(lt=!0,he=!0,gt=!0),G.id!==w&&(w=G.id,he=!0),lt||x!==E){if(ze.setValue(H,"projectionMatrix",E.projectionMatrix),Ne.logarithmicDepthBuffer&&ze.setValue(H,"logDepthBufFC",2/(Math.log(E.far+1)/Math.LN2)),x!==E&&(x=E,he=!0,gt=!0),G.isShaderMaterial||G.isMeshPhongMaterial||G.isMeshToonMaterial||G.isMeshStandardMaterial||G.envMap){var De=ze.map.cameraPosition;De!==void 0&&De.setValue(H,Z.setFromMatrixPosition(E.matrixWorld))}(G.isMeshPhongMaterial||G.isMeshToonMaterial||G.isMeshLambertMaterial||G.isMeshBasicMaterial||G.isMeshStandardMaterial||G.isShaderMaterial)&&ze.setValue(H,"isOrthographic",E.isOrthographicCamera===!0),(G.isMeshPhongMaterial||G.isMeshToonMaterial||G.isMeshLambertMaterial||G.isMeshBasicMaterial||G.isMeshStandardMaterial||G.isShaderMaterial||G.isShadowMaterial||G.skinning)&&ze.setValue(H,"viewMatrix",E.matrixWorldInverse)}if(G.skinning){ze.setOptional(H,q,"bindMatrix"),ze.setOptional(H,q,"bindMatrixInverse");var Me=q.skeleton;if(Me){var Ue=Me.bones;if(Ne.floatVertexTextures){if(Me.boneTexture===null){var Pe=Math.sqrt(Ue.length*4);Pe=be.ceilPowerOfTwo(Pe),Pe=Math.max(Pe,4);var Ie=new Float32Array(Pe*Pe*4);Ie.set(Me.boneMatrices);var $e=new Nr(Ie,Pe,Pe,Dt,Sr);Me.boneMatrices=Ie,Me.boneTexture=$e,Me.boneTextureSize=Pe}ze.setValue(H,"boneTexture",Me.boneTexture,qe),ze.setValue(H,"boneTextureSize",Me.boneTextureSize)}else ze.setOptional(H,Me,"boneMatrices")}}return(he||_e.receiveShadow!==q.receiveShadow)&&(_e.receiveShadow=q.receiveShadow,ze.setValue(H,"receiveShadow",q.receiveShadow)),he&&(ze.setValue(H,"toneMappingExposure",m.toneMappingExposure),_e.needsLights&&Ha(ut,gt),$&&G.fog&&L.refreshFogUniforms(ut,$),L.refreshMaterialUniforms(ut,G,N,R),Zr.upload(H,_e.uniformsList,ut,qe)),G.isShaderMaterial&&G.uniformsNeedUpdate===!0&&(Zr.upload(H,_e.uniformsList,ut,qe),G.uniformsNeedUpdate=!1),G.isSpriteMaterial&&ze.setValue(H,"center",q.center),ze.setValue(H,"modelViewMatrix",q.modelViewMatrix),ze.setValue(H,"normalMatrix",q.normalMatrix),ze.setValue(H,"modelMatrix",q.matrixWorld),yt}function Ha(E,V){E.ambientLightColor.needsUpdate=V,E.lightProbe.needsUpdate=V,E.directionalLights.needsUpdate=V,E.directionalLightShadows.needsUpdate=V,E.pointLights.needsUpdate=V,E.pointLightShadows.needsUpdate=V,E.spotLights.needsUpdate=V,E.spotLightShadows.needsUpdate=V,E.rectAreaLights.needsUpdate=V,E.hemisphereLights.needsUpdate=V}function ms(E){return E.isMeshLambertMaterial||E.isMeshToonMaterial||E.isMeshPhongMaterial||E.isMeshStandardMaterial||E.isShadowMaterial||E.isShaderMaterial&&E.lights===!0}this.setFramebuffer=function(E){b!==E&&M===null&&H.bindFramebuffer(36160,E),b=E},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return f},this.getRenderList=function(){return u},this.setRenderList=function(E){u=E},this.getRenderTarget=function(){return M},this.setRenderTarget=function(E,V,G){V===void 0&&(V=0),G===void 0&&(G=0),M=E,v=V,f=G,E&&Be.get(E).__webglFramebuffer===void 0&&qe.setupRenderTarget(E);var q=b,$=!1;if(E){var Oe=Be.get(E).__webglFramebuffer;E.isWebGLCubeRenderTarget?(q=Oe[V],$=!0):E.isWebGLMultisampleRenderTarget?q=Be.get(E).__webglMultisampledFramebuffer:q=Oe,S.copy(E.viewport),A.copy(E.scissor),I=E.scissorTest}else S.copy(O).multiplyScalar(N).floor(),A.copy(U).multiplyScalar(N).floor(),I=F;if(_!==q&&(H.bindFramebuffer(36160,q),_=q),xe.viewport(S),xe.scissor(A),xe.setScissorTest(I),$){var Le=Be.get(E.texture);H.framebufferTexture2D(36160,36064,34069+V,Le.__webglTexture,G)}},this.readRenderTargetPixels=function(E,V,G,q,$,Oe,Le){if(!(E&&E.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var He=Be.get(E).__webglFramebuffer;if(E.isWebGLCubeRenderTarget&&Le!==void 0&&(He=He[Le]),He){var _e=!1;He!==_&&(H.bindFramebuffer(36160,He),_e=!0);try{var st=E.texture,tt=st.format,lt=st.type;if(tt!==Dt&&J.convert(tt)!==H.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(lt!==ji&&J.convert(lt)!==H.getParameter(35738)&&!(lt===Sr&&(Ne.isWebGL2||ue.get("OES_texture_float")||ue.get("WEBGL_color_buffer_float")))&&!(lt===Vn&&(Ne.isWebGL2?ue.get("EXT_color_buffer_float"):ue.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}H.checkFramebufferStatus(36160)===36053?V>=0&&V<=E.width-q&&G>=0&&G<=E.height-$&&H.readPixels(V,G,q,$,J.convert(tt),J.convert(lt),Oe):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{_e&&H.bindFramebuffer(36160,_)}}},this.copyFramebufferToTexture=function(E,V,G){G===void 0&&(G=0);var q=Math.pow(2,-G),$=Math.floor(V.image.width*q),Oe=Math.floor(V.image.height*q),Le=J.convert(V.format);qe.setTexture2D(V,0),H.copyTexImage2D(3553,G,Le,E.x,E.y,$,Oe,0),xe.unbindTexture()},this.copyTextureToTexture=function(E,V,G,q){q===void 0&&(q=0);var $=V.image.width,Oe=V.image.height,Le=J.convert(G.format),He=J.convert(G.type);qe.setTexture2D(G,0),H.pixelStorei(37440,G.flipY),H.pixelStorei(37441,G.premultiplyAlpha),H.pixelStorei(3317,G.unpackAlignment),V.isDataTexture?H.texSubImage2D(3553,q,E.x,E.y,$,Oe,Le,He,V.image.data):V.isCompressedTexture?H.compressedTexSubImage2D(3553,q,E.x,E.y,V.mipmaps[0].width,V.mipmaps[0].height,Le,V.mipmaps[0].data):H.texSubImage2D(3553,q,E.x,E.y,Le,He,V.image),q===0&&G.generateMipmaps&&H.generateMipmap(3553),xe.unbindTexture()},this.initTexture=function(E){qe.setTexture2D(E,0),xe.unbindTexture()},this.resetState=function(){xe.reset(),oe.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function fl(e){ma.call(this,e)}fl.prototype=Object.assign(Object.create(ma.prototype),{constructor:fl,isWebGL1Renderer:!0});var Gh=function(){function e(t,r){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new ie(t),this.density=r!==void 0?r:25e-5}var i=e.prototype;return i.clone=function(){return new e(this.color,this.density)},i.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},e}(),Hh=function(){function e(t,r,n){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new ie(t),this.near=r!==void 0?r:1,this.far=n!==void 0?n:1e3}var i=e.prototype;return i.clone=function(){return new e(this.color,this.near,this.far)},i.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},e}(),ml=function(e){le(i,e);function i(){var r;return r=e.call(this)||this,Object.defineProperty(Yi(r),"isScene",{value:!0}),r.type="Scene",r.background=null,r.environment=null,r.fog=null,r.overrideMaterial=null,r.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:Yi(r)})),r}var t=i.prototype;return t.copy=function(r,n){return e.prototype.copy.call(this,r,n),r.background!==null&&(this.background=r.background.clone()),r.environment!==null&&(this.environment=r.environment.clone()),r.fog!==null&&(this.fog=r.fog.clone()),r.overrideMaterial!==null&&(this.overrideMaterial=r.overrideMaterial.clone()),this.autoUpdate=r.autoUpdate,this.matrixAutoUpdate=r.matrixAutoUpdate,this},t.toJSON=function(r){var n=e.prototype.toJSON.call(this,r);return this.background!==null&&(n.object.background=this.background.toJSON(r)),this.environment!==null&&(n.object.environment=this.environment.toJSON(r)),this.fog!==null&&(n.object.fog=this.fog.toJSON()),n},i}(se);function Gt(e,i){this.array=e,this.stride=i,this.count=e!==void 0?e.length/i:0,this.usage=Yn,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=be.generateUUID()}Object.defineProperty(Gt.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(Gt.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,i,t){e*=this.stride,t*=i.stride;for(var r=0,n=this.stride;r<n;r++)this.array[e+r]=i.array[t+r];return this},set:function(e,i){return i===void 0&&(i=0),this.array.set(e,i),this},clone:function(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=be.generateUUID()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var i=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),t=new Gt(i,this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=be.generateUUID()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var Si=new T;function $r(e,i,t,r){this.name="",this.data=e,this.itemSize=i,this.offset=t,this.normalized=r===!0}Object.defineProperties($r.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign($r.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var i=0,t=this.data.count;i<t;i++)Si.x=this.getX(i),Si.y=this.getY(i),Si.z=this.getZ(i),Si.applyMatrix4(e),this.setXYZ(i,Si.x,Si.y,Si.z);return this},setX:function(e,i){return this.data.array[e*this.data.stride+this.offset]=i,this},setY:function(e,i){return this.data.array[e*this.data.stride+this.offset+1]=i,this},setZ:function(e,i){return this.data.array[e*this.data.stride+this.offset+2]=i,this},setW:function(e,i){return this.data.array[e*this.data.stride+this.offset+3]=i,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,i,t){return e=e*this.data.stride+this.offset,this.data.array[e+0]=i,this.data.array[e+1]=t,this},setXYZ:function(e,i,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=i,this.data.array[e+1]=t,this.data.array[e+2]=r,this},setXYZW:function(e,i,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=i,this.data.array[e+1]=t,this.data.array[e+2]=r,this.data.array[e+3]=n,this},clone:function(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var i=[],t=0;t<this.count;t++)for(var r=t*this.data.stride+this.offset,n=0;n<this.itemSize;n++)i.push(this.data.array[r+n]);return new fe(new this.array.constructor(i),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new $r(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var i=[],t=0;t<this.count;t++)for(var r=t*this.data.stride+this.offset,n=0;n<this.itemSize;n++)i.push(this.data.array[r+n]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function ei(e){ye.call(this),this.type="SpriteMaterial",this.color=new ie(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}ei.prototype=Object.create(ye.prototype),ei.prototype.constructor=ei,ei.prototype.isSpriteMaterial=!0,ei.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var vn,va=new T,gn=new T,yn=new T,xn=new X,ga=new X,kh=new Te,xo=new T,ya=new T,bo=new T,Vh=new X,vl=new X,Wh=new X;function xa(e){if(se.call(this),this.type="Sprite",vn===void 0){vn=new pe;var i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new Gt(i,5);vn.setIndex([0,1,2,0,2,3]),vn.setAttribute("position",new $r(t,3,0,!1)),vn.setAttribute("uv",new $r(t,2,3,!1))}this.geometry=vn,this.material=e!==void 0?e:new ei,this.center=new X(.5,.5)}xa.prototype=Object.assign(Object.create(se.prototype),{constructor:xa,isSprite:!0,raycast:function(e,i){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),gn.setFromMatrixScale(this.matrixWorld),kh.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),yn.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&gn.multiplyScalar(-yn.z);var t=this.material.rotation,r,n;t!==0&&(n=Math.cos(t),r=Math.sin(t));var a=this.center;_o(xo.set(-.5,-.5,0),yn,a,gn,r,n),_o(ya.set(.5,-.5,0),yn,a,gn,r,n),_o(bo.set(.5,.5,0),yn,a,gn,r,n),Vh.set(0,0),vl.set(1,0),Wh.set(1,1);var o=e.ray.intersectTriangle(xo,ya,bo,!1,va);if(!(o===null&&(_o(ya.set(-.5,.5,0),yn,a,gn,r,n),vl.set(0,1),o=e.ray.intersectTriangle(xo,bo,ya,!1,va),o===null))){var s=e.ray.origin.distanceTo(va);s<e.near||s>e.far||i.push({distance:s,point:va.clone(),uv:$t.getUV(va,xo,ya,bo,Vh,vl,Wh,new X),face:null,object:this})}},copy:function(e){return se.prototype.copy.call(this,e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}});function _o(e,i,t,r,n,a){xn.subVectors(e,t).addScalar(.5).multiply(r),n!==void 0?(ga.x=a*xn.x-n*xn.y,ga.y=n*xn.x+a*xn.y):ga.copy(xn),e.copy(i),e.x+=ga.x,e.y+=ga.y,e.applyMatrix4(kh)}var wo=new T,jh=new T;function ba(){se.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}ba.prototype=Object.assign(Object.create(se.prototype),{constructor:ba,isLOD:!0,copy:function(e){se.prototype.copy.call(this,e,!1);for(var i=e.levels,t=0,r=i.length;t<r;t++){var n=i[t];this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,i){i===void 0&&(i=0),i=Math.abs(i);var t=this.levels,r;for(r=0;r<t.length&&!(i<t[r].distance);r++);return t.splice(r,0,{distance:i,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var i=this.levels;if(i.length>0){var t,r;for(t=1,r=i.length;t<r&&!(e<i[t].distance);t++);return i[t-1].object}return null},raycast:function(e,i){var t=this.levels;if(t.length>0){wo.setFromMatrixPosition(this.matrixWorld);var r=e.ray.origin.distanceTo(wo);this.getObjectForDistance(r).raycast(e,i)}},update:function(e){var i=this.levels;if(i.length>1){wo.setFromMatrixPosition(e.matrixWorld),jh.setFromMatrixPosition(this.matrixWorld);var t=wo.distanceTo(jh)/e.zoom;i[0].object.visible=!0;var r,n;for(r=1,n=i.length;r<n&&t>=i[r].distance;r++)i[r-1].object.visible=!1,i[r].object.visible=!0;for(this._currentLevel=r-1;r<n;r++)i[r].object.visible=!1}},toJSON:function(e){var i=se.prototype.toJSON.call(this,e);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];for(var t=this.levels,r=0,n=t.length;r<n;r++){var a=t[r];i.object.levels.push({object:a.object.uuid,distance:a.distance})}return i}});var qh=new T,Xh=new We,Yh=new We,d0=new T,Zh=new Te;function _a(e,i){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Je.call(this,e,i),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Te,this.bindMatrixInverse=new Te}_a.prototype=Object.assign(Object.create(Je.prototype),{constructor:_a,isSkinnedMesh:!0,copy:function(e){return Je.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,i){this.skeleton=e,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new We,i=this.geometry.attributes.skinWeight,t=0,r=i.count;t<r;t++){e.x=i.getX(t),e.y=i.getY(t),e.z=i.getZ(t),e.w=i.getW(t);var n=1/e.manhattanLength();n!==Infinity?e.multiplyScalar(n):e.set(1,0,0,0),i.setXYZW(t,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Je.prototype.updateMatrixWorld.call(this,e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(e,i){var t=this.skeleton,r=this.geometry;Xh.fromBufferAttribute(r.attributes.skinIndex,e),Yh.fromBufferAttribute(r.attributes.skinWeight,e),qh.fromBufferAttribute(r.attributes.position,e).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(var n=0;n<4;n++){var a=Yh.getComponent(n);if(a!==0){var o=Xh.getComponent(n);Zh.multiplyMatrices(t.bones[o].matrixWorld,t.boneInverses[o]),i.addScaledVector(d0.copy(qh).applyMatrix4(Zh),a)}}return i.applyMatrix4(this.bindMatrixInverse)}});function wa(){se.call(this),this.type="Bone"}wa.prototype=Object.assign(Object.create(se.prototype),{constructor:wa,isBone:!0});var Jh=new Te,p0=new Te;function Ma(e,i){e===void 0&&(e=[]),i===void 0&&(i=[]),this.uuid=be.generateUUID(),this.bones=e.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}Object.assign(Ma.prototype,{init:function(){var e=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),i.length===0)this.calculateInverses();else if(e.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var t=0,r=this.bones.length;t<r;t++)this.boneInverses.push(new Te)}},calculateInverses:function(){this.boneInverses.length=0;for(var e=0,i=this.bones.length;e<i;e++){var t=new Te;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}},pose:function(){for(var e=0,i=this.bones.length;e<i;e++){var t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,n=this.bones.length;r<n;r++){var a=this.bones[r];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}},update:function(){for(var e=this.bones,i=this.boneInverses,t=this.boneMatrices,r=this.boneTexture,n=0,a=e.length;n<a;n++){var o=e[n]?e[n].matrixWorld:p0;Jh.multiplyMatrices(o,i[n]),Jh.toArray(t,n*16)}r!==null&&(r.needsUpdate=!0)},clone:function(){return new Ma(this.bones,this.boneInverses)},getBoneByName:function(e){for(var i=0,t=this.bones.length;i<t;i++){var r=this.bones[i];if(r.name===e)return r}},dispose:function(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(e,i){this.uuid=e.uuid;for(var t=0,r=e.bones.length;t<r;t++){var n=e.bones[t],a=i[n];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),a=new wa),this.bones.push(a),this.boneInverses.push(new Te().fromArray(e.boneInverses[t]))}return this.init(),this},toJSON:function(){var e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;for(var i=this.bones,t=this.boneInverses,r=0,n=i.length;r<n;r++){var a=i[r];e.bones.push(a.uuid);var o=t[r];e.boneInverses.push(o.toArray())}return e}});var Kh=new Te,Qh=new Te,Mo=[],Sa=new Je;function So(e,i,t){Je.call(this,e,i),this.instanceMatrix=new fe(new Float32Array(t*16),16),this.instanceColor=null,this.count=t,this.frustumCulled=!1}So.prototype=Object.assign(Object.create(Je.prototype),{constructor:So,isInstancedMesh:!0,copy:function(e){return Je.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),this.count=e.count,this},getColorAt:function(e,i){i.fromArray(this.instanceColor.array,e*3)},getMatrixAt:function(e,i){i.fromArray(this.instanceMatrix.array,e*16)},raycast:function(e,i){var t=this.matrixWorld,r=this.count;if(Sa.geometry=this.geometry,Sa.material=this.material,Sa.material!==void 0)for(var n=0;n<r;n++){this.getMatrixAt(n,Kh),Qh.multiplyMatrices(t,Kh),Sa.matrixWorld=Qh,Sa.raycast(e,Mo);for(var a=0,o=Mo.length;a<o;a++){var s=Mo[a];s.instanceId=n,s.object=this,i.push(s)}Mo.length=0}},setColorAt:function(e,i){this.instanceColor===null&&(this.instanceColor=new fe(new Float32Array(this.count*3),3)),i.toArray(this.instanceColor.array,e*3)},setMatrixAt:function(e,i){i.toArray(this.instanceMatrix.array,e*16)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});function et(e){ye.call(this),this.type="LineBasicMaterial",this.color=new ie(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}et.prototype=Object.create(ye.prototype),et.prototype.constructor=et,et.prototype.isLineBasicMaterial=!0,et.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};var $h=new T,ed=new T,td=new Te,To=new $i,Eo=new Er;function Yt(e,i){e===void 0&&(e=new pe),i===void 0&&(i=new et),se.call(this),this.type="Line",this.geometry=e,this.material=i,this.updateMorphTargets()}Yt.prototype=Object.assign(Object.create(se.prototype),{constructor:Yt,isLine:!0,copy:function(e){return se.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var i=e.attributes.position,t=[0],r=1,n=i.count;r<n;r++)$h.fromBufferAttribute(i,r-1),ed.fromBufferAttribute(i,r),t[r]=t[r-1],t[r]+=$h.distanceTo(ed);e.setAttribute("lineDistance",new te(t,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices,o=e.lineDistances;o[0]=0;for(var s=1,l=a.length;s<l;s++)o[s]=o[s-1],o[s]+=a[s-1].distanceTo(a[s])}return this},raycast:function(e,i){var t=this.geometry,r=this.matrixWorld,n=e.params.Line.threshold;if(t.boundingSphere===null&&t.computeBoundingSphere(),Eo.copy(t.boundingSphere),Eo.applyMatrix4(r),Eo.radius+=n,e.ray.intersectsSphere(Eo)!==!1){td.copy(r).invert(),To.copy(e.ray).applyMatrix4(td);var a=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,s=new T,l=new T,c=new T,h=new T,u=this.isLineSegments?2:1;if(t.isBufferGeometry){var p=t.index,d=t.attributes,m=d.position;if(p!==null)for(var g=p.array,b=0,v=g.length-1;b<v;b+=u){var f=g[b],M=g[b+1];s.fromBufferAttribute(m,f),l.fromBufferAttribute(m,M);var _=To.distanceSqToSegment(s,l,h,c);if(!(_>o)){h.applyMatrix4(this.matrixWorld);var w=e.ray.origin.distanceTo(h);w<e.near||w>e.far||i.push({distance:w,point:c.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}else for(var x=0,S=m.count-1;x<S;x+=u){s.fromBufferAttribute(m,x),l.fromBufferAttribute(m,x+1);var A=To.distanceSqToSegment(s,l,h,c);if(!(A>o)){h.applyMatrix4(this.matrixWorld);var I=e.ray.origin.distanceTo(h);I<e.near||I>e.far||i.push({distance:I,point:c.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}else if(t.isGeometry)for(var P=t.vertices,R=P.length,N=0;N<R-1;N+=u){var D=To.distanceSqToSegment(P[N],P[N+1],h,c);if(!(D>o)){h.applyMatrix4(this.matrixWorld);var B=e.ray.origin.distanceTo(h);B<e.near||B>e.far||i.push({distance:B,point:c.clone().applyMatrix4(this.matrixWorld),index:N,face:null,faceIndex:null,object:this})}}}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var i=e.morphAttributes,t=Object.keys(i);if(t.length>0){var r=i[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var n=0,a=r.length;n<a;n++){var o=r[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}else{var s=e.morphTargets;s!==void 0&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var Ao=new T,Lo=new T;function Ct(e,i){Yt.call(this,e,i),this.type="LineSegments"}Ct.prototype=Object.assign(Object.create(Yt.prototype),{constructor:Ct,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var i=e.attributes.position,t=[],r=0,n=i.count;r<n;r+=2)Ao.fromBufferAttribute(i,r),Lo.fromBufferAttribute(i,r+1),t[r]=r===0?0:t[r-1],t[r+1]=t[r]+Ao.distanceTo(Lo);e.setAttribute("lineDistance",new te(t,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(var a=e.vertices,o=e.lineDistances,s=0,l=a.length;s<l;s+=2)Ao.copy(a[s]),Lo.copy(a[s+1]),o[s]=s===0?0:o[s-1],o[s+1]=o[s]+Ao.distanceTo(Lo);return this}});function Ro(e,i){Yt.call(this,e,i),this.type="LineLoop"}Ro.prototype=Object.assign(Object.create(Yt.prototype),{constructor:Ro,isLineLoop:!0});function rr(e){ye.call(this),this.type="PointsMaterial",this.color=new ie(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}rr.prototype=Object.create(ye.prototype),rr.prototype.constructor=rr,rr.prototype.isPointsMaterial=!0,rr.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var rd=new Te,gl=new $i,Po=new Er,Co=new T;function bn(e,i){e===void 0&&(e=new pe),i===void 0&&(i=new rr),se.call(this),this.type="Points",this.geometry=e,this.material=i,this.updateMorphTargets()}bn.prototype=Object.assign(Object.create(se.prototype),{constructor:bn,isPoints:!0,copy:function(e){return se.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,i){var t=this.geometry,r=this.matrixWorld,n=e.params.Points.threshold;if(t.boundingSphere===null&&t.computeBoundingSphere(),Po.copy(t.boundingSphere),Po.applyMatrix4(r),Po.radius+=n,e.ray.intersectsSphere(Po)!==!1){rd.copy(r).invert(),gl.copy(e.ray).applyMatrix4(rd);var a=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(t.isBufferGeometry){var s=t.index,l=t.attributes,c=l.position;if(s!==null)for(var h=s.array,u=0,p=h.length;u<p;u++){var d=h[u];Co.fromBufferAttribute(c,d),yl(Co,d,o,r,e,i,this)}else for(var m=0,g=c.count;m<g;m++)Co.fromBufferAttribute(c,m),yl(Co,m,o,r,e,i,this)}else for(var b=t.vertices,v=0,f=b.length;v<f;v++)yl(b[v],v,o,r,e,i,this)}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var i=e.morphAttributes,t=Object.keys(i);if(t.length>0){var r=i[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var n=0,a=r.length;n<a;n++){var o=r[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}else{var s=e.morphTargets;s!==void 0&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function yl(e,i,t,r,n,a,o){var s=gl.distanceSqToPoint(e);if(s<t){var l=new T;gl.closestPointToPoint(e,l),l.applyMatrix4(r);var c=n.ray.origin.distanceTo(l);if(c<n.near||c>n.far)return;a.push({distance:c,distanceToRay:Math.sqrt(s),point:l,index:i,face:null,object:o})}}function xl(e,i,t,r,n,a,o,s,l){Ve.call(this,e,i,t,r,n,a,o,s,l),this.format=o!==void 0?o:Hr,this.minFilter=a!==void 0?a:mt,this.magFilter=n!==void 0?n:mt,this.generateMipmaps=!1;var c=this;function h(){c.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}xl.prototype=Object.assign(Object.create(Ve.prototype),{constructor:xl,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){var e=this.image,i="requestVideoFrameCallback"in e;i===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function _n(e,i,t,r,n,a,o,s,l,c,h,u){Ve.call(this,null,a,o,s,l,c,r,n,h,u),this.image={width:i,height:t},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}_n.prototype=Object.create(Ve.prototype),_n.prototype.constructor=_n,_n.prototype.isCompressedTexture=!0;function Ta(e,i,t,r,n,a,o,s,l){Ve.call(this,e,i,t,r,n,a,o,s,l),this.needsUpdate=!0}Ta.prototype=Object.create(Ve.prototype),Ta.prototype.constructor=Ta,Ta.prototype.isCanvasTexture=!0;function Ea(e,i,t,r,n,a,o,s,l,c){if(c=c!==void 0?c:di,c!==di&&c!==Xi)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");t===void 0&&c===di&&(t=Hn),t===void 0&&c===Xi&&(t=qi),Ve.call(this,null,r,n,a,o,s,c,t,l),this.image={width:e,height:i},this.magFilter=o!==void 0?o:dt,this.minFilter=s!==void 0?s:dt,this.flipY=!1,this.generateMipmaps=!1}Ea.prototype=Object.create(Ve.prototype),Ea.prototype.constructor=Ea,Ea.prototype.isDepthTexture=!0;var f0=0,vr=new Te,bl=new se,No=new T;function je(){Object.defineProperty(this,"id",{value:f0+=2}),this.uuid=be.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}je.prototype=Object.assign(Object.create(ur.prototype),{constructor:je,isGeometry:!0,applyMatrix4:function(e){for(var i=new Rt().getNormalMatrix(e),t=0,r=this.vertices.length;t<r;t++){var n=this.vertices[t];n.applyMatrix4(e)}for(var a=0,o=this.faces.length;a<o;a++){var s=this.faces[a];s.normal.applyMatrix3(i).normalize();for(var l=0,c=s.vertexNormals.length;l<c;l++)s.vertexNormals[l].applyMatrix3(i).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return vr.makeRotationX(e),this.applyMatrix4(vr),this},rotateY:function(e){return vr.makeRotationY(e),this.applyMatrix4(vr),this},rotateZ:function(e){return vr.makeRotationZ(e),this.applyMatrix4(vr),this},translate:function(e,i,t){return vr.makeTranslation(e,i,t),this.applyMatrix4(vr),this},scale:function(e,i,t){return vr.makeScale(e,i,t),this.applyMatrix4(vr),this},lookAt:function(e){return bl.lookAt(e),bl.updateMatrix(),this.applyMatrix4(bl.matrix),this},fromBufferGeometry:function(e){var i=this,t=e.index!==null?e.index:void 0,r=e.attributes;if(r.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var n=r.position,a=r.normal,o=r.color,s=r.uv,l=r.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(var c=0;c<n.count;c++)i.vertices.push(new T().fromBufferAttribute(n,c)),o!==void 0&&i.colors.push(new ie().fromBufferAttribute(o,c));function h(_,w,x,S){var A=o===void 0?[]:[i.colors[_].clone(),i.colors[w].clone(),i.colors[x].clone()],I=a===void 0?[]:[new T().fromBufferAttribute(a,_),new T().fromBufferAttribute(a,w),new T().fromBufferAttribute(a,x)],P=new $n(_,w,x,I,A,S);i.faces.push(P),s!==void 0&&i.faceVertexUvs[0].push([new X().fromBufferAttribute(s,_),new X().fromBufferAttribute(s,w),new X().fromBufferAttribute(s,x)]),l!==void 0&&i.faceVertexUvs[1].push([new X().fromBufferAttribute(l,_),new X().fromBufferAttribute(l,w),new X().fromBufferAttribute(l,x)])}var u=e.groups;if(u.length>0)for(var p=0;p<u.length;p++)for(var d=u[p],m=d.start,g=d.count,b=m,v=m+g;b<v;b+=3)t!==void 0?h(t.getX(b),t.getX(b+1),t.getX(b+2),d.materialIndex):h(b,b+1,b+2,d.materialIndex);else if(t!==void 0)for(var f=0;f<t.count;f+=3)h(t.getX(f),t.getX(f+1),t.getX(f+2));else for(var M=0;M<n.count;M+=3)h(M,M+1,M+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(No).negate(),this.translate(No.x,No.y,No.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,i=this.boundingSphere.radius,t=i===0?1:1/i,r=new Te;return r.set(t,0,0,-t*e.x,0,t,0,-t*e.y,0,0,t,-t*e.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){for(var e=new T,i=new T,t=0,r=this.faces.length;t<r;t++){var n=this.faces[t],a=this.vertices[n.a],o=this.vertices[n.b],s=this.vertices[n.c];e.subVectors(s,o),i.subVectors(a,o),e.cross(i),e.normalize(),n.normal.copy(e)}},computeVertexNormals:function(e){e===void 0&&(e=!0);for(var i=new Array(this.vertices.length),t=0,r=this.vertices.length;t<r;t++)i[t]=new T;if(e)for(var n=new T,a=new T,o=0,s=this.faces.length;o<s;o++){var l=this.faces[o],c=this.vertices[l.a],h=this.vertices[l.b],u=this.vertices[l.c];n.subVectors(u,h),a.subVectors(c,h),n.cross(a),i[l.a].add(n),i[l.b].add(n),i[l.c].add(n)}else{this.computeFaceNormals();for(var p=0,d=this.faces.length;p<d;p++){var m=this.faces[p];i[m.a].add(m.normal),i[m.b].add(m.normal),i[m.c].add(m.normal)}}for(var g=0,b=this.vertices.length;g<b;g++)i[g].normalize();for(var v=0,f=this.faces.length;v<f;v++){var M=this.faces[v],_=M.vertexNormals;_.length===3?(_[0].copy(i[M.a]),_[1].copy(i[M.b]),_[2].copy(i[M.c])):(_[0]=i[M.a].clone(),_[1]=i[M.b].clone(),_[2]=i[M.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(var e=0,i=this.faces.length;e<i;e++){var t=this.faces[e],r=t.vertexNormals;r.length===3?(r[0].copy(t.normal),r[1].copy(t.normal),r[2].copy(t.normal)):(r[0]=t.normal.clone(),r[1]=t.normal.clone(),r[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(var e=0,i=this.faces.length;e<i;e++){var t=this.faces[e];t.__originalFaceNormal?t.__originalFaceNormal.copy(t.normal):t.__originalFaceNormal=t.normal.clone(),t.__originalVertexNormals||(t.__originalVertexNormals=[]);for(var r=0,n=t.vertexNormals.length;r<n;r++)t.__originalVertexNormals[r]?t.__originalVertexNormals[r].copy(t.vertexNormals[r]):t.__originalVertexNormals[r]=t.vertexNormals[r].clone()}var a=new je;a.faces=this.faces;for(var o=0,s=this.morphTargets.length;o<s;o++){if(!this.morphNormals[o]){this.morphNormals[o]={},this.morphNormals[o].faceNormals=[],this.morphNormals[o].vertexNormals=[];for(var l=this.morphNormals[o].faceNormals,c=this.morphNormals[o].vertexNormals,h=0,u=this.faces.length;h<u;h++){var p=new T,d={a:new T,b:new T,c:new T};l.push(p),c.push(d)}}var m=this.morphNormals[o];a.vertices=this.morphTargets[o].vertices,a.computeFaceNormals(),a.computeVertexNormals();for(var g=0,b=this.faces.length;g<b;g++){var v=this.faces[g],f=m.faceNormals[g],M=m.vertexNormals[g];f.copy(v.normal),M.a.copy(v.vertexNormals[0]),M.b.copy(v.vertexNormals[1]),M.c.copy(v.vertexNormals[2])}}for(var _=0,w=this.faces.length;_<w;_++){var x=this.faces[_];x.normal=x.__originalFaceNormal,x.vertexNormals=x.__originalVertexNormals}},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new hr),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Er),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,i,t){if(t===void 0&&(t=0),!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}var r,n=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,l=e.faces,c=this.colors,h=e.colors;i!==void 0&&(r=new Rt().getNormalMatrix(i));for(var u=0,p=o.length;u<p;u++){var d=o[u],m=d.clone();i!==void 0&&m.applyMatrix4(i),a.push(m)}for(var g=0,b=h.length;g<b;g++)c.push(h[g].clone());for(var v=0,f=l.length;v<f;v++){var M=l[v],_=void 0,w=void 0,x=M.vertexNormals,S=M.vertexColors,A=new $n(M.a+n,M.b+n,M.c+n);A.normal.copy(M.normal),r!==void 0&&A.normal.applyMatrix3(r).normalize();for(var I=0,P=x.length;I<P;I++)_=x[I].clone(),r!==void 0&&_.applyMatrix3(r).normalize(),A.vertexNormals.push(_);A.color.copy(M.color);for(var R=0,N=S.length;R<N;R++)w=S[R],A.vertexColors.push(w.clone());A.materialIndex=M.materialIndex+t,s.push(A)}for(var D=0,B=e.faceVertexUvs.length;D<B;D++){var O=e.faceVertexUvs[D];this.faceVertexUvs[D]===void 0&&(this.faceVertexUvs[D]=[]);for(var U=0,F=O.length;U<F;U++){for(var k=O[U],W=[],Y=0,j=k.length;Y<j;Y++)W.push(k[Y].clone());this.faceVertexUvs[D].push(W)}}},mergeMesh:function(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)},mergeVertices:function(e){e===void 0&&(e=4);for(var i={},t=[],r=[],n=Math.pow(10,e),a=0,o=this.vertices.length;a<o;a++){var s=this.vertices[a],l=Math.round(s.x*n)+"_"+Math.round(s.y*n)+"_"+Math.round(s.z*n);i[l]===void 0?(i[l]=a,t.push(this.vertices[a]),r[a]=t.length-1):r[a]=r[i[l]]}for(var c=[],h=0,u=this.faces.length;h<u;h++){var p=this.faces[h];p.a=r[p.a],p.b=r[p.b],p.c=r[p.c];for(var d=[p.a,p.b,p.c],m=0;m<3;m++)if(d[m]===d[(m+1)%3]){c.push(h);break}}for(var g=c.length-1;g>=0;g--){var b=c[g];this.faces.splice(b,1);for(var v=0,f=this.faceVertexUvs.length;v<f;v++)this.faceVertexUvs[v].splice(b,1)}var M=this.vertices.length-t.length;return this.vertices=t,M},setFromPoints:function(e){this.vertices=[];for(var i=0,t=e.length;i<t;i++){var r=e[i];this.vertices.push(new T(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,i=e.length,t=0;t<i;t++)e[t]._id=t;function r(h,u){return h.materialIndex-u.materialIndex}e.sort(r);var n=this.faceVertexUvs[0],a=this.faceVertexUvs[1],o,s;n&&n.length===i&&(o=[]),a&&a.length===i&&(s=[]);for(var l=0;l<i;l++){var c=e[l]._id;o&&o.push(n[c]),s&&s.push(a[c])}o&&(this.faceVertexUvs[0]=o),s&&(this.faceVertexUvs[1]=s)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){var i=this.parameters;for(var t in i)i[t]!==void 0&&(e[t]=i[t]);return e}for(var r=[],n=0;n<this.vertices.length;n++){var a=this.vertices[n];r.push(a.x,a.y,a.z)}for(var o=[],s=[],l={},c=[],h={},u=[],p={},d=0;d<this.faces.length;d++){var m=this.faces[d],g=!0,b=!1,v=this.faceVertexUvs[0][d]!==void 0,f=m.normal.length()>0,M=m.vertexNormals.length>0,_=m.color.r!==1||m.color.g!==1||m.color.b!==1,w=m.vertexColors.length>0,x=0;if(x=P(x,0,0),x=P(x,1,g),x=P(x,2,b),x=P(x,3,v),x=P(x,4,f),x=P(x,5,M),x=P(x,6,_),x=P(x,7,w),o.push(x),o.push(m.a,m.b,m.c),o.push(m.materialIndex),v){var S=this.faceVertexUvs[0][d];o.push(D(S[0]),D(S[1]),D(S[2]))}if(f&&o.push(R(m.normal)),M){var A=m.vertexNormals;o.push(R(A[0]),R(A[1]),R(A[2]))}if(_&&o.push(N(m.color)),w){var I=m.vertexColors;o.push(N(I[0]),N(I[1]),N(I[2]))}}function P(B,O,U){return U?B|1<<O:B&~(1<<O)}function R(B){var O=B.x.toString()+B.y.toString()+B.z.toString();return l[O]!==void 0||(l[O]=s.length/3,s.push(B.x,B.y,B.z)),l[O]}function N(B){var O=B.r.toString()+B.g.toString()+B.b.toString();return h[O]!==void 0||(h[O]=c.length,c.push(B.getHex())),h[O]}function D(B){var O=B.x.toString()+B.y.toString();return p[O]!==void 0||(p[O]=u.length/2,u.push(B.x,B.y)),p[O]}return e.data={},e.data.vertices=r,e.data.normals=s,c.length>0&&(e.data.colors=c),u.length>0&&(e.data.uvs=[u]),e.data.faces=o,e},clone:function(){return new je().copy(this)},copy:function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;for(var i=e.vertices,t=0,r=i.length;t<r;t++)this.vertices.push(i[t].clone());for(var n=e.colors,a=0,o=n.length;a<o;a++)this.colors.push(n[a].clone());for(var s=e.faces,l=0,c=s.length;l<c;l++)this.faces.push(s[l].clone());for(var h=0,u=e.faceVertexUvs.length;h<u;h++){var p=e.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(var d=0,m=p.length;d<m;d++){for(var g=p[d],b=[],v=0,f=g.length;v<f;v++){var M=g[v];b.push(M.clone())}this.faceVertexUvs[h].push(b)}}for(var _=e.morphTargets,w=0,x=_.length;w<x;w++){var S={};if(S.name=_[w].name,_[w].vertices!==void 0){S.vertices=[];for(var A=0,I=_[w].vertices.length;A<I;A++)S.vertices.push(_[w].vertices[A].clone())}if(_[w].normals!==void 0){S.normals=[];for(var P=0,R=_[w].normals.length;P<R;P++)S.normals.push(_[w].normals[P].clone())}this.morphTargets.push(S)}for(var N=e.morphNormals,D=0,B=N.length;D<B;D++){var O={};if(N[D].vertexNormals!==void 0){O.vertexNormals=[];for(var U=0,F=N[D].vertexNormals.length;U<F;U++){var k=N[D].vertexNormals[U],W={};W.a=k.a.clone(),W.b=k.b.clone(),W.c=k.c.clone(),O.vertexNormals.push(W)}}if(N[D].faceNormals!==void 0){O.faceNormals=[];for(var Y=0,j=N[D].faceNormals.length;Y<j;Y++)O.faceNormals.push(N[D].faceNormals[Y].clone())}this.morphNormals.push(O)}for(var Z=e.skinWeights,ae=0,me=Z.length;ae<me;ae++)this.skinWeights.push(Z[ae].clone());for(var H=e.skinIndices,Ee=0,ce=H.length;Ee<ce;Ee++)this.skinIndices.push(H[Ee].clone());for(var Ce=e.lineDistances,ue=0,Ne=Ce.length;ue<Ne;ue++)this.lineDistances.push(Ce[ue]);var xe=e.boundingBox;xe!==null&&(this.boundingBox=xe.clone());var Fe=e.boundingSphere;return Fe!==null&&(this.boundingSphere=Fe.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var _l=function(e){le(i,e);function i(t,r,n,a,o,s){var l;return l=e.call(this)||this,l.type="BoxGeometry",l.parameters={width:t,height:r,depth:n,widthSegments:a,heightSegments:o,depthSegments:s},l.fromBufferGeometry(new ua(t,r,n,a,o,s)),l.mergeVertices(),l}return i}(je),wl=function(e){le(i,e);function i(t,r,n,a){var o;t===void 0&&(t=1),r===void 0&&(r=8),n===void 0&&(n=0),a===void 0&&(a=Math.PI*2),o=e.call(this)||this,o.type="CircleBufferGeometry",o.parameters={radius:t,segments:r,thetaStart:n,thetaLength:a},r=Math.max(3,r);var s=[],l=[],c=[],h=[],u=new T,p=new X;l.push(0,0,0),c.push(0,0,1),h.push(.5,.5);for(var d=0,m=3;d<=r;d++,m+=3){var g=n+d/r*a;u.x=t*Math.cos(g),u.y=t*Math.sin(g),l.push(u.x,u.y,u.z),c.push(0,0,1),p.x=(l[m]/t+1)/2,p.y=(l[m+1]/t+1)/2,h.push(p.x,p.y)}for(var b=1;b<=r;b++)s.push(b,b+1,0);return o.setIndex(s),o.setAttribute("position",new te(l,3)),o.setAttribute("normal",new te(c,3)),o.setAttribute("uv",new te(h,2)),o}return i}(pe),id=function(e){le(i,e);function i(t,r,n,a){var o;return o=e.call(this)||this,o.type="CircleGeometry",o.parameters={radius:t,segments:r,thetaStart:n,thetaLength:a},o.fromBufferGeometry(new wl(t,r,n,a)),o.mergeVertices(),o}return i}(je),Aa=function(e){le(i,e);function i(t,r,n,a,o,s,l,c){var h;t===void 0&&(t=1),r===void 0&&(r=1),n===void 0&&(n=1),a===void 0&&(a=8),o===void 0&&(o=1),s===void 0&&(s=!1),l===void 0&&(l=0),c===void 0&&(c=Math.PI*2),h=e.call(this)||this,h.type="CylinderBufferGeometry",h.parameters={radiusTop:t,radiusBottom:r,height:n,radialSegments:a,heightSegments:o,openEnded:s,thetaStart:l,thetaLength:c};var u=Yi(h);a=Math.floor(a),o=Math.floor(o);var p=[],d=[],m=[],g=[],b=0,v=[],f=n/2,M=0;_(),s===!1&&(t>0&&w(!0),r>0&&w(!1)),h.setIndex(p),h.setAttribute("position",new te(d,3)),h.setAttribute("normal",new te(m,3)),h.setAttribute("uv",new te(g,2));function _(){for(var x=new T,S=new T,A=0,I=(r-t)/n,P=0;P<=o;P++){for(var R=[],N=P/o,D=N*(r-t)+t,B=0;B<=a;B++){var O=B/a,U=O*c+l,F=Math.sin(U),k=Math.cos(U);S.x=D*F,S.y=-N*n+f,S.z=D*k,d.push(S.x,S.y,S.z),x.set(F,I,k).normalize(),m.push(x.x,x.y,x.z),g.push(O,1-N),R.push(b++)}v.push(R)}for(var W=0;W<a;W++)for(var Y=0;Y<o;Y++){var j=v[Y][W],Z=v[Y+1][W],ae=v[Y+1][W+1],me=v[Y][W+1];p.push(j,Z,me),p.push(Z,ae,me),A+=6}u.addGroup(M,A,0),M+=A}function w(x){for(var S=b,A=new X,I=new T,P=0,R=x===!0?t:r,N=x===!0?1:-1,D=1;D<=a;D++)d.push(0,f*N,0),m.push(0,N,0),g.push(.5,.5),b++;for(var B=b,O=0;O<=a;O++){var U=O/a,F=U*c+l,k=Math.cos(F),W=Math.sin(F);I.x=R*W,I.y=f*N,I.z=R*k,d.push(I.x,I.y,I.z),m.push(0,N,0),A.x=k*.5+.5,A.y=W*.5*N+.5,g.push(A.x,A.y),b++}for(var Y=0;Y<a;Y++){var j=S+Y,Z=B+Y;x===!0?p.push(Z,Z+1,j):p.push(Z+1,Z,j),P+=3}u.addGroup(M,P,x===!0?1:2),M+=P}return h}return i}(pe),Ml=function(e){le(i,e);function i(t,r,n,a,o,s,l,c){var h;return h=e.call(this)||this,h.type="CylinderGeometry",h.parameters={radiusTop:t,radiusBottom:r,height:n,radialSegments:a,heightSegments:o,openEnded:s,thetaStart:l,thetaLength:c},h.fromBufferGeometry(new Aa(t,r,n,a,o,s,l,c)),h.mergeVertices(),h}return i}(je),nd=function(e){le(i,e);function i(t,r,n,a,o,s,l){var c;return c=e.call(this,0,t,r,n,a,o,s,l)||this,c.type="ConeGeometry",c.parameters={radius:t,height:r,radialSegments:n,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l},c}return i}(Ml),ad=function(e){le(i,e);function i(t,r,n,a,o,s,l){var c;return t===void 0&&(t=1),r===void 0&&(r=1),n===void 0&&(n=8),a===void 0&&(a=1),o===void 0&&(o=!1),s===void 0&&(s=0),l===void 0&&(l=Math.PI*2),c=e.call(this,0,t,r,n,a,o,s,l)||this,c.type="ConeBufferGeometry",c.parameters={radius:t,height:r,radialSegments:n,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l},c}return i}(Aa),Ti=function(e){le(i,e);function i(t,r,n,a){var o;n===void 0&&(n=1),a===void 0&&(a=0),o=e.call(this)||this,o.type="PolyhedronBufferGeometry",o.parameters={vertices:t,indices:r,radius:n,detail:a};var s=[],l=[];c(a),u(n),p(),o.setAttribute("position",new te(s,3)),o.setAttribute("normal",new te(s.slice(),3)),o.setAttribute("uv",new te(l,2)),a===0?o.computeVertexNormals():o.normalizeNormals();function c(_){for(var w=new T,x=new T,S=new T,A=0;A<r.length;A+=3)g(r[A+0],w),g(r[A+1],x),g(r[A+2],S),h(w,x,S,_)}function h(_,w,x,S){for(var A=S+1,I=[],P=0;P<=A;P++){I[P]=[];for(var R=_.clone().lerp(x,P/A),N=w.clone().lerp(x,P/A),D=A-P,B=0;B<=D;B++)B===0&&P===A?I[P][B]=R:I[P][B]=R.clone().lerp(N,B/D)}for(var O=0;O<A;O++)for(var U=0;U<2*(A-O)-1;U++){var F=Math.floor(U/2);U%2==0?(m(I[O][F+1]),m(I[O+1][F]),m(I[O][F])):(m(I[O][F+1]),m(I[O+1][F+1]),m(I[O+1][F]))}}function u(_){for(var w=new T,x=0;x<s.length;x+=3)w.x=s[x+0],w.y=s[x+1],w.z=s[x+2],w.normalize().multiplyScalar(_),s[x+0]=w.x,s[x+1]=w.y,s[x+2]=w.z}function p(){for(var _=new T,w=0;w<s.length;w+=3){_.x=s[w+0],_.y=s[w+1],_.z=s[w+2];var x=f(_)/2/Math.PI+.5,S=M(_)/Math.PI+.5;l.push(x,1-S)}b(),d()}function d(){for(var _=0;_<l.length;_+=6){var w=l[_+0],x=l[_+2],S=l[_+4],A=Math.max(w,x,S),I=Math.min(w,x,S);A>.9&&I<.1&&(w<.2&&(l[_+0]+=1),x<.2&&(l[_+2]+=1),S<.2&&(l[_+4]+=1))}}function m(_){s.push(_.x,_.y,_.z)}function g(_,w){var x=_*3;w.x=t[x+0],w.y=t[x+1],w.z=t[x+2]}function b(){for(var _=new T,w=new T,x=new T,S=new T,A=new X,I=new X,P=new X,R=0,N=0;R<s.length;R+=9,N+=6){_.set(s[R+0],s[R+1],s[R+2]),w.set(s[R+3],s[R+4],s[R+5]),x.set(s[R+6],s[R+7],s[R+8]),A.set(l[N+0],l[N+1]),I.set(l[N+2],l[N+3]),P.set(l[N+4],l[N+5]),S.copy(_).add(w).add(x).divideScalar(3);var D=f(S);v(A,N+0,_,D),v(I,N+2,w,D),v(P,N+4,x,D)}}function v(_,w,x,S){S<0&&_.x===1&&(l[w]=_.x-1),x.x===0&&x.z===0&&(l[w]=S/2/Math.PI+.5)}function f(_){return Math.atan2(_.z,-_.x)}function M(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}return o}return i}(pe),Sl=function(e){le(i,e);function i(t,r){var n;t===void 0&&(t=1),r===void 0&&(r=0);var a=(1+Math.sqrt(5))/2,o=1/a,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-a,0,-o,a,0,o,-a,0,o,a,-o,-a,0,-o,a,0,o,-a,0,o,a,0,-a,0,-o,a,0,-o,-a,0,o,a,0,o],l=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];return n=e.call(this,s,l,t,r)||this,n.type="DodecahedronBufferGeometry",n.parameters={radius:t,detail:r},n}return i}(Ti),od=function(e){le(i,e);function i(t,r){var n;return n=e.call(this)||this,n.type="DodecahedronGeometry",n.parameters={radius:t,detail:r},n.fromBufferGeometry(new Sl(t,r)),n.mergeVertices(),n}return i}(je),Oo=new T,Io=new T,Tl=new T,wn=new $t,El=function(e){le(i,e);function i(t,r){var n;n=e.call(this)||this,n.type="EdgesGeometry",n.parameters={thresholdAngle:r},r=r!==void 0?r:1,t.isGeometry&&(t=new pe().fromGeometry(t));for(var a=4,o=Math.pow(10,a),s=Math.cos(be.DEG2RAD*r),l=t.getIndex(),c=t.getAttribute("position"),h=l?l.count:c.count,u=[0,0,0],p=["a","b","c"],d=new Array(3),m={},g=[],b=0;b<h;b+=3){l?(u[0]=l.getX(b),u[1]=l.getX(b+1),u[2]=l.getX(b+2)):(u[0]=b,u[1]=b+1,u[2]=b+2);var v=wn.a,f=wn.b,M=wn.c;if(v.fromBufferAttribute(c,u[0]),f.fromBufferAttribute(c,u[1]),M.fromBufferAttribute(c,u[2]),wn.getNormal(Tl),d[0]=Math.round(v.x*o)+","+Math.round(v.y*o)+","+Math.round(v.z*o),d[1]=Math.round(f.x*o)+","+Math.round(f.y*o)+","+Math.round(f.z*o),d[2]=Math.round(M.x*o)+","+Math.round(M.y*o)+","+Math.round(M.z*o),!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(var _=0;_<3;_++){var w=(_+1)%3,x=d[_],S=d[w],A=wn[p[_]],I=wn[p[w]],P=x+"_"+S,R=S+"_"+x;R in m&&m[R]?(Tl.dot(m[R].normal)<=s&&(g.push(A.x,A.y,A.z),g.push(I.x,I.y,I.z)),m[R]=null):P in m||(m[P]={index0:u[_],index1:u[w],normal:Tl.clone()})}}for(var N in m)if(m[N]){var D=m[N],B=D.index0,O=D.index1;Oo.fromBufferAttribute(c,B),Io.fromBufferAttribute(c,O),g.push(Oo.x,Oo.y,Oo.z),g.push(Io.x,Io.y,Io.z)}return n.setAttribute("position",new te(g,3)),n}return i}(pe),m0={triangulate:function(e,i,t){t=t||2;var r=i&&i.length,n=r?i[0]*t:e.length,a=sd(e,0,n,t,!0),o=[];if(!a||a.next===a.prev)return o;var s,l,c,h,u,p,d;if(r&&(a=b0(e,i,a,t)),e.length>80*t){s=c=e[0],l=h=e[1];for(var m=t;m<n;m+=t)u=e[m],p=e[m+1],u<s&&(s=u),p<l&&(l=p),u>c&&(c=u),p>h&&(h=p);d=Math.max(c-s,h-l),d=d!==0?1/d:0}return La(a,o,t,s,l,d),o}};function sd(e,i,t,r,n){var a,o;if(n===C0(e,i,t,r)>0)for(a=i;a<t;a+=r)o=ud(a,e[a],e[a+1],o);else for(a=t-r;a>=i;a-=r)o=ud(a,e[a],e[a+1],o);return o&&Do(o,o.next)&&(Pa(o),o=o.next),o}function ti(e,i){if(!e)return e;i||(i=e);var t=e,r;do if(r=!1,!t.steiner&&(Do(t,t.next)||rt(t.prev,t,t.next)===0)){if(Pa(t),t=i=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==i);return i}function La(e,i,t,r,n,a,o){if(e){!o&&a&&T0(e,r,n,a);for(var s=e,l,c;e.prev!==e.next;){if(l=e.prev,c=e.next,a?g0(e,r,n,a):v0(e)){i.push(l.i/t),i.push(e.i/t),i.push(c.i/t),Pa(e),e=c.next,s=c.next;continue}if(e=c,e===s){o?o===1?(e=y0(ti(e),i,t),La(e,i,t,r,n,a,2)):o===2&&x0(e,i,t,r,n,a):La(ti(e),i,t,r,n,a,1);break}}}}function v0(e){var i=e.prev,t=e,r=e.next;if(rt(i,t,r)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(Mn(i.x,i.y,t.x,t.y,r.x,r.y,n.x,n.y)&&rt(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function g0(e,i,t,r){var n=e.prev,a=e,o=e.next;if(rt(n,a,o)>=0)return!1;for(var s=n.x<a.x?n.x<o.x?n.x:o.x:a.x<o.x?a.x:o.x,l=n.y<a.y?n.y<o.y?n.y:o.y:a.y<o.y?a.y:o.y,c=n.x>a.x?n.x>o.x?n.x:o.x:a.x>o.x?a.x:o.x,h=n.y>a.y?n.y>o.y?n.y:o.y:a.y>o.y?a.y:o.y,u=Al(s,l,i,t,r),p=Al(c,h,i,t,r),d=e.prevZ,m=e.nextZ;d&&d.z>=u&&m&&m.z<=p;){if(d!==e.prev&&d!==e.next&&Mn(n.x,n.y,a.x,a.y,o.x,o.y,d.x,d.y)&&rt(d.prev,d,d.next)>=0||(d=d.prevZ,m!==e.prev&&m!==e.next&&Mn(n.x,n.y,a.x,a.y,o.x,o.y,m.x,m.y)&&rt(m.prev,m,m.next)>=0))return!1;m=m.nextZ}for(;d&&d.z>=u;){if(d!==e.prev&&d!==e.next&&Mn(n.x,n.y,a.x,a.y,o.x,o.y,d.x,d.y)&&rt(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;m&&m.z<=p;){if(m!==e.prev&&m!==e.next&&Mn(n.x,n.y,a.x,a.y,o.x,o.y,m.x,m.y)&&rt(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function y0(e,i,t){var r=e;do{var n=r.prev,a=r.next.next;!Do(n,a)&&ld(n,r,r.next,a)&&Ra(n,a)&&Ra(a,n)&&(i.push(n.i/t),i.push(r.i/t),i.push(a.i/t),Pa(r),Pa(r.next),r=e=a),r=r.next}while(r!==e);return ti(r)}function x0(e,i,t,r,n,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&L0(o,s)){var l=cd(o,s);o=ti(o,o.next),l=ti(l,l.next),La(o,i,t,r,n,a),La(l,i,t,r,n,a);return}s=s.next}o=o.next}while(o!==e)}function b0(e,i,t,r){var n=[],a,o,s,l,c;for(a=0,o=i.length;a<o;a++)s=i[a]*r,l=a<o-1?i[a+1]*r:e.length,c=sd(e,s,l,r,!1),c===c.next&&(c.steiner=!0),n.push(A0(c));for(n.sort(_0),a=0;a<n.length;a++)w0(n[a],t),t=ti(t,t.next);return t}function _0(e,i){return e.x-i.x}function w0(e,i){if(i=M0(e,i),i){var t=cd(i,e);ti(i,i.next),ti(t,t.next)}}function M0(e,i){var t=i,r=e.x,n=e.y,a=-Infinity,o;do{if(n<=t.y&&n>=t.next.y&&t.next.y!==t.y){var s=t.x+(n-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(s<=r&&s>a){if(a=s,s===r){if(n===t.y)return t;if(n===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==i);if(!o)return null;if(r===a)return o;var l=o,c=o.x,h=o.y,u=Infinity,p;t=o;do r>=t.x&&t.x>=c&&r!==t.x&&Mn(n<h?r:a,n,c,h,n<h?a:r,n,t.x,t.y)&&(p=Math.abs(n-t.y)/(r-t.x),Ra(t,e)&&(p<u||p===u&&(t.x>o.x||t.x===o.x&&S0(o,t)))&&(o=t,u=p)),t=t.next;while(t!==l);return o}function S0(e,i){return rt(e.prev,e,i.prev)<0&&rt(i.next,e,e.next)<0}function T0(e,i,t,r){var n=e;do n.z===null&&(n.z=Al(n.x,n.y,i,t,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,E0(n)}function E0(e){var i,t,r,n,a,o,s,l,c=1;do{for(t=e,e=null,a=null,o=0;t;){for(o++,r=t,s=0,i=0;i<c&&(s++,r=r.nextZ,!!r);i++);for(l=c;s>0||l>0&&r;)s!==0&&(l===0||!r||t.z<=r.z)?(n=t,t=t.nextZ,s--):(n=r,r=r.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;t=r}a.nextZ=null,c*=2}while(o>1);return e}function Al(e,i,t,r,n){return e=32767*(e-t)*n,i=32767*(i-r)*n,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e|i<<1}function A0(e){var i=e,t=e;do(i.x<t.x||i.x===t.x&&i.y<t.y)&&(t=i),i=i.next;while(i!==e);return t}function Mn(e,i,t,r,n,a,o,s){return(n-o)*(i-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(t-o)*(i-s)>=0&&(t-o)*(a-s)-(n-o)*(r-s)>=0}function L0(e,i){return e.next.i!==i.i&&e.prev.i!==i.i&&!R0(e,i)&&(Ra(e,i)&&Ra(i,e)&&P0(e,i)&&(rt(e.prev,e,i.prev)||rt(e,i.prev,i))||Do(e,i)&&rt(e.prev,e,e.next)>0&&rt(i.prev,i,i.next)>0)}function rt(e,i,t){return(i.y-e.y)*(t.x-i.x)-(i.x-e.x)*(t.y-i.y)}function Do(e,i){return e.x===i.x&&e.y===i.y}function ld(e,i,t,r){var n=zo(rt(e,i,t)),a=zo(rt(e,i,r)),o=zo(rt(t,r,e)),s=zo(rt(t,r,i));return!!(n!==a&&o!==s||n===0&&Bo(e,t,i)||a===0&&Bo(e,r,i)||o===0&&Bo(t,e,r)||s===0&&Bo(t,i,r))}function Bo(e,i,t){return i.x<=Math.max(e.x,t.x)&&i.x>=Math.min(e.x,t.x)&&i.y<=Math.max(e.y,t.y)&&i.y>=Math.min(e.y,t.y)}function zo(e){return e>0?1:e<0?-1:0}function R0(e,i){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==i.i&&t.next.i!==i.i&&ld(t,t.next,e,i))return!0;t=t.next}while(t!==e);return!1}function Ra(e,i){return rt(e.prev,e,e.next)<0?rt(e,i,e.next)>=0&&rt(e,e.prev,i)>=0:rt(e,i,e.prev)<0||rt(e,e.next,i)<0}function P0(e,i){var t=e,r=!1,n=(e.x+i.x)/2,a=(e.y+i.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&n<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==e);return r}function cd(e,i){var t=new Ll(e.i,e.x,e.y),r=new Ll(i.i,i.x,i.y),n=e.next,a=i.prev;return e.next=i,i.prev=e,t.next=n,n.prev=t,r.next=t,t.prev=r,a.next=r,r.prev=a,r}function ud(e,i,t,r){var n=new Ll(e,i,t);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function Pa(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ll(e,i,t){this.i=e,this.x=i,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C0(e,i,t,r){for(var n=0,a=i,o=t-r;a<t;a+=r)n+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return n}var Or={area:function(e){for(var i=e.length,t=0,r=i-1,n=0;n<i;r=n++)t+=e[r].x*e[n].y-e[n].x*e[r].y;return t*.5},isClockWise:function(e){return Or.area(e)<0},triangulateShape:function(e,i){var t=[],r=[],n=[];hd(e),dd(t,e);var a=e.length;i.forEach(hd);for(var o=0;o<i.length;o++)r.push(a),a+=i[o].length,dd(t,i[o]);for(var s=m0.triangulate(t,r),l=0;l<s.length;l+=3)n.push(s.slice(l,l+3));return n}};function hd(e){var i=e.length;i>2&&e[i-1].equals(e[0])&&e.pop()}function dd(e,i){for(var t=0;t<i.length;t++)e.push(i[t].x),e.push(i[t].y)}var Ca=function(e){le(i,e);function i(r,n){var a;a=e.call(this)||this,a.type="ExtrudeBufferGeometry",a.parameters={shapes:r,options:n},r=Array.isArray(r)?r:[r];for(var o=Yi(a),s=[],l=[],c=0,h=r.length;c<h;c++){var u=r[c];p(u)}a.setAttribute("position",new te(s,3)),a.setAttribute("uv",new te(l,2)),a.computeVertexNormals();function p(d){var m=[],g=n.curveSegments!==void 0?n.curveSegments:12,b=n.steps!==void 0?n.steps:1,v=n.depth!==void 0?n.depth:100,f=n.bevelEnabled!==void 0?n.bevelEnabled:!0,M=n.bevelThickness!==void 0?n.bevelThickness:6,_=n.bevelSize!==void 0?n.bevelSize:M-2,w=n.bevelOffset!==void 0?n.bevelOffset:0,x=n.bevelSegments!==void 0?n.bevelSegments:3,S=n.extrudePath,A=n.UVGenerator!==void 0?n.UVGenerator:N0;n.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),v=n.amount);var I,P=!1,R,N,D,B;S&&(I=S.getSpacedPoints(b),P=!0,f=!1,R=S.computeFrenetFrames(b,!1),N=new T,D=new T,B=new T),f||(x=0,M=0,_=0,w=0);var O=d.extractPoints(g),U=O.shape,F=O.holes,k=!Or.isClockWise(U);if(k){U=U.reverse();for(var W=0,Y=F.length;W<Y;W++){var j=F[W];Or.isClockWise(j)&&(F[W]=j.reverse())}}for(var Z=Or.triangulateShape(U,F),ae=U,me=0,H=F.length;me<H;me++){var Ee=F[me];U=U.concat(Ee)}function ce(De,Me,Ue){return Me||console.error("THREE.ExtrudeGeometry: vec does not exist"),Me.clone().multiplyScalar(Ue).add(De)}var Ce=U.length,ue=Z.length;function Ne(De,Me,Ue){var Pe,Ie,$e,Tt=De.x-Me.x,Et=De.y-Me.y,Ot=Ue.x-De.x,jt=Ue.y-De.y,Gr=Tt*Tt+Et*Et,Mc=Tt*jt-Et*Ot;if(Math.abs(Mc)>Number.EPSILON){var vs=Math.sqrt(Gr),fp=Math.sqrt(Ot*Ot+jt*jt),mp=Me.x-Et/vs,vp=Me.y+Tt/vs,hx=Ue.x-jt/fp,dx=Ue.y+Ot/fp,gp=((hx-mp)*jt-(dx-vp)*Ot)/(Tt*jt-Et*Ot);Pe=mp+Tt*gp-De.x,Ie=vp+Et*gp-De.y;var yp=Pe*Pe+Ie*Ie;if(yp<=2)return new X(Pe,Ie);$e=Math.sqrt(yp/2)}else{var gs=!1;Tt>Number.EPSILON?Ot>Number.EPSILON&&(gs=!0):Tt<-Number.EPSILON?Ot<-Number.EPSILON&&(gs=!0):Math.sign(Et)===Math.sign(jt)&&(gs=!0),gs?(Pe=-Et,Ie=Tt,$e=Math.sqrt(Gr)):(Pe=Tt,Ie=Et,$e=Math.sqrt(Gr/2))}return new X(Pe/$e,Ie/$e)}for(var xe=[],Fe=0,Be=ae.length,qe=Be-1,Ze=Fe+1;Fe<Be;Fe++,qe++,Ze++)qe===Be&&(qe=0),Ze===Be&&(Ze=0),xe[Fe]=Ne(ae[Fe],ae[qe],ae[Ze]);for(var pt=[],it,Qe=xe.concat(),C=0,L=F.length;C<L;C++){var Q=F[C];it=[];for(var K=0,ge=Q.length,z=ge-1,ne=K+1;K<ge;K++,z++,ne++)z===ge&&(z=0),ne===ge&&(ne=0),it[K]=Ne(Q[K],Q[z],Q[ne]);pt.push(it),Qe=Qe.concat(it)}for(var re=0;re<x;re++){for(var ve=re/x,J=M*Math.cos(ve*Math.PI/2),oe=_*Math.sin(ve*Math.PI/2)+w,we=0,Se=ae.length;we<Se;we++){var ft=ce(ae[we],xe[we],oe);he(ft.x,ft.y,-J)}for(var Ae=0,ot=F.length;Ae<ot;Ae++){var Ge=F[Ae];it=pt[Ae];for(var Wt=0,On=Ge.length;Wt<On;Wt++){var si=ce(Ge[Wt],it[Wt],oe);he(si.x,si.y,-J)}}}for(var cr=_+w,Ur=0;Ur<Ce;Ur++){var wr=f?ce(U[Ur],Qe[Ur],cr):U[Ur];P?(D.copy(R.normals[0]).multiplyScalar(wr.x),N.copy(R.binormals[0]).multiplyScalar(wr.y),B.copy(I[0]).add(D).add(N),he(B.x,B.y,B.z)):he(wr.x,wr.y,0)}for(var Fr=1;Fr<=b;Fr++)for(var li=0;li<Ce;li++){var Ui=f?ce(U[li],Qe[li],cr):U[li];P?(D.copy(R.normals[Fr]).multiplyScalar(Ui.x),N.copy(R.binormals[Fr]).multiplyScalar(Ui.y),B.copy(I[Fr]).add(D).add(N),he(B.x,B.y,B.z)):he(Ui.x,Ui.y,v/b*Fr)}for(var ci=x-1;ci>=0;ci--){for(var Ga=ci/x,Ha=M*Math.cos(Ga*Math.PI/2),ms=_*Math.sin(Ga*Math.PI/2)+w,E=0,V=ae.length;E<V;E++){var G=ce(ae[E],xe[E],ms);he(G.x,G.y,v+Ha)}for(var q=0,$=F.length;q<$;q++){var Oe=F[q];it=pt[q];for(var Le=0,He=Oe.length;Le<He;Le++){var _e=ce(Oe[Le],it[Le],ms);P?he(_e.x,_e.y+I[b-1].y,I[b-1].x+Ha):he(_e.x,_e.y,v+Ha)}}}st(),tt();function st(){var De=s.length/3;if(f){for(var Me=0,Ue=Ce*Me,Pe=0;Pe<ue;Pe++){var Ie=Z[Pe];gt(Ie[2]+Ue,Ie[1]+Ue,Ie[0]+Ue)}Me=b+x*2,Ue=Ce*Me;for(var $e=0;$e<ue;$e++){var Tt=Z[$e];gt(Tt[0]+Ue,Tt[1]+Ue,Tt[2]+Ue)}}else{for(var Et=0;Et<ue;Et++){var Ot=Z[Et];gt(Ot[2],Ot[1],Ot[0])}for(var jt=0;jt<ue;jt++){var Gr=Z[jt];gt(Gr[0]+Ce*b,Gr[1]+Ce*b,Gr[2]+Ce*b)}}o.addGroup(De,s.length/3-De,0)}function tt(){var De=s.length/3,Me=0;lt(ae,Me),Me+=ae.length;for(var Ue=0,Pe=F.length;Ue<Pe;Ue++){var Ie=F[Ue];lt(Ie,Me),Me+=Ie.length}o.addGroup(De,s.length/3-De,1)}function lt(De,Me){for(var Ue=De.length;--Ue>=0;){var Pe=Ue,Ie=Ue-1;Ie<0&&(Ie=De.length-1);for(var $e=0,Tt=b+x*2;$e<Tt;$e++){var Et=Ce*$e,Ot=Ce*($e+1),jt=Me+Pe+Et,Gr=Me+Ie+Et,Mc=Me+Ie+Ot,vs=Me+Pe+Ot;yt(jt,Gr,Mc,vs)}}}function he(De,Me,Ue){m.push(De),m.push(Me),m.push(Ue)}function gt(De,Me,Ue){ze(De),ze(Me),ze(Ue);var Pe=s.length/3,Ie=A.generateTopUV(o,s,Pe-3,Pe-2,Pe-1);ut(Ie[0]),ut(Ie[1]),ut(Ie[2])}function yt(De,Me,Ue,Pe){ze(De),ze(Me),ze(Pe),ze(Me),ze(Ue),ze(Pe);var Ie=s.length/3,$e=A.generateSideWallUV(o,s,Ie-6,Ie-3,Ie-2,Ie-1);ut($e[0]),ut($e[1]),ut($e[3]),ut($e[1]),ut($e[2]),ut($e[3])}function ze(De){s.push(m[De*3+0]),s.push(m[De*3+1]),s.push(m[De*3+2])}function ut(De){l.push(De.x),l.push(De.y)}}return a}var t=i.prototype;return t.toJSON=function(){var r=pe.prototype.toJSON.call(this),n=this.parameters.shapes,a=this.parameters.options;return O0(n,a,r)},i}(pe),N0={generateTopUV:function(e,i,t,r,n){var a=i[t*3],o=i[t*3+1],s=i[r*3],l=i[r*3+1],c=i[n*3],h=i[n*3+1];return[new X(a,o),new X(s,l),new X(c,h)]},generateSideWallUV:function(e,i,t,r,n,a){var o=i[t*3],s=i[t*3+1],l=i[t*3+2],c=i[r*3],h=i[r*3+1],u=i[r*3+2],p=i[n*3],d=i[n*3+1],m=i[n*3+2],g=i[a*3],b=i[a*3+1],v=i[a*3+2];return Math.abs(s-h)<.01?[new X(o,1-l),new X(c,1-u),new X(p,1-m),new X(g,1-v)]:[new X(s,1-l),new X(h,1-u),new X(d,1-m),new X(b,1-v)]}};function O0(e,i,t){if(t.shapes=[],Array.isArray(e))for(var r=0,n=e.length;r<n;r++){var a=e[r];t.shapes.push(a.uuid)}else t.shapes.push(e.uuid);return i.extrudePath!==void 0&&(t.options.extrudePath=i.extrudePath.toJSON()),t}var Rl=function(e){le(i,e);function i(r,n){var a;return a=e.call(this)||this,a.type="ExtrudeGeometry",a.parameters={shapes:r,options:n},a.fromBufferGeometry(new Ca(r,n)),a.mergeVertices(),a}var t=i.prototype;return t.toJSON=function(){var r=e.prototype.toJSON.call(this),n=this.parameters.shapes,a=this.parameters.options;return I0(n,a,r)},i}(je);function I0(e,i,t){if(t.shapes=[],Array.isArray(e))for(var r=0,n=e.length;r<n;r++){var a=e[r];t.shapes.push(a.uuid)}else t.shapes.push(e.uuid);return i.extrudePath!==void 0&&(t.options.extrudePath=i.extrudePath.toJSON()),t}var Pl=function(e){le(i,e);function i(t,r){var n;t===void 0&&(t=1),r===void 0&&(r=0);var a=(1+Math.sqrt(5))/2,o=[-1,a,0,1,a,0,-1,-a,0,1,-a,0,0,-1,a,0,1,a,0,-1,-a,0,1,-a,a,0,-1,a,0,1,-a,0,-1,-a,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];return n=e.call(this,o,s,t,r)||this,n.type="IcosahedronBufferGeometry",n.parameters={radius:t,detail:r},n}return i}(Ti),pd=function(e){le(i,e);function i(t,r){var n;return n=e.call(this)||this,n.type="IcosahedronGeometry",n.parameters={radius:t,detail:r},n.fromBufferGeometry(new Pl(t,r)),n.mergeVertices(),n}return i}(je),Cl=function(e){le(i,e);function i(t,r,n,a){var o;r===void 0&&(r=12),n===void 0&&(n=0),a===void 0&&(a=Math.PI*2),o=e.call(this)||this,o.type="LatheBufferGeometry",o.parameters={points:t,segments:r,phiStart:n,phiLength:a},r=Math.floor(r),a=be.clamp(a,0,Math.PI*2);for(var s=[],l=[],c=[],h=1/r,u=new T,p=new X,d=0;d<=r;d++)for(var m=n+d*h*a,g=Math.sin(m),b=Math.cos(m),v=0;v<=t.length-1;v++)u.x=t[v].x*g,u.y=t[v].y,u.z=t[v].x*b,l.push(u.x,u.y,u.z),p.x=d/r,p.y=v/(t.length-1),c.push(p.x,p.y);for(var f=0;f<r;f++)for(var M=0;M<t.length-1;M++){var _=M+f*t.length,w=_,x=_+t.length,S=_+t.length+1,A=_+1;s.push(w,x,A),s.push(x,S,A)}if(o.setIndex(s),o.setAttribute("position",new te(l,3)),o.setAttribute("uv",new te(c,2)),o.computeVertexNormals(),a===Math.PI*2)for(var I=o.attributes.normal.array,P=new T,R=new T,N=new T,D=r*t.length*3,B=0,O=0;B<t.length;B++,O+=3)P.x=I[O+0],P.y=I[O+1],P.z=I[O+2],R.x=I[D+O+0],R.y=I[D+O+1],R.z=I[D+O+2],N.addVectors(P,R).normalize(),I[O+0]=I[D+O+0]=N.x,I[O+1]=I[D+O+1]=N.y,I[O+2]=I[D+O+2]=N.z;return o}return i}(pe),fd=function(e){le(i,e);function i(t,r,n,a){var o;return o=e.call(this)||this,o.type="LatheGeometry",o.parameters={points:t,segments:r,phiStart:n,phiLength:a},o.fromBufferGeometry(new Cl(t,r,n,a)),o.mergeVertices(),o}return i}(je),Uo=function(e){le(i,e);function i(t,r){var n;t===void 0&&(t=1),r===void 0&&(r=0);var a=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],o=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];return n=e.call(this,a,o,t,r)||this,n.type="OctahedronBufferGeometry",n.parameters={radius:t,detail:r},n}return i}(Ti),md=function(e){le(i,e);function i(t,r){var n;return n=e.call(this)||this,n.type="OctahedronGeometry",n.parameters={radius:t,detail:r},n.fromBufferGeometry(new Uo(t,r)),n.mergeVertices(),n}return i}(je);function Sn(e,i,t){pe.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:i,stacks:t};var r=[],n=[],a=[],o=[],s=1e-5,l=new T,c=new T,h=new T,u=new T,p=new T;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var d=i+1,m=0;m<=t;m++)for(var g=m/t,b=0;b<=i;b++){var v=b/i;e(v,g,c),n.push(c.x,c.y,c.z),v-s>=0?(e(v-s,g,h),u.subVectors(c,h)):(e(v+s,g,h),u.subVectors(h,c)),g-s>=0?(e(v,g-s,h),p.subVectors(c,h)):(e(v,g+s,h),p.subVectors(h,c)),l.crossVectors(u,p).normalize(),a.push(l.x,l.y,l.z),o.push(v,g)}for(var f=0;f<t;f++)for(var M=0;M<i;M++){var _=f*d+M,w=f*d+M+1,x=(f+1)*d+M+1,S=(f+1)*d+M;r.push(_,w,S),r.push(w,x,S)}this.setIndex(r),this.setAttribute("position",new te(n,3)),this.setAttribute("normal",new te(a,3)),this.setAttribute("uv",new te(o,2))}Sn.prototype=Object.create(pe.prototype),Sn.prototype.constructor=Sn;function Na(e,i,t){je.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:i,stacks:t},this.fromBufferGeometry(new Sn(e,i,t)),this.mergeVertices()}Na.prototype=Object.create(je.prototype),Na.prototype.constructor=Na;var vd=function(e){le(i,e);function i(t,r,n,a){var o;return o=e.call(this)||this,o.type="PlaneGeometry",o.parameters={width:t,height:r,widthSegments:n,heightSegments:a},o.fromBufferGeometry(new go(t,r,n,a)),o.mergeVertices(),o}return i}(je),gd=function(e){le(i,e);function i(t,r,n,a){var o;return o=e.call(this)||this,o.type="PolyhedronGeometry",o.parameters={vertices:t,indices:r,radius:n,detail:a},o.fromBufferGeometry(new Ti(t,r,n,a)),o.mergeVertices(),o}return i}(je),Nl=function(e){le(i,e);function i(t,r,n,a,o,s){var l;t===void 0&&(t=.5),r===void 0&&(r=1),n===void 0&&(n=8),a===void 0&&(a=1),o===void 0&&(o=0),s===void 0&&(s=Math.PI*2),l=e.call(this)||this,l.type="RingBufferGeometry",l.parameters={innerRadius:t,outerRadius:r,thetaSegments:n,phiSegments:a,thetaStart:o,thetaLength:s},n=Math.max(3,n),a=Math.max(1,a);for(var c=[],h=[],u=[],p=[],d=t,m=(r-t)/a,g=new T,b=new X,v=0;v<=a;v++){for(var f=0;f<=n;f++){var M=o+f/n*s;g.x=d*Math.cos(M),g.y=d*Math.sin(M),h.push(g.x,g.y,g.z),u.push(0,0,1),b.x=(g.x/r+1)/2,b.y=(g.y/r+1)/2,p.push(b.x,b.y)}d+=m}for(var _=0;_<a;_++)for(var w=_*(n+1),x=0;x<n;x++){var S=x+w,A=S,I=S+n+1,P=S+n+2,R=S+1;c.push(A,I,R),c.push(I,P,R)}return l.setIndex(c),l.setAttribute("position",new te(h,3)),l.setAttribute("normal",new te(u,3)),l.setAttribute("uv",new te(p,2)),l}return i}(pe),yd=function(e){le(i,e);function i(t,r,n,a,o,s){var l;return l=e.call(this)||this,l.type="RingGeometry",l.parameters={innerRadius:t,outerRadius:r,thetaSegments:n,phiSegments:a,thetaStart:o,thetaLength:s},l.fromBufferGeometry(new Nl(t,r,n,a,o,s)),l.mergeVertices(),l}return i}(je),Ol=function(e){le(i,e);function i(r,n){var a;n===void 0&&(n=12),a=e.call(this)||this,a.type="ShapeBufferGeometry",a.parameters={shapes:r,curveSegments:n};var o=[],s=[],l=[],c=[],h=0,u=0;if(Array.isArray(r)===!1)d(r);else for(var p=0;p<r.length;p++)d(r[p]),a.addGroup(h,u,p),h+=u,u=0;a.setIndex(o),a.setAttribute("position",new te(s,3)),a.setAttribute("normal",new te(l,3)),a.setAttribute("uv",new te(c,2));function d(m){var g=s.length/3,b=m.extractPoints(n),v=b.shape,f=b.holes;Or.isClockWise(v)===!1&&(v=v.reverse());for(var M=0,_=f.length;M<_;M++){var w=f[M];Or.isClockWise(w)===!0&&(f[M]=w.reverse())}for(var x=Or.triangulateShape(v,f),S=0,A=f.length;S<A;S++){var I=f[S];v=v.concat(I)}for(var P=0,R=v.length;P<R;P++){var N=v[P];s.push(N.x,N.y,0),l.push(0,0,1),c.push(N.x,N.y)}for(var D=0,B=x.length;D<B;D++){var O=x[D],U=O[0]+g,F=O[1]+g,k=O[2]+g;o.push(U,F,k),u+=3}}return a}var t=i.prototype;return t.toJSON=function(){var r=pe.prototype.toJSON.call(this),n=this.parameters.shapes;return D0(n,r)},i}(pe);function D0(e,i){if(i.shapes=[],Array.isArray(e))for(var t=0,r=e.length;t<r;t++){var n=e[t];i.shapes.push(n.uuid)}else i.shapes.push(e.uuid);return i}var Il=function(e){le(i,e);function i(r,n){var a;return a=e.call(this)||this,a.type="ShapeGeometry",typeof n=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),n=n.curveSegments),a.parameters={shapes:r,curveSegments:n},a.fromBufferGeometry(new Ol(r,n)),a.mergeVertices(),a}var t=i.prototype;return t.toJSON=function(){var r=je.prototype.toJSON.call(this),n=this.parameters.shapes;return B0(n,r)},i}(je);function B0(e,i){if(i.shapes=[],Array.isArray(e))for(var t=0,r=e.length;t<r;t++){var n=e[t];i.shapes.push(n.uuid)}else i.shapes.push(e.uuid);return i}var Fo=function(e){le(i,e);function i(t,r,n,a,o,s,l){var c;t===void 0&&(t=1),r===void 0&&(r=8),n===void 0&&(n=6),a===void 0&&(a=0),o===void 0&&(o=Math.PI*2),s===void 0&&(s=0),l===void 0&&(l=Math.PI),c=e.call(this)||this,c.type="SphereBufferGeometry",c.parameters={radius:t,widthSegments:r,heightSegments:n,phiStart:a,phiLength:o,thetaStart:s,thetaLength:l},r=Math.max(3,Math.floor(r)),n=Math.max(2,Math.floor(n));for(var h=Math.min(s+l,Math.PI),u=0,p=[],d=new T,m=new T,g=[],b=[],v=[],f=[],M=0;M<=n;M++){var _=[],w=M/n,x=0;M==0&&s==0?x=.5/r:M==n&&h==Math.PI&&(x=-.5/r);for(var S=0;S<=r;S++){var A=S/r;d.x=-t*Math.cos(a+A*o)*Math.sin(s+w*l),d.y=t*Math.cos(s+w*l),d.z=t*Math.sin(a+A*o)*Math.sin(s+w*l),b.push(d.x,d.y,d.z),m.copy(d).normalize(),v.push(m.x,m.y,m.z),f.push(A+x,1-w),_.push(u++)}p.push(_)}for(var I=0;I<n;I++)for(var P=0;P<r;P++){var R=p[I][P+1],N=p[I][P],D=p[I+1][P],B=p[I+1][P+1];(I!==0||s>0)&&g.push(R,N,B),(I!==n-1||h<Math.PI)&&g.push(N,D,B)}return c.setIndex(g),c.setAttribute("position",new te(b,3)),c.setAttribute("normal",new te(v,3)),c.setAttribute("uv",new te(f,2)),c}return i}(pe),xd=function(e){le(i,e);function i(t,r,n,a,o,s,l){var c;return c=e.call(this)||this,c.type="SphereGeometry",c.parameters={radius:t,widthSegments:r,heightSegments:n,phiStart:a,phiLength:o,thetaStart:s,thetaLength:l},c.fromBufferGeometry(new Fo(t,r,n,a,o,s,l)),c.mergeVertices(),c}return i}(je),Dl=function(e){le(i,e);function i(t,r){var n;t===void 0&&(t=1),r===void 0&&(r=0);var a=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],o=[2,1,0,0,3,2,1,3,0,2,3,1];return n=e.call(this,a,o,t,r)||this,n.type="TetrahedronBufferGeometry",n.parameters={radius:t,detail:r},n}return i}(Ti),bd=function(e){le(i,e);function i(t,r){var n;return n=e.call(this)||this,n.type="TetrahedronGeometry",n.parameters={radius:t,detail:r},n.fromBufferGeometry(new Dl(t,r)),n.mergeVertices(),n}return i}(je),Bl=function(e){le(i,e);function i(t,r){var n;r===void 0&&(r={});var a=r.font;if(!(a&&a.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new pe||Yi(n);var o=a.generateShapes(t,r.size);return r.depth=r.height!==void 0?r.height:50,r.bevelThickness===void 0&&(r.bevelThickness=10),r.bevelSize===void 0&&(r.bevelSize=8),r.bevelEnabled===void 0&&(r.bevelEnabled=!1),n=e.call(this,o,r)||this,n.type="TextBufferGeometry",n}return i}(Ca),_d=function(e){le(i,e);function i(t,r){var n;return n=e.call(this)||this,n.type="TextGeometry",n.parameters={text:t,parameters:r},n.fromBufferGeometry(new Bl(t,r)),n.mergeVertices(),n}return i}(je),zl=function(e){le(i,e);function i(t,r,n,a,o){var s;t===void 0&&(t=1),r===void 0&&(r=.4),n===void 0&&(n=8),a===void 0&&(a=6),o===void 0&&(o=Math.PI*2),s=e.call(this)||this,s.type="TorusBufferGeometry",s.parameters={radius:t,tube:r,radialSegments:n,tubularSegments:a,arc:o},n=Math.floor(n),a=Math.floor(a);for(var l=[],c=[],h=[],u=[],p=new T,d=new T,m=new T,g=0;g<=n;g++)for(var b=0;b<=a;b++){var v=b/a*o,f=g/n*Math.PI*2;d.x=(t+r*Math.cos(f))*Math.cos(v),d.y=(t+r*Math.cos(f))*Math.sin(v),d.z=r*Math.sin(f),c.push(d.x,d.y,d.z),p.x=t*Math.cos(v),p.y=t*Math.sin(v),m.subVectors(d,p).normalize(),h.push(m.x,m.y,m.z),u.push(b/a),u.push(g/n)}for(var M=1;M<=n;M++)for(var _=1;_<=a;_++){var w=(a+1)*M+_-1,x=(a+1)*(M-1)+_-1,S=(a+1)*(M-1)+_,A=(a+1)*M+_;l.push(w,x,A),l.push(x,S,A)}return s.setIndex(l),s.setAttribute("position",new te(c,3)),s.setAttribute("normal",new te(h,3)),s.setAttribute("uv",new te(u,2)),s}return i}(pe),wd=function(e){le(i,e);function i(t,r,n,a,o){var s;return s=e.call(this)||this,s.type="TorusGeometry",s.parameters={radius:t,tube:r,radialSegments:n,tubularSegments:a,arc:o},s.fromBufferGeometry(new zl(t,r,n,a,o)),s.mergeVertices(),s}return i}(je),Ul=function(e){le(i,e);function i(t,r,n,a,o,s){var l;t===void 0&&(t=1),r===void 0&&(r=.4),n===void 0&&(n=64),a===void 0&&(a=8),o===void 0&&(o=2),s===void 0&&(s=3),l=e.call(this)||this,l.type="TorusKnotBufferGeometry",l.parameters={radius:t,tube:r,tubularSegments:n,radialSegments:a,p:o,q:s},n=Math.floor(n),a=Math.floor(a);for(var c=[],h=[],u=[],p=[],d=new T,m=new T,g=new T,b=new T,v=new T,f=new T,M=new T,_=0;_<=n;++_){var w=_/n*o*Math.PI*2;U(w,o,s,t,g),U(w+.01,o,s,t,b),f.subVectors(b,g),M.addVectors(b,g),v.crossVectors(f,M),M.crossVectors(v,f),v.normalize(),M.normalize();for(var x=0;x<=a;++x){var S=x/a*Math.PI*2,A=-r*Math.cos(S),I=r*Math.sin(S);d.x=g.x+(A*M.x+I*v.x),d.y=g.y+(A*M.y+I*v.y),d.z=g.z+(A*M.z+I*v.z),h.push(d.x,d.y,d.z),m.subVectors(d,g).normalize(),u.push(m.x,m.y,m.z),p.push(_/n),p.push(x/a)}}for(var P=1;P<=n;P++)for(var R=1;R<=a;R++){var N=(a+1)*(P-1)+(R-1),D=(a+1)*P+(R-1),B=(a+1)*P+R,O=(a+1)*(P-1)+R;c.push(N,D,O),c.push(D,B,O)}l.setIndex(c),l.setAttribute("position",new te(h,3)),l.setAttribute("normal",new te(u,3)),l.setAttribute("uv",new te(p,2));function U(F,k,W,Y,j){var Z=Math.cos(F),ae=Math.sin(F),me=W/k*F,H=Math.cos(me);j.x=Y*(2+H)*.5*Z,j.y=Y*(2+H)*ae*.5,j.z=Y*Math.sin(me)*.5}return l}return i}(pe),Md=function(e){le(i,e);function i(t,r,n,a,o,s,l){var c;return c=e.call(this)||this,c.type="TorusKnotGeometry",c.parameters={radius:t,tube:r,tubularSegments:n,radialSegments:a,p:o,q:s},l!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),c.fromBufferGeometry(new Ul(t,r,n,a,o,s)),c.mergeVertices(),c}return i}(je),Fl=function(e){le(i,e);function i(r,n,a,o,s){var l;n===void 0&&(n=64),a===void 0&&(a=1),o===void 0&&(o=8),s===void 0&&(s=!1),l=e.call(this)||this,l.type="TubeBufferGeometry",l.parameters={path:r,tubularSegments:n,radius:a,radialSegments:o,closed:s};var c=r.computeFrenetFrames(n,s);l.tangents=c.tangents,l.normals=c.normals,l.binormals=c.binormals;var h=new T,u=new T,p=new X,d=new T,m=[],g=[],b=[],v=[];f(),l.setIndex(v),l.setAttribute("position",new te(m,3)),l.setAttribute("normal",new te(g,3)),l.setAttribute("uv",new te(b,2));function f(){for(var x=0;x<n;x++)M(x);M(s===!1?n:0),w(),_()}function M(x){d=r.getPointAt(x/n,d);for(var S=c.normals[x],A=c.binormals[x],I=0;I<=o;I++){var P=I/o*Math.PI*2,R=Math.sin(P),N=-Math.cos(P);u.x=N*S.x+R*A.x,u.y=N*S.y+R*A.y,u.z=N*S.z+R*A.z,u.normalize(),g.push(u.x,u.y,u.z),h.x=d.x+a*u.x,h.y=d.y+a*u.y,h.z=d.z+a*u.z,m.push(h.x,h.y,h.z)}}function _(){for(var x=1;x<=n;x++)for(var S=1;S<=o;S++){var A=(o+1)*(x-1)+(S-1),I=(o+1)*x+(S-1),P=(o+1)*x+S,R=(o+1)*(x-1)+S;v.push(A,I,R),v.push(I,P,R)}}function w(){for(var x=0;x<=n;x++)for(var S=0;S<=o;S++)p.x=x/n,p.y=S/o,b.push(p.x,p.y)}return l}var t=i.prototype;return t.toJSON=function(){var r=pe.prototype.toJSON.call(this);return r.path=this.parameters.path.toJSON(),r},i}(pe),Sd=function(e){le(i,e);function i(t,r,n,a,o,s){var l;l=e.call(this)||this,l.type="TubeGeometry",l.parameters={path:t,tubularSegments:r,radius:n,radialSegments:a,closed:o},s!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");var c=new Fl(t,r,n,a,o);return l.tangents=c.tangents,l.normals=c.normals,l.binormals=c.binormals,l.fromBufferGeometry(c),l.mergeVertices(),l}return i}(je),Gl=function(e){le(i,e);function i(t){var r;r=e.call(this)||this,r.type="WireframeGeometry";var n=[],a=[0,0],o={},s=["a","b","c"];if(t&&t.isGeometry){for(var l=t.faces,c=0,h=l.length;c<h;c++)for(var u=l[c],p=0;p<3;p++){var d=u[s[p]],m=u[s[(p+1)%3]];a[0]=Math.min(d,m),a[1]=Math.max(d,m);var g=a[0]+","+a[1];o[g]===void 0&&(o[g]={index1:a[0],index2:a[1]})}for(var b in o){var v=o[b],f=t.vertices[v.index1];n.push(f.x,f.y,f.z),f=t.vertices[v.index2],n.push(f.x,f.y,f.z)}}else if(t&&t.isBufferGeometry){var M=new T;if(t.index!==null){var _=t.attributes.position,w=t.index,x=t.groups;x.length===0&&(x=[{start:0,count:w.count,materialIndex:0}]);for(var S=0,A=x.length;S<A;++S)for(var I=x[S],P=I.start,R=I.count,N=P,D=P+R;N<D;N+=3)for(var B=0;B<3;B++){var O=w.getX(N+B),U=w.getX(N+(B+1)%3);a[0]=Math.min(O,U),a[1]=Math.max(O,U);var F=a[0]+","+a[1];o[F]===void 0&&(o[F]={index1:a[0],index2:a[1]})}for(var k in o){var W=o[k];M.fromBufferAttribute(_,W.index1),n.push(M.x,M.y,M.z),M.fromBufferAttribute(_,W.index2),n.push(M.x,M.y,M.z)}}else for(var Y=t.attributes.position,j=0,Z=Y.count/3;j<Z;j++)for(var ae=0;ae<3;ae++){var me=3*j+ae;M.fromBufferAttribute(Y,me),n.push(M.x,M.y,M.z);var H=3*j+(ae+1)%3;M.fromBufferAttribute(Y,H),n.push(M.x,M.y,M.z)}}return r.setAttribute("position",new te(n,3)),r}return i}(pe),Nt=Object.freeze({__proto__:null,BoxGeometry:_l,BoxBufferGeometry:ua,CircleGeometry:id,CircleBufferGeometry:wl,ConeGeometry:nd,ConeBufferGeometry:ad,CylinderGeometry:Ml,CylinderBufferGeometry:Aa,DodecahedronGeometry:od,DodecahedronBufferGeometry:Sl,EdgesGeometry:El,ExtrudeGeometry:Rl,ExtrudeBufferGeometry:Ca,IcosahedronGeometry:pd,IcosahedronBufferGeometry:Pl,LatheGeometry:fd,LatheBufferGeometry:Cl,OctahedronGeometry:md,OctahedronBufferGeometry:Uo,ParametricGeometry:Na,ParametricBufferGeometry:Sn,PlaneGeometry:vd,PlaneBufferGeometry:go,PolyhedronGeometry:gd,PolyhedronBufferGeometry:Ti,RingGeometry:yd,RingBufferGeometry:Nl,ShapeGeometry:Il,ShapeBufferGeometry:Ol,SphereGeometry:xd,SphereBufferGeometry:Fo,TetrahedronGeometry:bd,TetrahedronBufferGeometry:Dl,TextGeometry:_d,TextBufferGeometry:Bl,TorusGeometry:wd,TorusBufferGeometry:zl,TorusKnotGeometry:Md,TorusKnotBufferGeometry:Ul,TubeGeometry:Sd,TubeBufferGeometry:Fl,WireframeGeometry:Gl});function Ei(e){ye.call(this),this.type="ShadowMaterial",this.color=new ie(0),this.transparent=!0,this.setValues(e)}Ei.prototype=Object.create(ye.prototype),Ei.prototype.constructor=Ei,Ei.prototype.isShadowMaterial=!0,Ei.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.color.copy(e.color),this};function Ir(e){Pt.call(this,e),this.type="RawShaderMaterial"}Ir.prototype=Object.create(Pt.prototype),Ir.prototype.constructor=Ir,Ir.prototype.isRawShaderMaterial=!0;function gr(e){ye.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ie(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ie(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mi,this.normalScale=new X(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}gr.prototype=Object.create(ye.prototype),gr.prototype.constructor=gr,gr.prototype.isMeshStandardMaterial=!0,gr.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this};function ri(e){gr.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new X(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(i){this.reflectivity=be.clamp(2.5*(i-1)/(i+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}ri.prototype=Object.create(gr.prototype),ri.prototype.constructor=ri,ri.prototype.isMeshPhysicalMaterial=!0,ri.prototype.copy=function(e){return gr.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new ie).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this};function ii(e){ye.call(this),this.type="MeshPhongMaterial",this.color=new ie(16777215),this.specular=new ie(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ie(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mi,this.normalScale=new X(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Dn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}ii.prototype=Object.create(ye.prototype),ii.prototype.constructor=ii,ii.prototype.isMeshPhongMaterial=!0,ii.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function Ai(e){ye.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ie(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ie(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mi,this.normalScale=new X(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Ai.prototype=Object.create(ye.prototype),Ai.prototype.constructor=Ai,Ai.prototype.isMeshToonMaterial=!0,Ai.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function Li(e){ye.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mi,this.normalScale=new X(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Li.prototype=Object.create(ye.prototype),Li.prototype.constructor=Li,Li.prototype.isMeshNormalMaterial=!0,Li.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function Ri(e){ye.call(this),this.type="MeshLambertMaterial",this.color=new ie(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ie(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Dn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Ri.prototype=Object.create(ye.prototype),Ri.prototype.constructor=Ri,Ri.prototype.isMeshLambertMaterial=!0,Ri.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function Pi(e){ye.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ie(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mi,this.normalScale=new X(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Pi.prototype=Object.create(ye.prototype),Pi.prototype.constructor=Pi,Pi.prototype.isMeshMatcapMaterial=!0,Pi.prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function Ci(e){et.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}Ci.prototype=Object.create(et.prototype),Ci.prototype.constructor=Ci,Ci.prototype.isLineDashedMaterial=!0,Ci.prototype.copy=function(e){return et.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var z0=Object.freeze({__proto__:null,ShadowMaterial:Ei,SpriteMaterial:ei,RawShaderMaterial:Ir,ShaderMaterial:Pt,PointsMaterial:rr,MeshPhysicalMaterial:ri,MeshStandardMaterial:gr,MeshPhongMaterial:ii,MeshToonMaterial:Ai,MeshNormalMaterial:Li,MeshLambertMaterial:Ri,MeshDepthMaterial:Jr,MeshDistanceMaterial:Kr,MeshBasicMaterial:qt,MeshMatcapMaterial:Pi,LineDashedMaterial:Ci,LineBasicMaterial:et,Material:ye}),Ke={arraySlice:function(e,i,t){return Ke.isTypedArray(e)?new e.constructor(e.subarray(i,t!==void 0?t:e.length)):e.slice(i,t)},convertArray:function(e,i,t){return!e||!t&&e.constructor===i?e:typeof i.BYTES_PER_ELEMENT=="number"?new i(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){function i(a,o){return e[a]-e[o]}for(var t=e.length,r=new Array(t),n=0;n!==t;++n)r[n]=n;return r.sort(i),r},sortedArray:function(e,i,t){for(var r=e.length,n=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=t[a]*i,l=0;l!==i;++l)n[o++]=e[s+l];return n},flattenJSON:function(e,i,t,r){for(var n=1,a=e[0];a!==void 0&&a[r]===void 0;)a=e[n++];if(a!==void 0){var o=a[r];if(o!==void 0)if(Array.isArray(o))do o=a[r],o!==void 0&&(i.push(a.time),t.push.apply(t,o)),a=e[n++];while(a!==void 0);else if(o.toArray!==void 0)do o=a[r],o!==void 0&&(i.push(a.time),o.toArray(t,t.length)),a=e[n++];while(a!==void 0);else do o=a[r],o!==void 0&&(i.push(a.time),t.push(o)),a=e[n++];while(a!==void 0)}},subclip:function(e,i,t,r,n){n===void 0&&(n=30);var a=e.clone();a.name=i;for(var o=[],s=0;s<a.tracks.length;++s){for(var l=a.tracks[s],c=l.getValueSize(),h=[],u=[],p=0;p<l.times.length;++p){var d=l.times[p]*n;if(!(d<t||d>=r)){h.push(l.times[p]);for(var m=0;m<c;++m)u.push(l.values[p*c+m])}}h.length!==0&&(l.times=Ke.convertArray(h,l.times.constructor),l.values=Ke.convertArray(u,l.values.constructor),o.push(l))}a.tracks=o;for(var g=Infinity,b=0;b<a.tracks.length;++b)g>a.tracks[b].times[0]&&(g=a.tracks[b].times[0]);for(var v=0;v<a.tracks.length;++v)a.tracks[v].shift(-1*g);return a.resetDuration(),a},makeClipAdditive:function(e,i,t,r){i===void 0&&(i=0),t===void 0&&(t=e),r===void 0&&(r=30),r<=0&&(r=30);for(var n=t.tracks.length,a=i/r,o=function(c){var h=t.tracks[c],u=h.ValueTypeName;if(u==="bool"||u==="string")return"continue";var p=e.tracks.find(function(U){return U.name===h.name&&U.ValueTypeName===u});if(p===void 0)return"continue";var d=0,m=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=m/3);var g=0,b=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=b/3);var v=h.times.length-1,f=void 0;if(a<=h.times[0]){var M=d,_=m-d;f=Ke.arraySlice(h.values,M,_)}else if(a>=h.times[v]){var w=v*m+d,x=w+m-d;f=Ke.arraySlice(h.values,w,x)}else{var S=h.createInterpolant(),A=d,I=m-d;S.evaluate(a),f=Ke.arraySlice(S.resultBuffer,A,I)}if(u==="quaternion"){var P=new _t().fromArray(f).normalize().conjugate();P.toArray(f)}for(var R=p.times.length,N=0;N<R;++N){var D=N*b+g;if(u==="quaternion")_t.multiplyQuaternionsFlat(p.values,D,f,0,p.values,D);else for(var B=b-g*2,O=0;O<B;++O)p.values[D+O]-=f[O]}},s=0;s<n;++s)var l=o(s);return e.blendMode=Fs,e}};function Ht(e,i,t,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new i.constructor(t),this.sampleValues=i,this.valueSize=t}Object.assign(Ht.prototype,{evaluate:function(e){var i=this.parameterPositions,t=this._cachedIndex,r=i[t],n=i[t-1];e:{t:{var a;r:{i:if(!(e<r)){for(var o=t+2;;){if(r===void 0){if(e<n)break i;return t=i.length,this._cachedIndex=t,this.afterEnd_(t-1,e,n)}if(t===o)break;if(n=r,r=i[++t],e<r)break t}a=i.length;break r}if(!(e>=n)){var s=i[1];e<s&&(t=2,n=s);for(var l=t-2;;){if(n===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(t===l)break;if(r=n,n=i[--t-1],e>=n)break t}a=t,t=0;break r}break e}for(;t<a;){var c=t+a>>>1;e<i[c]?a=c:t=c+1}if(r=i[t],n=i[t-1],n===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(r===void 0)return t=i.length,this._cachedIndex=t,this.afterEnd_(t-1,n,e)}this._cachedIndex=t,this.intervalChanged_(t,n,r)}return this.interpolate_(t,n,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var i=this.resultBuffer,t=this.sampleValues,r=this.valueSize,n=e*r,a=0;a!==r;++a)i[a]=t[n+a];return i},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Ht.prototype,{beforeStart_:Ht.prototype.copySampleValue_,afterEnd_:Ht.prototype.copySampleValue_});function Go(e,i,t,r){Ht.call(this,e,i,t,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}Go.prototype=Object.assign(Object.create(Ht.prototype),{constructor:Go,DefaultSettings_:{endingStart:pi,endingEnd:pi},intervalChanged_:function(e,i,t){var r=this.parameterPositions,n=e-2,a=e+1,o=r[n],s=r[a];if(o===void 0)switch(this.getSettings_().endingStart){case fi:n=e,o=2*i-t;break;case qn:n=r.length-2,o=i+r[n]-r[n+1];break;default:n=e,o=t}if(s===void 0)switch(this.getSettings_().endingEnd){case fi:a=e,s=2*t-i;break;case qn:a=1,s=t+r[1]-r[0];break;default:a=e-1,s=i}var l=(t-i)*.5,c=this.valueSize;this._weightPrev=l/(i-o),this._weightNext=l/(s-t),this._offsetPrev=n*c,this._offsetNext=a*c},interpolate_:function(e,i,t,r){for(var n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,p=this._weightNext,d=(t-i)/(r-i),m=d*d,g=m*d,b=-u*g+2*u*m-u*d,v=(1+u)*g+(-1.5-2*u)*m+(-.5+u)*d+1,f=(-1-p)*g+(1.5+p)*m+.5*d,M=p*g-p*m,_=0;_!==o;++_)n[_]=b*a[c+_]+v*a[l+_]+f*a[s+_]+M*a[h+_];return n}});function Oa(e,i,t,r){Ht.call(this,e,i,t,r)}Oa.prototype=Object.assign(Object.create(Ht.prototype),{constructor:Oa,interpolate_:function(e,i,t,r){for(var n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(t-i)/(r-i),h=1-c,u=0;u!==o;++u)n[u]=a[l+u]*h+a[s+u]*c;return n}});function Ho(e,i,t,r){Ht.call(this,e,i,t,r)}Ho.prototype=Object.assign(Object.create(Ht.prototype),{constructor:Ho,interpolate_:function(e){return this.copySampleValue_(e-1)}});function bt(e,i,t,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ke.convertArray(i,this.TimeBufferType),this.values=Ke.convertArray(t,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}Object.assign(bt,{toJSON:function(e){var i=e.constructor,t;if(i.toJSON!==void 0)t=i.toJSON(e);else{t={name:e.name,times:Ke.convertArray(e.times,Array),values:Ke.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}),Object.assign(bt.prototype,{constructor:bt,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:jn,InterpolantFactoryMethodDiscrete:function(e){return new Ho(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Oa(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Go(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var i;switch(e){case Wn:i=this.InterpolantFactoryMethodDiscrete;break;case jn:i=this.InterpolantFactoryMethodLinear;break;case Ya:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){var t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(t);return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=i,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Wn;case this.InterpolantFactoryMethodLinear:return jn;case this.InterpolantFactoryMethodSmooth:return Ya}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0)for(var i=this.times,t=0,r=i.length;t!==r;++t)i[t]+=e;return this},scale:function(e){if(e!==1)for(var i=this.times,t=0,r=i.length;t!==r;++t)i[t]*=e;return this},trim:function(e,i){for(var t=this.times,r=t.length,n=0,a=r-1;n!==r&&t[n]<e;)++n;for(;a!==-1&&t[a]>i;)--a;if(++a,n!==0||a!==r){n>=a&&(a=Math.max(a,1),n=a-1);var o=this.getValueSize();this.times=Ke.arraySlice(t,n,a),this.values=Ke.arraySlice(this.values,n*o,a*o)}return this},validate:function(){var e=!0,i=this.getValueSize();i-Math.floor(i)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var t=this.times,r=this.values,n=t.length;n===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==n;o++){var s=t[o];if(typeof s=="number"&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(a!==null&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(r!==void 0&&Ke.isTypedArray(r))for(var l=0,c=r.length;l!==c;++l){var h=r[l];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,h),e=!1;break}}return e},optimize:function(){for(var e=Ke.arraySlice(this.times),i=Ke.arraySlice(this.values),t=this.getValueSize(),r=this.getInterpolation()===Ya,n=e.length-1,a=1,o=1;o<n;++o){var s=!1,l=e[o],c=e[o+1];if(l!==c&&(o!==1||l!==l[0]))if(r)s=!0;else for(var h=o*t,u=h-t,p=h+t,d=0;d!==t;++d){var m=i[h+d];if(m!==i[u+d]||m!==i[p+d]){s=!0;break}}if(s){if(o!==a){e[a]=e[o];for(var g=o*t,b=a*t,v=0;v!==t;++v)i[b+v]=i[g+v]}++a}}if(n>0){e[a]=e[n];for(var f=n*t,M=a*t,_=0;_!==t;++_)i[M+_]=i[f+_];++a}return a!==e.length?(this.times=Ke.arraySlice(e,0,a),this.values=Ke.arraySlice(i,0,a*t)):(this.times=e,this.values=i),this},clone:function(){var e=Ke.arraySlice(this.times,0),i=Ke.arraySlice(this.values,0),t=this.constructor,r=new t(this.name,e,i);return r.createInterpolant=this.createInterpolant,r}});function ko(e,i,t){bt.call(this,e,i,t)}ko.prototype=Object.assign(Object.create(bt.prototype),{constructor:ko,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Wn,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Vo(e,i,t,r){bt.call(this,e,i,t,r)}Vo.prototype=Object.assign(Object.create(bt.prototype),{constructor:Vo,ValueTypeName:"color"});function Tn(e,i,t,r){bt.call(this,e,i,t,r)}Tn.prototype=Object.assign(Object.create(bt.prototype),{constructor:Tn,ValueTypeName:"number"});function Wo(e,i,t,r){Ht.call(this,e,i,t,r)}Wo.prototype=Object.assign(Object.create(Ht.prototype),{constructor:Wo,interpolate_:function(e,i,t,r){for(var n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(t-i)/(r-i),l=e*o,c=l+o;l!==c;l+=4)_t.slerpFlat(n,0,a,l-o,a,l,s);return n}});function Ia(e,i,t,r){bt.call(this,e,i,t,r)}Ia.prototype=Object.assign(Object.create(bt.prototype),{constructor:Ia,ValueTypeName:"quaternion",DefaultInterpolation:jn,InterpolantFactoryMethodLinear:function(e){return new Wo(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0});function jo(e,i,t,r){bt.call(this,e,i,t,r)}jo.prototype=Object.assign(Object.create(bt.prototype),{constructor:jo,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Wn,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function En(e,i,t,r){bt.call(this,e,i,t,r)}En.prototype=Object.assign(Object.create(bt.prototype),{constructor:En,ValueTypeName:"vector"});function kt(e,i,t,r){i===void 0&&(i=-1),r===void 0&&(r=Za),this.name=e,this.tracks=t,this.duration=i,this.blendMode=r,this.uuid=be.generateUUID(),this.duration<0&&this.resetDuration()}function U0(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Tn;case"vector":case"vector2":case"vector3":case"vector4":return En;case"color":return Vo;case"quaternion":return Ia;case"bool":case"boolean":return ko;case"string":return jo}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function F0(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var i=U0(e.type);if(e.times===void 0){var t=[],r=[];Ke.flattenJSON(e.keys,t,r,"value"),e.times=t,e.values=r}return i.parse!==void 0?i.parse(e):new i(e.name,e.times,e.values,e.interpolation)}Object.assign(kt,{parse:function(e){for(var i=[],t=e.tracks,r=1/(e.fps||1),n=0,a=t.length;n!==a;++n)i.push(F0(t[n]).scale(r));var o=new kt(e.name,e.duration,i,e.blendMode);return o.uuid=e.uuid,o},toJSON:function(e){for(var i=[],t=e.tracks,r={name:e.name,duration:e.duration,tracks:i,uuid:e.uuid,blendMode:e.blendMode},n=0,a=t.length;n!==a;++n)i.push(bt.toJSON(t[n]));return r},CreateFromMorphTargetSequence:function(e,i,t,r){for(var n=i.length,a=[],o=0;o<n;o++){var s=[],l=[];s.push((o+n-1)%n,o,(o+1)%n),l.push(0,1,0);var c=Ke.getKeyframeOrder(s);s=Ke.sortedArray(s,1,c),l=Ke.sortedArray(l,1,c),!r&&s[0]===0&&(s.push(n),l.push(l[0])),a.push(new Tn(".morphTargetInfluences["+i[o].name+"]",s,l).scale(1/t))}return new kt(e,-1,a)},findByName:function(e,i){var t=e;if(!Array.isArray(e)){var r=e;t=r.geometry&&r.geometry.animations||r.animations}for(var n=0;n<t.length;n++)if(t[n].name===i)return t[n];return null},CreateClipsFromMorphTargetSequences:function(e,i,t){for(var r={},n=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],l=s.name.match(n);if(l&&l.length>1){var c=l[1],h=r[c];h||(r[c]=h=[]),h.push(s)}}var u=[];for(var p in r)u.push(kt.CreateFromMorphTargetSequence(p,r[p],i,t));return u},parseAnimation:function(e,i){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var t=function(w,x,S,A,I){if(S.length!==0){var P=[],R=[];Ke.flattenJSON(S,P,R,A),P.length!==0&&I.push(new w(x,P,R))}},r=[],n=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,l=e.hierarchy||[],c=0;c<l.length;c++){var h=l[c].keys;if(!(!h||h.length===0))if(h[0].morphTargets){var u={},p=void 0;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(var d=0;d<h[p].morphTargets.length;d++)u[h[p].morphTargets[d]]=-1;for(var m in u){for(var g=[],b=[],v=0;v!==h[p].morphTargets.length;++v){var f=h[p];g.push(f.time),b.push(f.morphTarget===m?1:0)}r.push(new Tn(".morphTargetInfluence["+m+"]",g,b))}s=u.length*(a||1)}else{var M=".bones["+i[c].name+"]";t(En,M+".position",h,"pos",r),t(Ia,M+".quaternion",h,"rot",r),t(En,M+".scale",h,"scl",r)}}if(r.length===0)return null;var _=new kt(n,s,r,o);return _}}),Object.assign(kt.prototype,{resetDuration:function(){for(var e=this.tracks,i=0,t=0,r=e.length;t!==r;++t){var n=this.tracks[t];i=Math.max(i,n.times[n.times.length-1])}return this.duration=i,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,i=0;i<this.tracks.length;i++)e=e&&this.tracks[i].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());return new kt(this.name,this.duration,e,this.blendMode)},toJSON:function(){return kt.toJSON(this)}});var Ni={enabled:!1,files:{},add:function(e,i){this.enabled!==!1&&(this.files[e]=i)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Hl(e,i,t){var r=this,n=!1,a=0,o=0,s=void 0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=t,this.itemStart=function(c){o++,n===!1&&r.onStart!==void 0&&r.onStart(c,a,o),n=!0},this.itemEnd=function(c){a++,r.onProgress!==void 0&&r.onProgress(c,a,o),a===o&&(n=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(c){r.onError!==void 0&&r.onError(c)},this.resolveURL=function(c){return s?s(c):c},this.setURLModifier=function(c){return s=c,this},this.addHandler=function(c,h){return l.push(c,h),this},this.removeHandler=function(c){var h=l.indexOf(c);return h!==-1&&l.splice(h,2),this},this.getHandler=function(c){for(var h=0,u=l.length;h<u;h+=2){var p=l[h],d=l[h+1];if(p.global&&(p.lastIndex=0),p.test(c))return d}return null}}var Td=new Hl;function ke(e){this.manager=e!==void 0?e:Td,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(ke.prototype,{load:function(){},loadAsync:function(e,i){var t=this;return new Promise(function(r,n){t.load(e,r,i,n)})},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var ir={};function Zt(e){ke.call(this,e)}Zt.prototype=Object.assign(Object.create(ke.prototype),{constructor:Zt,load:function(e,i,t,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var n=this,a=Ni.get(e);if(a!==void 0)return n.manager.itemStart(e),setTimeout(function(){i&&i(a),n.manager.itemEnd(e)},0),a;if(ir[e]!==void 0){ir[e].push({onLoad:i,onProgress:t,onError:r});return}var o=/^data:(.*?)(;base64)?,(.*)$/,s=e.match(o),l;if(s){var c=s[1],h=!!s[2],u=s[3];u=decodeURIComponent(u),h&&(u=atob(u));try{var p,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var m=new Uint8Array(u.length),g=0;g<u.length;g++)m[g]=u.charCodeAt(g);d==="blob"?p=new Blob([m.buffer],{type:c}):p=m.buffer;break;case"document":var b=new DOMParser;p=b.parseFromString(u,c);break;case"json":p=JSON.parse(u);break;default:p=u;break}setTimeout(function(){i&&i(p),n.manager.itemEnd(e)},0)}catch(f){setTimeout(function(){r&&r(f),n.manager.itemError(e),n.manager.itemEnd(e)},0)}}else{ir[e]=[],ir[e].push({onLoad:i,onProgress:t,onError:r}),l=new XMLHttpRequest,l.open("GET",e,!0),l.addEventListener("load",function(f){var M=this.response,_=ir[e];if(delete ir[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ni.add(e,M);for(var w=0,x=_.length;w<x;w++){var S=_[w];S.onLoad&&S.onLoad(M)}n.manager.itemEnd(e)}else{for(var A=0,I=_.length;A<I;A++){var P=_[A];P.onError&&P.onError(f)}n.manager.itemError(e),n.manager.itemEnd(e)}},!1),l.addEventListener("progress",function(f){for(var M=ir[e],_=0,w=M.length;_<w;_++){var x=M[_];x.onProgress&&x.onProgress(f)}},!1),l.addEventListener("error",function(f){var M=ir[e];delete ir[e];for(var _=0,w=M.length;_<w;_++){var x=M[_];x.onError&&x.onError(f)}n.manager.itemError(e),n.manager.itemEnd(e)},!1),l.addEventListener("abort",function(f){var M=ir[e];delete ir[e];for(var _=0,w=M.length;_<w;_++){var x=M[_];x.onError&&x.onError(f)}n.manager.itemError(e),n.manager.itemEnd(e)},!1),this.responseType!==void 0&&(l.responseType=this.responseType),this.withCredentials!==void 0&&(l.withCredentials=this.withCredentials),l.overrideMimeType&&l.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var v in this.requestHeader)l.setRequestHeader(v,this.requestHeader[v]);l.send(null)}return n.manager.itemStart(e),l},setResponseType:function(e){return this.responseType=e,this},setMimeType:function(e){return this.mimeType=e,this}});function kl(e){ke.call(this,e)}kl.prototype=Object.assign(Object.create(ke.prototype),{constructor:kl,load:function(e,i,t,r){var n=this,a=new Zt(n.manager);a.setPath(n.path),a.setRequestHeader(n.requestHeader),a.setWithCredentials(n.withCredentials),a.load(e,function(o){try{i(n.parse(JSON.parse(o)))}catch(s){r?r(s):console.error(s),n.manager.itemError(e)}},t,r)},parse:function(e){for(var i=[],t=0;t<e.length;t++){var r=kt.parse(e[t]);i.push(r)}return i}});function Vl(e){ke.call(this,e)}Vl.prototype=Object.assign(Object.create(ke.prototype),{constructor:Vl,load:function(e,i,t,r){var n=this,a=[],o=new _n,s=new Zt(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(n.withCredentials);var l=0;function c(p){s.load(e[p],function(d){var m=n.parse(d,!0);a[p]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps},l+=1,l===6&&(m.mipmapCount===1&&(o.minFilter=mt),o.image=a,o.format=m.format,o.needsUpdate=!0,i&&i(o))},t,r)}if(Array.isArray(e))for(var h=0,u=e.length;h<u;++h)c(h);else s.load(e,function(p){var d=n.parse(p,!0);if(d.isCubemap){for(var m=d.mipmaps.length/d.mipmapCount,g=0;g<m;g++){a[g]={mipmaps:[]};for(var b=0;b<d.mipmapCount;b++)a[g].mipmaps.push(d.mipmaps[g*d.mipmapCount+b]),a[g].format=d.format,a[g].width=d.width,a[g].height=d.height}o.image=a}else o.image.width=d.width,o.image.height=d.height,o.mipmaps=d.mipmaps;d.mipmapCount===1&&(o.minFilter=mt),o.format=d.format,o.needsUpdate=!0,i&&i(o)},t,r);return o}});function An(e){ke.call(this,e)}An.prototype=Object.assign(Object.create(ke.prototype),{constructor:An,load:function(e,i,t,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var n=this,a=Ni.get(e);if(a!==void 0)return n.manager.itemStart(e),setTimeout(function(){i&&i(a),n.manager.itemEnd(e)},0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),Ni.add(e,this),i&&i(this),n.manager.itemEnd(e)}function l(c){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),r&&r(c),n.manager.itemError(e),n.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),n.manager.itemStart(e),o.src=e,o}});function qo(e){ke.call(this,e)}qo.prototype=Object.assign(Object.create(ke.prototype),{constructor:qo,load:function(e,i,t,r){var n=new mr,a=new An(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(c){a.load(e[c],function(h){n.images[c]=h,o++,o===6&&(n.needsUpdate=!0,i&&i(n))},void 0,r)}for(var l=0;l<e.length;++l)s(l);return n}});function Xo(e){ke.call(this,e)}Xo.prototype=Object.assign(Object.create(ke.prototype),{constructor:Xo,load:function(e,i,t,r){var n=this,a=new Nr,o=new Zt(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(n.withCredentials),o.load(e,function(s){var l=n.parse(s);!l||(l.image!==void 0?a.image=l.image:l.data!==void 0&&(a.image.width=l.width,a.image.height=l.height,a.image.data=l.data),a.wrapS=l.wrapS!==void 0?l.wrapS:At,a.wrapT=l.wrapT!==void 0?l.wrapT:At,a.magFilter=l.magFilter!==void 0?l.magFilter:mt,a.minFilter=l.minFilter!==void 0?l.minFilter:mt,a.anisotropy=l.anisotropy!==void 0?l.anisotropy:1,l.format!==void 0&&(a.format=l.format),l.type!==void 0&&(a.type=l.type),l.mipmaps!==void 0&&(a.mipmaps=l.mipmaps,a.minFilter=Wi),l.mipmapCount===1&&(a.minFilter=mt),a.needsUpdate=!0,i&&i(a,l))},t,r),a}});function Yo(e){ke.call(this,e)}Yo.prototype=Object.assign(Object.create(ke.prototype),{constructor:Yo,load:function(e,i,t,r){var n=new Ve,a=new An(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){n.image=o;var s=e.search(/\.jpe?g($|\?)/i)>0||e.search(/^data\:image\/jpeg/)===0;n.format=s?Hr:Dt,n.needsUpdate=!0,i!==void 0&&i(n)},t,r),n}});function de(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(de.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,i){var t=this.getUtoTmapping(e);return this.getPoint(t,i)},getPoints:function(e){e===void 0&&(e=5);for(var i=[],t=0;t<=e;t++)i.push(this.getPoint(t/e));return i},getSpacedPoints:function(e){e===void 0&&(e=5);for(var i=[],t=0;t<=e;t++)i.push(this.getPointAt(t/e));return i},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===void 0&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var i=[],t,r=this.getPoint(0),n=0;i.push(0);for(var a=1;a<=e;a++)t=this.getPoint(a/e),n+=t.distanceTo(r),i.push(n),r=t;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,i){var t=this.getLengths(),r=0,n=t.length,a;i?a=i:a=e*t[n-1];for(var o=0,s=n-1,l;o<=s;)if(r=Math.floor(o+(s-o)/2),l=t[r]-a,l<0)o=r+1;else if(l>0)s=r-1;else{s=r;break}if(r=s,t[r]===a)return r/(n-1);var c=t[r],h=t[r+1],u=h-c,p=(a-c)/u,d=(r+p)/(n-1);return d},getTangent:function(e,i){var t=1e-4,r=e-t,n=e+t;r<0&&(r=0),n>1&&(n=1);var a=this.getPoint(r),o=this.getPoint(n),s=i||(a.isVector2?new X:new T);return s.copy(o).sub(a).normalize(),s},getTangentAt:function(e,i){var t=this.getUtoTmapping(e);return this.getTangent(t,i)},computeFrenetFrames:function(e,i){for(var t=new T,r=[],n=[],a=[],o=new T,s=new Te,l=0;l<=e;l++){var c=l/e;r[l]=this.getTangentAt(c,new T),r[l].normalize()}n[0]=new T,a[0]=new T;var h=Number.MAX_VALUE,u=Math.abs(r[0].x),p=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=h&&(h=u,t.set(1,0,0)),p<=h&&(h=p,t.set(0,1,0)),d<=h&&t.set(0,0,1),o.crossVectors(r[0],t).normalize(),n[0].crossVectors(r[0],o),a[0].crossVectors(r[0],n[0]);for(var m=1;m<=e;m++){if(n[m]=n[m-1].clone(),a[m]=a[m-1].clone(),o.crossVectors(r[m-1],r[m]),o.length()>Number.EPSILON){o.normalize();var g=Math.acos(be.clamp(r[m-1].dot(r[m]),-1,1));n[m].applyMatrix4(s.makeRotationAxis(o,g))}a[m].crossVectors(r[m],n[m])}if(i===!0){var b=Math.acos(be.clamp(n[0].dot(n[e]),-1,1));b/=e,r[0].dot(o.crossVectors(n[0],n[e]))>0&&(b=-b);for(var v=1;v<=e;v++)n[v].applyMatrix4(s.makeRotationAxis(r[v],b*v)),a[v].crossVectors(r[v],n[v])}return{tangents:r,normals:n,binormals:a}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});function Vt(e,i,t,r,n,a,o,s){de.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=i||0,this.xRadius=t||1,this.yRadius=r||1,this.aStartAngle=n||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}Vt.prototype=Object.create(de.prototype),Vt.prototype.constructor=Vt,Vt.prototype.isEllipseCurve=!0,Vt.prototype.getPoint=function(e,i){for(var t=i||new X,r=Math.PI*2,n=this.aEndAngle-this.aStartAngle,a=Math.abs(n)<Number.EPSILON;n<0;)n+=r;for(;n>r;)n-=r;n<Number.EPSILON&&(a?n=0:n=r),this.aClockwise===!0&&!a&&(n===r?n=-r:n=n-r);var o=this.aStartAngle+e*n,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){var c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),u=s-this.aX,p=l-this.aY;s=u*c-p*h+this.aX,l=u*h+p*c+this.aY}return t.set(s,l)},Vt.prototype.copy=function(e){return de.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Vt.prototype.toJSON=function(){var e=de.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Vt.prototype.fromJSON=function(e){return de.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this};function Ln(e,i,t,r,n,a){Vt.call(this,e,i,t,t,r,n,a),this.type="ArcCurve"}Ln.prototype=Object.create(Vt.prototype),Ln.prototype.constructor=Ln,Ln.prototype.isArcCurve=!0;function Wl(){var e=0,i=0,t=0,r=0;function n(a,o,s,l){e=a,i=s,t=-3*a+3*o-2*s-l,r=2*a-2*o+s+l}return{initCatmullRom:function(a,o,s,l,c){n(o,s,c*(s-a),c*(l-o))},initNonuniformCatmullRom:function(a,o,s,l,c,h,u){var p=(o-a)/c-(s-a)/(c+h)+(s-o)/h,d=(s-o)/h-(l-o)/(h+u)+(l-s)/u;p*=h,d*=h,n(o,s,p,d)},calc:function(a){var o=a*a,s=o*a;return e+i*a+t*o+r*s}}}var Zo=new T,jl=new Wl,ql=new Wl,Xl=new Wl;function Mt(e,i,t,r){e===void 0&&(e=[]),i===void 0&&(i=!1),t===void 0&&(t="centripetal"),r===void 0&&(r=.5),de.call(this),this.type="CatmullRomCurve3",this.points=e,this.closed=i,this.curveType=t,this.tension=r}Mt.prototype=Object.create(de.prototype),Mt.prototype.constructor=Mt,Mt.prototype.isCatmullRomCurve3=!0,Mt.prototype.getPoint=function(e,i){i===void 0&&(i=new T);var t=i,r=this.points,n=r.length,a=(n-(this.closed?0:1))*e,o=Math.floor(a),s=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/n)+1)*n:s===0&&o===n-1&&(o=n-2,s=1);var l,c;this.closed||o>0?l=r[(o-1)%n]:(Zo.subVectors(r[0],r[1]).add(r[0]),l=Zo);var h=r[o%n],u=r[(o+1)%n];if(this.closed||o+2<n?c=r[(o+2)%n]:(Zo.subVectors(r[n-1],r[n-2]).add(r[n-1]),c=Zo),this.curveType==="centripetal"||this.curveType==="chordal"){var p=this.curveType==="chordal"?.5:.25,d=Math.pow(l.distanceToSquared(h),p),m=Math.pow(h.distanceToSquared(u),p),g=Math.pow(u.distanceToSquared(c),p);m<1e-4&&(m=1),d<1e-4&&(d=m),g<1e-4&&(g=m),jl.initNonuniformCatmullRom(l.x,h.x,u.x,c.x,d,m,g),ql.initNonuniformCatmullRom(l.y,h.y,u.y,c.y,d,m,g),Xl.initNonuniformCatmullRom(l.z,h.z,u.z,c.z,d,m,g)}else this.curveType==="catmullrom"&&(jl.initCatmullRom(l.x,h.x,u.x,c.x,this.tension),ql.initCatmullRom(l.y,h.y,u.y,c.y,this.tension),Xl.initCatmullRom(l.z,h.z,u.z,c.z,this.tension));return t.set(jl.calc(s),ql.calc(s),Xl.calc(s)),t},Mt.prototype.copy=function(e){de.prototype.copy.call(this,e),this.points=[];for(var i=0,t=e.points.length;i<t;i++){var r=e.points[i];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Mt.prototype.toJSON=function(){var e=de.prototype.toJSON.call(this);e.points=[];for(var i=0,t=this.points.length;i<t;i++){var r=this.points[i];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Mt.prototype.fromJSON=function(e){de.prototype.fromJSON.call(this,e),this.points=[];for(var i=0,t=e.points.length;i<t;i++){var r=e.points[i];this.points.push(new T().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this};function Ed(e,i,t,r,n){var a=(r-i)*.5,o=(n-t)*.5,s=e*e,l=e*s;return(2*t-2*r+a+o)*l+(-3*t+3*r-2*a-o)*s+a*e+t}function G0(e,i){var t=1-e;return t*t*i}function H0(e,i){return 2*(1-e)*e*i}function k0(e,i){return e*e*i}function Da(e,i,t,r){return G0(e,i)+H0(e,t)+k0(e,r)}function V0(e,i){var t=1-e;return t*t*t*i}function W0(e,i){var t=1-e;return 3*t*t*e*i}function j0(e,i){return 3*(1-e)*e*e*i}function q0(e,i){return e*e*e*i}function Ba(e,i,t,r,n){return V0(e,i)+W0(e,t)+j0(e,r)+q0(e,n)}function nr(e,i,t,r){e===void 0&&(e=new X),i===void 0&&(i=new X),t===void 0&&(t=new X),r===void 0&&(r=new X),de.call(this),this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=t,this.v3=r}nr.prototype=Object.create(de.prototype),nr.prototype.constructor=nr,nr.prototype.isCubicBezierCurve=!0,nr.prototype.getPoint=function(e,i){i===void 0&&(i=new X);var t=i,r=this.v0,n=this.v1,a=this.v2,o=this.v3;return t.set(Ba(e,r.x,n.x,a.x,o.x),Ba(e,r.y,n.y,a.y,o.y)),t},nr.prototype.copy=function(e){return de.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},nr.prototype.toJSON=function(){var e=de.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},nr.prototype.fromJSON=function(e){return de.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this};function yr(e,i,t,r){e===void 0&&(e=new T),i===void 0&&(i=new T),t===void 0&&(t=new T),r===void 0&&(r=new T),de.call(this),this.type="CubicBezierCurve3",this.v0=e,this.v1=i,this.v2=t,this.v3=r}yr.prototype=Object.create(de.prototype),yr.prototype.constructor=yr,yr.prototype.isCubicBezierCurve3=!0,yr.prototype.getPoint=function(e,i){i===void 0&&(i=new T);var t=i,r=this.v0,n=this.v1,a=this.v2,o=this.v3;return t.set(Ba(e,r.x,n.x,a.x,o.x),Ba(e,r.y,n.y,a.y,o.y),Ba(e,r.z,n.z,a.z,o.z)),t},yr.prototype.copy=function(e){return de.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},yr.prototype.toJSON=function(){var e=de.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},yr.prototype.fromJSON=function(e){return de.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this};function It(e,i){e===void 0&&(e=new X),i===void 0&&(i=new X),de.call(this),this.type="LineCurve",this.v1=e,this.v2=i}It.prototype=Object.create(de.prototype),It.prototype.constructor=It,It.prototype.isLineCurve=!0,It.prototype.getPoint=function(e,i){i===void 0&&(i=new X);var t=i;return e===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},It.prototype.getPointAt=function(e,i){return this.getPoint(e,i)},It.prototype.getTangent=function(e,i){var t=i||new X;return t.copy(this.v2).sub(this.v1).normalize(),t},It.prototype.copy=function(e){return de.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},It.prototype.toJSON=function(){var e=de.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},It.prototype.fromJSON=function(e){return de.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function ar(e,i){e===void 0&&(e=new T),i===void 0&&(i=new T),de.call(this),this.type="LineCurve3",this.v1=e,this.v2=i}ar.prototype=Object.create(de.prototype),ar.prototype.constructor=ar,ar.prototype.isLineCurve3=!0,ar.prototype.getPoint=function(e,i){i===void 0&&(i=new T);var t=i;return e===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},ar.prototype.getPointAt=function(e,i){return this.getPoint(e,i)},ar.prototype.copy=function(e){return de.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ar.prototype.toJSON=function(){var e=de.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ar.prototype.fromJSON=function(e){return de.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function or(e,i,t){e===void 0&&(e=new X),i===void 0&&(i=new X),t===void 0&&(t=new X),de.call(this),this.type="QuadraticBezierCurve",this.v0=e,this.v1=i,this.v2=t}or.prototype=Object.create(de.prototype),or.prototype.constructor=or,or.prototype.isQuadraticBezierCurve=!0,or.prototype.getPoint=function(e,i){i===void 0&&(i=new X);var t=i,r=this.v0,n=this.v1,a=this.v2;return t.set(Da(e,r.x,n.x,a.x),Da(e,r.y,n.y,a.y)),t},or.prototype.copy=function(e){return de.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},or.prototype.toJSON=function(){var e=de.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},or.prototype.fromJSON=function(e){return de.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function xr(e,i,t){e===void 0&&(e=new T),i===void 0&&(i=new T),t===void 0&&(t=new T),de.call(this),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=i,this.v2=t}xr.prototype=Object.create(de.prototype),xr.prototype.constructor=xr,xr.prototype.isQuadraticBezierCurve3=!0,xr.prototype.getPoint=function(e,i){i===void 0&&(i=new T);var t=i,r=this.v0,n=this.v1,a=this.v2;return t.set(Da(e,r.x,n.x,a.x),Da(e,r.y,n.y,a.y),Da(e,r.z,n.z,a.z)),t},xr.prototype.copy=function(e){return de.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},xr.prototype.toJSON=function(){var e=de.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},xr.prototype.fromJSON=function(e){return de.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function sr(e){e===void 0&&(e=[]),de.call(this),this.type="SplineCurve",this.points=e}sr.prototype=Object.create(de.prototype),sr.prototype.constructor=sr,sr.prototype.isSplineCurve=!0,sr.prototype.getPoint=function(e,i){i===void 0&&(i=new X);var t=i,r=this.points,n=(r.length-1)*e,a=Math.floor(n),o=n-a,s=r[a===0?a:a-1],l=r[a],c=r[a>r.length-2?r.length-1:a+1],h=r[a>r.length-3?r.length-1:a+2];return t.set(Ed(o,s.x,l.x,c.x,h.x),Ed(o,s.y,l.y,c.y,h.y)),t},sr.prototype.copy=function(e){de.prototype.copy.call(this,e),this.points=[];for(var i=0,t=e.points.length;i<t;i++){var r=e.points[i];this.points.push(r.clone())}return this},sr.prototype.toJSON=function(){var e=de.prototype.toJSON.call(this);e.points=[];for(var i=0,t=this.points.length;i<t;i++){var r=this.points[i];e.points.push(r.toArray())}return e},sr.prototype.fromJSON=function(e){de.prototype.fromJSON.call(this,e),this.points=[];for(var i=0,t=e.points.length;i<t;i++){var r=e.points[i];this.points.push(new X().fromArray(r))}return this};var Yl=Object.freeze({__proto__:null,ArcCurve:Ln,CatmullRomCurve3:Mt,CubicBezierCurve:nr,CubicBezierCurve3:yr,EllipseCurve:Vt,LineCurve:It,LineCurve3:ar,QuadraticBezierCurve:or,QuadraticBezierCurve3:xr,SplineCurve:sr});function Dr(){de.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}Dr.prototype=Object.assign(Object.create(de.prototype),{constructor:Dr,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);e.equals(i)||this.curves.push(new It(i,e))},getPoint:function(e){for(var i=e*this.getLength(),t=this.getCurveLengths(),r=0;r<t.length;){if(t[r]>=i){var n=t[r]-i,a=this.curves[r],o=a.getLength(),s=o===0?0:1-n/o;return a.getPointAt(s)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],i=0,t=0,r=this.curves.length;t<r;t++)i+=this.curves[t].getLength(),e.push(i);return this.cacheLengths=e,e},getSpacedPoints:function(e){e===void 0&&(e=40);for(var i=[],t=0;t<=e;t++)i.push(this.getPoint(t/e));return this.autoClose&&i.push(i[0]),i},getPoints:function(e){e===void 0&&(e=12);for(var i=[],t,r=0,n=this.curves;r<n.length;r++)for(var a=n[r],o=a&&a.isEllipseCurve?e*2:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o),l=0;l<s.length;l++){var c=s[l];t&&t.equals(c)||(i.push(c),t=c)}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(e){de.prototype.copy.call(this,e),this.curves=[];for(var i=0,t=e.curves.length;i<t;i++){var r=e.curves[i];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=de.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var i=0,t=this.curves.length;i<t;i++){var r=this.curves[i];e.curves.push(r.toJSON())}return e},fromJSON:function(e){de.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var i=0,t=e.curves.length;i<t;i++){var r=e.curves[i];this.curves.push(new Yl[r.type]().fromJSON(r))}return this}});function lr(e){Dr.call(this),this.type="Path",this.currentPoint=new X,e&&this.setFromPoints(e)}lr.prototype=Object.assign(Object.create(Dr.prototype),{constructor:lr,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var i=1,t=e.length;i<t;i++)this.lineTo(e[i].x,e[i].y);return this},moveTo:function(e,i){return this.currentPoint.set(e,i),this},lineTo:function(e,i){var t=new It(this.currentPoint.clone(),new X(e,i));return this.curves.push(t),this.currentPoint.set(e,i),this},quadraticCurveTo:function(e,i,t,r){var n=new or(this.currentPoint.clone(),new X(e,i),new X(t,r));return this.curves.push(n),this.currentPoint.set(t,r),this},bezierCurveTo:function(e,i,t,r,n,a){var o=new nr(this.currentPoint.clone(),new X(e,i),new X(t,r),new X(n,a));return this.curves.push(o),this.currentPoint.set(n,a),this},splineThru:function(e){var i=[this.currentPoint.clone()].concat(e),t=new sr(i);return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,i,t,r,n,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,i+s,t,r,n,a),this},absarc:function(e,i,t,r,n,a){return this.absellipse(e,i,t,t,r,n,a),this},ellipse:function(e,i,t,r,n,a,o,s){var l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,i+c,t,r,n,a,o,s),this},absellipse:function(e,i,t,r,n,a,o,s){var l=new Vt(e,i,t,r,n,a,o,s);if(this.curves.length>0){var c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);var h=l.getPoint(1);return this.currentPoint.copy(h),this},copy:function(e){return Dr.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Dr.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Dr.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}});function ni(e){lr.call(this,e),this.uuid=be.generateUUID(),this.type="Shape",this.holes=[]}ni.prototype=Object.assign(Object.create(lr.prototype),{constructor:ni,getPointsHoles:function(e){for(var i=[],t=0,r=this.holes.length;t<r;t++)i[t]=this.holes[t].getPoints(e);return i},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){lr.prototype.copy.call(this,e),this.holes=[];for(var i=0,t=e.holes.length;i<t;i++){var r=e.holes[i];this.holes.push(r.clone())}return this},toJSON:function(){var e=lr.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var i=0,t=this.holes.length;i<t;i++){var r=this.holes[i];e.holes.push(r.toJSON())}return e},fromJSON:function(e){lr.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var i=0,t=e.holes.length;i<t;i++){var r=e.holes[i];this.holes.push(new lr().fromJSON(r))}return this}});function Ye(e,i){i===void 0&&(i=1),se.call(this),this.type="Light",this.color=new ie(e),this.intensity=i}Ye.prototype=Object.assign(Object.create(se.prototype),{constructor:Ye,isLight:!0,copy:function(e){return se.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var i=se.prototype.toJSON.call(this,e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}});function Jo(e,i,t){Ye.call(this,e,t),this.type="HemisphereLight",this.position.copy(se.DefaultUp),this.updateMatrix(),this.groundColor=new ie(i)}Jo.prototype=Object.assign(Object.create(Ye.prototype),{constructor:Jo,isHemisphereLight:!0,copy:function(e){return Ye.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}});function Br(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new X(512,512),this.map=null,this.mapPass=null,this.matrix=new Te,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ha,this._frameExtents=new X(1,1),this._viewportCount=1,this._viewports=[new We(0,0,1,1)]}Object.assign(Br.prototype,{_projScreenMatrix:new Te,_lightPositionWorld:new T,_lookTarget:new T,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var i=this.camera,t=this.matrix,r=this._projScreenMatrix,n=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(e.matrixWorld),i.position.copy(a),n.setFromMatrixPosition(e.target.matrixWorld),i.lookAt(n),i.updateMatrixWorld(),r.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),t.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),t.multiply(i.projectionMatrix),t.multiply(i.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}});function Zl(){Br.call(this,new ct(50,1,.5,500)),this.focus=1}Zl.prototype=Object.assign(Object.create(Br.prototype),{constructor:Zl,isSpotLightShadow:!0,updateMatrices:function(e){var i=this.camera,t=be.RAD2DEG*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,n=e.distance||i.far;(t!==i.fov||r!==i.aspect||n!==i.far)&&(i.fov=t,i.aspect=r,i.far=n,i.updateProjectionMatrix()),Br.prototype.updateMatrices.call(this,e)}});function Ko(e,i,t,r,n,a){Ye.call(this,e,i),this.type="SpotLight",this.position.copy(se.DefaultUp),this.updateMatrix(),this.target=new se,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(o){this.intensity=o/Math.PI}}),this.distance=t!==void 0?t:0,this.angle=r!==void 0?r:Math.PI/3,this.penumbra=n!==void 0?n:0,this.decay=a!==void 0?a:1,this.shadow=new Zl}Ko.prototype=Object.assign(Object.create(Ye.prototype),{constructor:Ko,isSpotLight:!0,copy:function(e){return Ye.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function Jl(){Br.call(this,new ct(90,1,.5,500)),this._frameExtents=new X(4,2),this._viewportCount=6,this._viewports=[new We(2,1,1,1),new We(0,1,1,1),new We(3,1,1,1),new We(1,1,1,1),new We(3,0,1,1),new We(1,0,1,1)],this._cubeDirections=[new T(1,0,0),new T(-1,0,0),new T(0,0,1),new T(0,0,-1),new T(0,1,0),new T(0,-1,0)],this._cubeUps=[new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,0,1),new T(0,0,-1)]}Jl.prototype=Object.assign(Object.create(Br.prototype),{constructor:Jl,isPointLightShadow:!0,updateMatrices:function(e,i){i===void 0&&(i=0);var t=this.camera,r=this.matrix,n=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;n.setFromMatrixPosition(e.matrixWorld),t.position.copy(n),a.copy(t.position),a.add(this._cubeDirections[i]),t.up.copy(this._cubeUps[i]),t.lookAt(a),t.updateMatrixWorld(),r.makeTranslation(-n.x,-n.y,-n.z),o.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}});function Qo(e,i,t,r){Ye.call(this,e,i),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(n){this.intensity=n/(4*Math.PI)}}),this.distance=t!==void 0?t:0,this.decay=r!==void 0?r:1,this.shadow=new Jl}Qo.prototype=Object.assign(Object.create(Ye.prototype),{constructor:Qo,isPointLight:!0,copy:function(e){return Ye.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}});function Rn(e,i,t,r,n,a){e===void 0&&(e=-1),i===void 0&&(i=1),t===void 0&&(t=1),r===void 0&&(r=-1),n===void 0&&(n=.1),a===void 0&&(a=2e3),fr.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=t,this.bottom=r,this.near=n,this.far=a,this.updateProjectionMatrix()}Rn.prototype=Object.assign(Object.create(fr.prototype),{constructor:Rn,isOrthographicCamera:!0,copy:function(e,i){return fr.prototype.copy.call(this,e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this},setViewOffset:function(e,i,t,r,n,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=t,this.view.offsetY=r,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),t=(this.right+this.left)/2,r=(this.top+this.bottom)/2,n=t-e,a=t+e,o=r+i,s=r-i;if(this.view!==null&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=l*this.view.offsetX,a=n+l*this.view.width,o-=c*this.view.offsetY,s=o-c*this.view.height}this.projectionMatrix.makeOrthographic(n,a,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(e){var i=se.prototype.toJSON.call(this,e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}});function Kl(){Br.call(this,new Rn(-5,5,5,-5,.5,500))}Kl.prototype=Object.assign(Object.create(Br.prototype),{constructor:Kl,isDirectionalLightShadow:!0,updateMatrices:function(e){Br.prototype.updateMatrices.call(this,e)}});function $o(e,i){Ye.call(this,e,i),this.type="DirectionalLight",this.position.copy(se.DefaultUp),this.updateMatrix(),this.target=new se,this.shadow=new Kl}$o.prototype=Object.assign(Object.create(Ye.prototype),{constructor:$o,isDirectionalLight:!0,copy:function(e){return Ye.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function es(e,i){Ye.call(this,e,i),this.type="AmbientLight"}es.prototype=Object.assign(Object.create(Ye.prototype),{constructor:es,isAmbientLight:!0});function ts(e,i,t,r){Ye.call(this,e,i),this.type="RectAreaLight",this.width=t!==void 0?t:10,this.height=r!==void 0?r:10}ts.prototype=Object.assign(Object.create(Ye.prototype),{constructor:ts,isRectAreaLight:!0,copy:function(e){return Ye.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var i=Ye.prototype.toJSON.call(this,e);return i.object.width=this.width,i.object.height=this.height,i}});var Ad=function(){function e(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new T)}var i=e.prototype;return i.set=function(t){for(var r=0;r<9;r++)this.coefficients[r].copy(t[r]);return this},i.zero=function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},i.getAt=function(t,r){var n=t.x,a=t.y,o=t.z,s=this.coefficients;return r.copy(s[0]).multiplyScalar(.282095),r.addScaledVector(s[1],.488603*a),r.addScaledVector(s[2],.488603*o),r.addScaledVector(s[3],.488603*n),r.addScaledVector(s[4],1.092548*(n*a)),r.addScaledVector(s[5],1.092548*(a*o)),r.addScaledVector(s[6],.315392*(3*o*o-1)),r.addScaledVector(s[7],1.092548*(n*o)),r.addScaledVector(s[8],.546274*(n*n-a*a)),r},i.getIrradianceAt=function(t,r){var n=t.x,a=t.y,o=t.z,s=this.coefficients;return r.copy(s[0]).multiplyScalar(.886227),r.addScaledVector(s[1],2*.511664*a),r.addScaledVector(s[2],2*.511664*o),r.addScaledVector(s[3],2*.511664*n),r.addScaledVector(s[4],2*.429043*n*a),r.addScaledVector(s[5],2*.429043*a*o),r.addScaledVector(s[6],.743125*o*o-.247708),r.addScaledVector(s[7],2*.429043*n*o),r.addScaledVector(s[8],.429043*(n*n-a*a)),r},i.add=function(t){for(var r=0;r<9;r++)this.coefficients[r].add(t.coefficients[r]);return this},i.addScaledSH=function(t,r){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],r);return this},i.scale=function(t){for(var r=0;r<9;r++)this.coefficients[r].multiplyScalar(t);return this},i.lerp=function(t,r){for(var n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],r);return this},i.equals=function(t){for(var r=0;r<9;r++)if(!this.coefficients[r].equals(t.coefficients[r]))return!1;return!0},i.copy=function(t){return this.set(t.coefficients)},i.clone=function(){return new this.constructor().copy(this)},i.fromArray=function(t,r){r===void 0&&(r=0);for(var n=this.coefficients,a=0;a<9;a++)n[a].fromArray(t,r+a*3);return this},i.toArray=function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);for(var n=this.coefficients,a=0;a<9;a++)n[a].toArray(t,r+a*3);return t},e.getBasisAt=function(t,r){var n=t.x,a=t.y,o=t.z;r[0]=.282095,r[1]=.488603*a,r[2]=.488603*o,r[3]=.488603*n,r[4]=1.092548*n*a,r[5]=1.092548*a*o,r[6]=.315392*(3*o*o-1),r[7]=1.092548*n*o,r[8]=.546274*(n*n-a*a)},e}();function Jt(e,i){Ye.call(this,void 0,i),this.type="LightProbe",this.sh=e!==void 0?e:new Ad}Jt.prototype=Object.assign(Object.create(Ye.prototype),{constructor:Jt,isLightProbe:!0,copy:function(e){return Ye.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){var i=Ye.prototype.toJSON.call(this,e);return i.object.sh=this.sh.toArray(),i}});function rs(e){ke.call(this,e),this.textures={}}rs.prototype=Object.assign(Object.create(ke.prototype),{constructor:rs,load:function(e,i,t,r){var n=this,a=new Zt(n.manager);a.setPath(n.path),a.setRequestHeader(n.requestHeader),a.setWithCredentials(n.withCredentials),a.load(e,function(o){try{i(n.parse(JSON.parse(o)))}catch(s){r?r(s):console.error(s),n.manager.itemError(e)}},t,r)},parse:function(e){var i=this.textures;function t(l){return i[l]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",l),i[l]}var r=new z0[e.type];if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=new ie().setHex(e.sheen)),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==1&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.skinning!==void 0&&(r.skinning=e.skinning),e.morphTargets!==void 0&&(r.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(r.morphNormals=e.morphNormals),e.dithering!==void 0&&(r.dithering=e.dithering),e.vertexTangents!==void 0&&(r.vertexTangents=e.vertexTangents),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(var n in e.uniforms){var a=e.uniforms[n];switch(r.uniforms[n]={},a.type){case"t":r.uniforms[n].value=t(a.value);break;case"c":r.uniforms[n].value=new ie().setHex(a.value);break;case"v2":r.uniforms[n].value=new X().fromArray(a.value);break;case"v3":r.uniforms[n].value=new T().fromArray(a.value);break;case"v4":r.uniforms[n].value=new We().fromArray(a.value);break;case"m3":r.uniforms[n].value=new Rt().fromArray(a.value);break;case"m4":r.uniforms[n].value=new Te().fromArray(a.value);break;default:r.uniforms[n].value=a.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(var o in e.extensions)r.extensions[o]=e.extensions[o];if(e.shading!==void 0&&(r.flatShading=e.shading===1),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=t(e.map)),e.matcap!==void 0&&(r.matcap=t(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=t(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=t(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=t(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){var s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new X().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=t(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=t(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=t(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=t(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=t(e.specularMap)),e.envMap!==void 0&&(r.envMap=t(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=t(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=t(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=t(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=t(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=t(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=t(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new X().fromArray(e.clearcoatNormalScale)),e.transmission!==void 0&&(r.transmission=e.transmission),e.transmissionMap!==void 0&&(r.transmissionMap=t(e.transmissionMap)),r},setTextures:function(e){return this.textures=e,this}});var Ql={decodeText:function(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);for(var i="",t=0,r=e.length;t<r;t++)i+=String.fromCharCode(e[t]);try{return decodeURIComponent(escape(i))}catch(n){return i}},extractUrlBase:function(e){var i=e.lastIndexOf("/");return i===-1?"./":e.substr(0,i+1)}};function za(){pe.call(this),this.type="InstancedBufferGeometry",this.instanceCount=Infinity}za.prototype=Object.assign(Object.create(pe.prototype),{constructor:za,isInstancedBufferGeometry:!0,copy:function(e){return pe.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e=pe.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}});function is(e,i,t,r){typeof t=="number"&&(r=t,t=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),fe.call(this,e,i,t),this.meshPerAttribute=r||1}is.prototype=Object.assign(Object.create(fe.prototype),{constructor:is,isInstancedBufferAttribute:!0,copy:function(e){return fe.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=fe.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}});function ns(e){ke.call(this,e)}ns.prototype=Object.assign(Object.create(ke.prototype),{constructor:ns,load:function(e,i,t,r){var n=this,a=new Zt(n.manager);a.setPath(n.path),a.setRequestHeader(n.requestHeader),a.setWithCredentials(n.withCredentials),a.load(e,function(o){try{i(n.parse(JSON.parse(o)))}catch(s){r?r(s):console.error(s),n.manager.itemError(e)}},t,r)},parse:function(e){var i={},t={};function r(U,F){if(i[F]!==void 0)return i[F];var k=U.interleavedBuffers,W=k[F],Y=n(U,W.buffer),j=sa(W.type,Y),Z=new Gt(j,W.stride);return Z.uuid=W.uuid,i[F]=Z,Z}function n(U,F){if(t[F]!==void 0)return t[F];var k=U.arrayBuffers,W=k[F],Y=new Uint32Array(W).buffer;return t[F]=Y,Y}var a=e.isInstancedBufferGeometry?new za:new pe,o=e.data.index;if(o!==void 0){var s=sa(o.type,o.array);a.setIndex(new fe(s,1))}var l=e.data.attributes;for(var c in l){var h=l[c],u=void 0;if(h.isInterleavedBufferAttribute){var p=r(e.data,h.data);u=new $r(p,h.itemSize,h.offset,h.normalized)}else{var d=sa(h.type,h.array),m=h.isInstancedBufferAttribute?is:fe;u=new m(d,h.itemSize,h.normalized)}h.name!==void 0&&(u.name=h.name),a.setAttribute(c,u)}var g=e.data.morphAttributes;if(g)for(var b in g){for(var v=g[b],f=[],M=0,_=v.length;M<_;M++){var w=v[M],x=void 0;if(w.isInterleavedBufferAttribute){var S=r(e.data,w.data);x=new $r(S,w.itemSize,w.offset,w.normalized)}else{var A=sa(w.type,w.array);x=new fe(A,w.itemSize,w.normalized)}w.name!==void 0&&(x.name=w.name),f.push(x)}a.morphAttributes[b]=f}var I=e.data.morphTargetsRelative;I&&(a.morphTargetsRelative=!0);var P=e.data.groups||e.data.drawcalls||e.data.offsets;if(P!==void 0)for(var R=0,N=P.length;R!==N;++R){var D=P[R];a.addGroup(D.start,D.count,D.materialIndex)}var B=e.data.boundingSphere;if(B!==void 0){var O=new T;B.center!==void 0&&O.fromArray(B.center),a.boundingSphere=new Er(O,B.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}});var X0=function(e){le(i,e);function i(r){return e.call(this,r)||this}var t=i.prototype;return t.load=function(r,n,a,o){var s=this,l=this.path===""?Ql.extractUrlBase(r):this.path;this.resourcePath=this.resourcePath||l;var c=new Zt(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(r,function(h){var u=null;try{u=JSON.parse(h)}catch(d){o!==void 0&&o(d),console.error("THREE:ObjectLoader: Can't parse "+r+".",d.message);return}var p=u.metadata;if(p===void 0||p.type===void 0||p.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+r);return}s.parse(u,n)},a,o)},t.parse=function(r,n){var a=this.parseAnimations(r.animations),o=this.parseShapes(r.shapes),s=this.parseGeometries(r.geometries,o),l=this.parseImages(r.images,function(){n!==void 0&&n(u)}),c=this.parseTextures(r.textures,l),h=this.parseMaterials(r.materials,c),u=this.parseObject(r.object,s,h,a),p=this.parseSkeletons(r.skeletons,u);if(this.bindSkeletons(u,p),n!==void 0){var d=!1;for(var m in l)if(l[m]instanceof HTMLImageElement){d=!0;break}d===!1&&n(u)}return u},t.parseShapes=function(r){var n={};if(r!==void 0)for(var a=0,o=r.length;a<o;a++){var s=new ni().fromJSON(r[a]);n[s.uuid]=s}return n},t.parseSkeletons=function(r,n){var a={},o={};if(n.traverse(function(h){h.isBone&&(o[h.uuid]=h)}),r!==void 0)for(var s=0,l=r.length;s<l;s++){var c=new Ma().fromJSON(r[s],o);a[c.uuid]=c}return a},t.parseGeometries=function(r,n){var a={},o;if(r!==void 0)for(var s=new ns,l=0,c=r.length;l<c;l++){var h=void 0,u=r[l];switch(u.type){case"PlaneGeometry":case"PlaneBufferGeometry":h=new Nt[u.type](u.width,u.height,u.widthSegments,u.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":h=new Nt[u.type](u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":h=new Nt[u.type](u.radius,u.segments,u.thetaStart,u.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":h=new Nt[u.type](u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":h=new Nt[u.type](u.radius,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":h=new Nt[u.type](u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":h=new Nt[u.type](u.radius,u.detail);break;case"RingGeometry":case"RingBufferGeometry":h=new Nt[u.type](u.innerRadius,u.outerRadius,u.thetaSegments,u.phiSegments,u.thetaStart,u.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":h=new Nt[u.type](u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":h=new Nt[u.type](u.radius,u.tube,u.tubularSegments,u.radialSegments,u.p,u.q);break;case"TubeGeometry":case"TubeBufferGeometry":h=new Nt[u.type](new Yl[u.path.type]().fromJSON(u.path),u.tubularSegments,u.radius,u.radialSegments,u.closed);break;case"LatheGeometry":case"LatheBufferGeometry":h=new Nt[u.type](u.points,u.segments,u.phiStart,u.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":h=new Nt[u.type](u.vertices,u.indices,u.radius,u.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":o=[];for(var p=0,d=u.shapes.length;p<d;p++){var m=n[u.shapes[p]];o.push(m)}h=new Nt[u.type](o,u.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":o=[];for(var g=0,b=u.shapes.length;g<b;g++){var v=n[u.shapes[g]];o.push(v)}var f=u.options.extrudePath;f!==void 0&&(u.options.extrudePath=new Yl[f.type]().fromJSON(f)),h=new Nt[u.type](o,u.options);break;case"BufferGeometry":case"InstancedBufferGeometry":h=s.parse(u);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+u.type+'"');continue}h.uuid=u.uuid,u.name!==void 0&&(h.name=u.name),h.isBufferGeometry===!0&&u.userData!==void 0&&(h.userData=u.userData),a[u.uuid]=h}return a},t.parseMaterials=function(r,n){var a={},o={};if(r!==void 0){var s=new rs;s.setTextures(n);for(var l=0,c=r.length;l<c;l++){var h=r[l];if(h.type==="MultiMaterial"){for(var u=[],p=0;p<h.materials.length;p++){var d=h.materials[p];a[d.uuid]===void 0&&(a[d.uuid]=s.parse(d)),u.push(a[d.uuid])}o[h.uuid]=u}else a[h.uuid]===void 0&&(a[h.uuid]=s.parse(h)),o[h.uuid]=a[h.uuid]}}return o},t.parseAnimations=function(r){var n={};if(r!==void 0)for(var a=0;a<r.length;a++){var o=r[a],s=kt.parse(o);n[s.uuid]=s}return n},t.parseImages=function(r,n){var a=this,o={},s;function l(_){return a.manager.itemStart(_),s.load(_,function(){a.manager.itemEnd(_)},void 0,function(){a.manager.itemError(_),a.manager.itemEnd(_)})}function c(_){if(typeof _=="string"){var w=_,x=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(w)?w:a.resourcePath+w;return l(x)}else return _.data?{data:sa(_.type,_.data),width:_.width,height:_.height}:null}if(r!==void 0&&r.length>0){var h=new Hl(n);s=new An(h),s.setCrossOrigin(this.crossOrigin);for(var u=0,p=r.length;u<p;u++){var d=r[u],m=d.url;if(Array.isArray(m)){o[d.uuid]=[];for(var g=0,b=m.length;g<b;g++){var v=m[g],f=c(v);f!==null&&(f instanceof HTMLImageElement?o[d.uuid].push(f):o[d.uuid].push(new Nr(f.data,f.width,f.height)))}}else{var M=c(d.url);M!==null&&(o[d.uuid]=M)}}}return o},t.parseTextures=function(r,n){function a(p,d){return typeof p=="number"?p:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",p),d[p])}var o={};if(r!==void 0)for(var s=0,l=r.length;s<l;s++){var c=r[s];c.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',c.uuid),n[c.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",c.image);var h=void 0,u=n[c.image];Array.isArray(u)?(h=new mr(u),u.length===6&&(h.needsUpdate=!0)):(u&&u.data?h=new Nr(u.data,u.width,u.height):h=new Ve(u),u&&(h.needsUpdate=!0)),h.uuid=c.uuid,c.name!==void 0&&(h.name=c.name),c.mapping!==void 0&&(h.mapping=a(c.mapping,Y0)),c.offset!==void 0&&h.offset.fromArray(c.offset),c.repeat!==void 0&&h.repeat.fromArray(c.repeat),c.center!==void 0&&h.center.fromArray(c.center),c.rotation!==void 0&&(h.rotation=c.rotation),c.wrap!==void 0&&(h.wrapS=a(c.wrap[0],Ld),h.wrapT=a(c.wrap[1],Ld)),c.format!==void 0&&(h.format=c.format),c.type!==void 0&&(h.type=c.type),c.encoding!==void 0&&(h.encoding=c.encoding),c.minFilter!==void 0&&(h.minFilter=a(c.minFilter,Rd)),c.magFilter!==void 0&&(h.magFilter=a(c.magFilter,Rd)),c.anisotropy!==void 0&&(h.anisotropy=c.anisotropy),c.flipY!==void 0&&(h.flipY=c.flipY),c.premultiplyAlpha!==void 0&&(h.premultiplyAlpha=c.premultiplyAlpha),c.unpackAlignment!==void 0&&(h.unpackAlignment=c.unpackAlignment),o[c.uuid]=h}return o},t.parseObject=function(r,n,a,o){var s;function l(S){return n[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",S),n[S]}function c(S){if(S!==void 0){if(Array.isArray(S)){for(var A=[],I=0,P=S.length;I<P;I++){var R=S[I];a[R]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",R),A.push(a[R])}return A}return a[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),a[S]}}var h,u;switch(r.type){case"Scene":s=new ml,r.background!==void 0&&Number.isInteger(r.background)&&(s.background=new ie(r.background)),r.fog!==void 0&&(r.fog.type==="Fog"?s.fog=new Hh(r.fog.color,r.fog.near,r.fog.far):r.fog.type==="FogExp2"&&(s.fog=new Gh(r.fog.color,r.fog.density)));break;case"PerspectiveCamera":s=new ct(r.fov,r.aspect,r.near,r.far),r.focus!==void 0&&(s.focus=r.focus),r.zoom!==void 0&&(s.zoom=r.zoom),r.filmGauge!==void 0&&(s.filmGauge=r.filmGauge),r.filmOffset!==void 0&&(s.filmOffset=r.filmOffset),r.view!==void 0&&(s.view=Object.assign({},r.view));break;case"OrthographicCamera":s=new Rn(r.left,r.right,r.top,r.bottom,r.near,r.far),r.zoom!==void 0&&(s.zoom=r.zoom),r.view!==void 0&&(s.view=Object.assign({},r.view));break;case"AmbientLight":s=new es(r.color,r.intensity);break;case"DirectionalLight":s=new $o(r.color,r.intensity);break;case"PointLight":s=new Qo(r.color,r.intensity,r.distance,r.decay);break;case"RectAreaLight":s=new ts(r.color,r.intensity,r.width,r.height);break;case"SpotLight":s=new Ko(r.color,r.intensity,r.distance,r.angle,r.penumbra,r.decay);break;case"HemisphereLight":s=new Jo(r.color,r.groundColor,r.intensity);break;case"LightProbe":s=new Jt().fromJSON(r);break;case"SkinnedMesh":h=l(r.geometry),u=c(r.material),s=new _a(h,u),r.bindMode!==void 0&&(s.bindMode=r.bindMode),r.bindMatrix!==void 0&&s.bindMatrix.fromArray(r.bindMatrix),r.skeleton!==void 0&&(s.skeleton=r.skeleton);break;case"Mesh":h=l(r.geometry),u=c(r.material),s=new Je(h,u);break;case"InstancedMesh":h=l(r.geometry),u=c(r.material);var p=r.count,d=r.instanceMatrix;s=new So(h,u,p),s.instanceMatrix=new fe(new Float32Array(d.array),16);break;case"LOD":s=new ba;break;case"Line":s=new Yt(l(r.geometry),c(r.material));break;case"LineLoop":s=new Ro(l(r.geometry),c(r.material));break;case"LineSegments":s=new Ct(l(r.geometry),c(r.material));break;case"PointCloud":case"Points":s=new bn(l(r.geometry),c(r.material));break;case"Sprite":s=new xa(c(r.material));break;case"Group":s=new Qr;break;case"Bone":s=new wa;break;default:s=new se}if(s.uuid=r.uuid,r.name!==void 0&&(s.name=r.name),r.matrix!==void 0?(s.matrix.fromArray(r.matrix),r.matrixAutoUpdate!==void 0&&(s.matrixAutoUpdate=r.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(r.position!==void 0&&s.position.fromArray(r.position),r.rotation!==void 0&&s.rotation.fromArray(r.rotation),r.quaternion!==void 0&&s.quaternion.fromArray(r.quaternion),r.scale!==void 0&&s.scale.fromArray(r.scale)),r.castShadow!==void 0&&(s.castShadow=r.castShadow),r.receiveShadow!==void 0&&(s.receiveShadow=r.receiveShadow),r.shadow&&(r.shadow.bias!==void 0&&(s.shadow.bias=r.shadow.bias),r.shadow.normalBias!==void 0&&(s.shadow.normalBias=r.shadow.normalBias),r.shadow.radius!==void 0&&(s.shadow.radius=r.shadow.radius),r.shadow.mapSize!==void 0&&s.shadow.mapSize.fromArray(r.shadow.mapSize),r.shadow.camera!==void 0&&(s.shadow.camera=this.parseObject(r.shadow.camera))),r.visible!==void 0&&(s.visible=r.visible),r.frustumCulled!==void 0&&(s.frustumCulled=r.frustumCulled),r.renderOrder!==void 0&&(s.renderOrder=r.renderOrder),r.userData!==void 0&&(s.userData=r.userData),r.layers!==void 0&&(s.layers.mask=r.layers),r.children!==void 0)for(var m=r.children,g=0;g<m.length;g++)s.add(this.parseObject(m[g],n,a,o));if(r.animations!==void 0)for(var b=r.animations,v=0;v<b.length;v++){var f=b[v];s.animations.push(o[f])}if(r.type==="LOD"){r.autoUpdate!==void 0&&(s.autoUpdate=r.autoUpdate);for(var M=r.levels,_=0;_<M.length;_++){var w=M[_],x=s.getObjectByProperty("uuid",w.object);x!==void 0&&s.addLevel(x,w.distance)}}return s},t.bindSkeletons=function(r,n){Object.keys(n).length!==0&&r.traverse(function(a){if(a.isSkinnedMesh===!0&&a.skeleton!==void 0){var o=n[a.skeleton];o===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",a.skeleton):a.bind(o,a.bindMatrix)}})},t.setTexturePath=function(r){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(r)},i}(ke),Y0={UVMapping:Va,CubeReflectionMapping:Bn,CubeRefractionMapping:zn,EquirectangularReflectionMapping:Wa,EquirectangularRefractionMapping:ja,CubeUVReflectionMapping:Vi,CubeUVRefractionMapping:Un},Ld={RepeatWrapping:Fn,ClampToEdgeWrapping:At,MirroredRepeatWrapping:Gn},Rd={NearestFilter:dt,NearestMipmapNearestFilter:qa,NearestMipmapLinearFilter:Xa,LinearFilter:mt,LinearMipmapNearestFilter:Ls,LinearMipmapLinearFilter:Wi};function $l(e){typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),ke.call(this,e),this.options={premultiplyAlpha:"none"}}$l.prototype=Object.assign(Object.create(ke.prototype),{constructor:$l,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,i,t,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var n=this,a=Ni.get(e);if(a!==void 0)return n.manager.itemStart(e),setTimeout(function(){i&&i(a),n.manager.itemEnd(e)},0),a;var o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(e,o).then(function(s){return s.blob()}).then(function(s){return createImageBitmap(s,n.options)}).then(function(s){Ni.add(e,s),i&&i(s),n.manager.itemEnd(e)}).catch(function(s){r&&r(s),n.manager.itemError(e),n.manager.itemEnd(e)}),n.manager.itemStart(e)}});function ec(){this.type="ShapePath",this.color=new ie,this.subPaths=[],this.currentPath=null}Object.assign(ec.prototype,{moveTo:function(e,i){return this.currentPath=new lr,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,i),this},lineTo:function(e,i){return this.currentPath.lineTo(e,i),this},quadraticCurveTo:function(e,i,t,r){return this.currentPath.quadraticCurveTo(e,i,t,r),this},bezierCurveTo:function(e,i,t,r,n,a){return this.currentPath.bezierCurveTo(e,i,t,r,n,a),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,i){function t(k){for(var W=[],Y=0,j=k.length;Y<j;Y++){var Z=k[Y],ae=new ni;ae.curves=Z.curves,W.push(ae)}return W}function r(k,W){for(var Y=W.length,j=!1,Z=Y-1,ae=0;ae<Y;Z=ae++){var me=W[Z],H=W[ae],Ee=H.x-me.x,ce=H.y-me.y;if(Math.abs(ce)>Number.EPSILON){if(ce<0&&(me=W[ae],Ee=-Ee,H=W[Z],ce=-ce),k.y<me.y||k.y>H.y)continue;if(k.y===me.y){if(k.x===me.x)return!0}else{var Ce=ce*(k.x-me.x)-Ee*(k.y-me.y);if(Ce===0)return!0;if(Ce<0)continue;j=!j}}else{if(k.y!==me.y)continue;if(H.x<=k.x&&k.x<=me.x||me.x<=k.x&&k.x<=H.x)return!0}}return j}var n=Or.isClockWise,a=this.subPaths;if(a.length===0)return[];if(i===!0)return t(a);var o,s,l,c=[];if(a.length===1)return s=a[0],l=new ni,l.curves=s.curves,c.push(l),c;var h=!n(a[0].getPoints());h=e?!h:h;var u=[],p=[],d=[],m=0,g;p[m]=void 0,d[m]=[];for(var b=0,v=a.length;b<v;b++)s=a[b],g=s.getPoints(),o=n(g),o=e?!o:o,o?(!h&&p[m]&&m++,p[m]={s:new ni,p:g},p[m].s.curves=s.curves,h&&m++,d[m]=[]):d[m].push({h:s,p:g[0]});if(!p[0])return t(a);if(p.length>1){for(var f=!1,M=[],_=0,w=p.length;_<w;_++)u[_]=[];for(var x=0,S=p.length;x<S;x++)for(var A=d[x],I=0;I<A.length;I++){for(var P=A[I],R=!0,N=0;N<p.length;N++)r(P.p,p[N].p)&&(x!==N&&M.push({froms:x,tos:N,hole:I}),R?(R=!1,u[N].push(P)):f=!0);R&&u[x].push(P)}M.length>0&&(f||(d=u))}for(var D,B=0,O=p.length;B<O;B++){l=p[B].s,c.push(l),D=d[B];for(var U=0,F=D.length;U<F;U++)l.holes.push(D[U].h)}return c}});function tc(e){this.type="Font",this.data=e}Object.assign(tc.prototype,{isFont:!0,generateShapes:function(e,i){i===void 0&&(i=100);for(var t=[],r=Z0(e,i,this.data),n=0,a=r.length;n<a;n++)Array.prototype.push.apply(t,r[n].toShapes());return t}});function Z0(e,i,t){for(var r=Array.from?Array.from(e):String(e).split(""),n=i/t.resolution,a=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*n,o=[],s=0,l=0,c=0;c<r.length;c++){var h=r[c];if(h===`
`)s=0,l-=a;else{var u=J0(h,n,s,l,t);s+=u.offsetX,o.push(u.path)}}return o}function J0(e,i,t,r,n){var a=n.glyphs[e]||n.glyphs["?"];if(!a){console.error('THREE.Font: character "'+e+'" does not exists in font family '+n.familyName+".");return}var o=new ec,s,l,c,h,u,p,d,m;if(a.o)for(var g=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),b=0,v=g.length;b<v;){var f=g[b++];switch(f){case"m":s=g[b++]*i+t,l=g[b++]*i+r,o.moveTo(s,l);break;case"l":s=g[b++]*i+t,l=g[b++]*i+r,o.lineTo(s,l);break;case"q":c=g[b++]*i+t,h=g[b++]*i+r,u=g[b++]*i+t,p=g[b++]*i+r,o.quadraticCurveTo(u,p,c,h);break;case"b":c=g[b++]*i+t,h=g[b++]*i+r,u=g[b++]*i+t,p=g[b++]*i+r,d=g[b++]*i+t,m=g[b++]*i+r,o.bezierCurveTo(u,p,d,m,c,h);break}}return{offsetX:a.ha*i,path:o}}function rc(e){ke.call(this,e)}rc.prototype=Object.assign(Object.create(ke.prototype),{constructor:rc,load:function(e,i,t,r){var n=this,a=new Zt(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(n.withCredentials),a.load(e,function(o){var s;try{s=JSON.parse(o)}catch(c){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),s=JSON.parse(o.substring(65,o.length-2))}var l=n.parse(s);i&&i(l)},t,r)},parse:function(e){return new tc(e)}});var as,ic={getContext:function(){return as===void 0&&(as=new(window.AudioContext||window.webkitAudioContext)),as},setContext:function(e){as=e}};function os(e){ke.call(this,e)}os.prototype=Object.assign(Object.create(ke.prototype),{constructor:os,load:function(e,i,t,r){var n=this,a=new Zt(n.manager);a.setResponseType("arraybuffer"),a.setPath(n.path),a.setRequestHeader(n.requestHeader),a.setWithCredentials(n.withCredentials),a.load(e,function(o){try{var s=o.slice(0),l=ic.getContext();l.decodeAudioData(s,function(c){i(c)})}catch(c){r?r(c):console.error(c),n.manager.itemError(e)}},t,r)}});function nc(e,i,t){Jt.call(this,void 0,t);var r=new ie().set(e),n=new ie().set(i),a=new T(r.r,r.g,r.b),o=new T(n.r,n.g,n.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(l)}nc.prototype=Object.assign(Object.create(Jt.prototype),{constructor:nc,isHemisphereLightProbe:!0,copy:function(e){return Jt.prototype.copy.call(this,e),this},toJSON:function(e){var i=Jt.prototype.toJSON.call(this,e);return i}});function ac(e,i){Jt.call(this,void 0,i);var t=new ie().set(e);this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}ac.prototype=Object.assign(Object.create(Jt.prototype),{constructor:ac,isAmbientLightProbe:!0,copy:function(e){return Jt.prototype.copy.call(this,e),this},toJSON:function(e){var i=Jt.prototype.toJSON.call(this,e);return i}});var Pd=new Te,Cd=new Te;function Nd(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ct,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ct,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(Nd.prototype,{update:function(e){var i=this._cache,t=i.focus!==e.focus||i.fov!==e.fov||i.aspect!==e.aspect*this.aspect||i.near!==e.near||i.far!==e.far||i.zoom!==e.zoom||i.eyeSep!==this.eyeSep;if(t){i.focus=e.focus,i.fov=e.fov,i.aspect=e.aspect*this.aspect,i.near=e.near,i.far=e.far,i.zoom=e.zoom,i.eyeSep=this.eyeSep;var r=e.projectionMatrix.clone(),n=i.eyeSep/2,a=n*i.near/i.focus,o=i.near*Math.tan(be.DEG2RAD*i.fov*.5)/i.zoom,s,l;Cd.elements[12]=-n,Pd.elements[12]=n,s=-o*i.aspect+a,l=o*i.aspect+a,r.elements[0]=2*i.near/(l-s),r.elements[8]=(l+s)/(l-s),this.cameraL.projectionMatrix.copy(r),s=-o*i.aspect-a,l=o*i.aspect-a,r.elements[0]=2*i.near/(l-s),r.elements[8]=(l+s)/(l-s),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Cd),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Pd)}});var Od=function(){function e(t){this.autoStart=t!==void 0?t:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var i=e.prototype;return i.start=function(){this.startTime=Id(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},i.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},i.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},i.getDelta=function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var r=Id();t=(r-this.oldTime)/1e3,this.oldTime=r,this.elapsedTime+=t}return t},e}();function Id(){return(typeof performance=="undefined"?Date:performance).now()}var Oi=new T,Dd=new _t,K0=new T,Ii=new T,Q0=function(e){le(i,e);function i(){var r;return r=e.call(this)||this,r.type="AudioListener",r.context=ic.getContext(),r.gain=r.context.createGain(),r.gain.connect(r.context.destination),r.filter=null,r.timeDelta=0,r._clock=new Od,r}var t=i.prototype;return t.getInput=function(){return this.gain},t.removeFilter=function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},t.getFilter=function(){return this.filter},t.setFilter=function(r){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=r,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},t.getMasterVolume=function(){return this.gain.gain.value},t.setMasterVolume=function(r){return this.gain.gain.setTargetAtTime(r,this.context.currentTime,.01),this},t.updateMatrixWorld=function(r){e.prototype.updateMatrixWorld.call(this,r);var n=this.context.listener,a=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Oi,Dd,K0),Ii.set(0,0,-1).applyQuaternion(Dd),n.positionX){var o=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Oi.x,o),n.positionY.linearRampToValueAtTime(Oi.y,o),n.positionZ.linearRampToValueAtTime(Oi.z,o),n.forwardX.linearRampToValueAtTime(Ii.x,o),n.forwardY.linearRampToValueAtTime(Ii.y,o),n.forwardZ.linearRampToValueAtTime(Ii.z,o),n.upX.linearRampToValueAtTime(a.x,o),n.upY.linearRampToValueAtTime(a.y,o),n.upZ.linearRampToValueAtTime(a.z,o)}else n.setPosition(Oi.x,Oi.y,Oi.z),n.setOrientation(Ii.x,Ii.y,Ii.z,a.x,a.y,a.z)},i}(se),oc=function(e){le(i,e);function i(r){var n;return n=e.call(this)||this,n.type="Audio",n.listener=r,n.context=r.context,n.gain=n.context.createGain(),n.gain.connect(r.getInput()),n.autoplay=!1,n.buffer=null,n.detune=0,n.loop=!1,n.loopStart=0,n.loopEnd=0,n.offset=0,n.duration=void 0,n.playbackRate=1,n.isPlaying=!1,n.hasPlaybackControl=!0,n.source=null,n.sourceType="empty",n._startedAt=0,n._progress=0,n._connected=!1,n.filters=[],n}var t=i.prototype;return t.getOutput=function(){return this.gain},t.setNodeSource=function(r){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=r,this.connect(),this},t.setMediaElementSource=function(r){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(r),this.connect(),this},t.setMediaStreamSource=function(r){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(r),this.connect(),this},t.setBuffer=function(r){return this.buffer=r,this.sourceType="buffer",this.autoplay&&this.play(),this},t.play=function(r){if(r===void 0&&(r=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+r;var n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},t.pause=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},t.stop=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},t.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var r=1,n=this.filters.length;r<n;r++)this.filters[r-1].connect(this.filters[r]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},t.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var r=1,n=this.filters.length;r<n;r++)this.filters[r-1].disconnect(this.filters[r]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},t.getFilters=function(){return this.filters},t.setFilters=function(r){return r||(r=[]),this._connected===!0?(this.disconnect(),this.filters=r.slice(),this.connect()):this.filters=r.slice(),this},t.setDetune=function(r){if(this.detune=r,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},t.getDetune=function(){return this.detune},t.getFilter=function(){return this.getFilters()[0]},t.setFilter=function(r){return this.setFilters(r?[r]:[])},t.setPlaybackRate=function(r){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=r,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},t.getPlaybackRate=function(){return this.playbackRate},t.onEnded=function(){this.isPlaying=!1},t.getLoop=function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},t.setLoop=function(r){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=r,this.isPlaying===!0&&(this.source.loop=this.loop),this},t.setLoopStart=function(r){return this.loopStart=r,this},t.setLoopEnd=function(r){return this.loopEnd=r,this},t.getVolume=function(){return this.gain.gain.value},t.setVolume=function(r){return this.gain.gain.setTargetAtTime(r,this.context.currentTime,.01),this},i}(se),Di=new T,Bd=new _t,$0=new T,Bi=new T,ey=function(e){le(i,e);function i(r){var n;return n=e.call(this,r)||this,n.panner=n.context.createPanner(),n.panner.panningModel="HRTF",n.panner.connect(n.gain),n}var t=i.prototype;return t.getOutput=function(){return this.panner},t.getRefDistance=function(){return this.panner.refDistance},t.setRefDistance=function(r){return this.panner.refDistance=r,this},t.getRolloffFactor=function(){return this.panner.rolloffFactor},t.setRolloffFactor=function(r){return this.panner.rolloffFactor=r,this},t.getDistanceModel=function(){return this.panner.distanceModel},t.setDistanceModel=function(r){return this.panner.distanceModel=r,this},t.getMaxDistance=function(){return this.panner.maxDistance},t.setMaxDistance=function(r){return this.panner.maxDistance=r,this},t.setDirectionalCone=function(r,n,a){return this.panner.coneInnerAngle=r,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=a,this},t.updateMatrixWorld=function(r){if(e.prototype.updateMatrixWorld.call(this,r),!(this.hasPlaybackControl===!0&&this.isPlaying===!1)){this.matrixWorld.decompose(Di,Bd,$0),Bi.set(0,0,1).applyQuaternion(Bd);var n=this.panner;if(n.positionX){var a=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Di.x,a),n.positionY.linearRampToValueAtTime(Di.y,a),n.positionZ.linearRampToValueAtTime(Di.z,a),n.orientationX.linearRampToValueAtTime(Bi.x,a),n.orientationY.linearRampToValueAtTime(Bi.y,a),n.orientationZ.linearRampToValueAtTime(Bi.z,a)}else n.setPosition(Di.x,Di.y,Di.z),n.setOrientation(Bi.x,Bi.y,Bi.z)}},i}(oc),zd=function(){function e(t,r){r===void 0&&(r=2048),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=r,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}var i=e.prototype;return i.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},i.getAverageFrequency=function(){for(var t=0,r=this.getFrequencyData(),n=0;n<r.length;n++)t+=r[n];return t/r.length},e}();function sc(e,i,t){this.binding=e,this.valueSize=t;var r,n,a;switch(i){case"quaternion":r=this._slerp,n=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(t*6),this._workIndex=5;break;case"string":case"bool":r=this._select,n=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(t*5);break;default:r=this._lerp,n=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(t*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=n,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(sc.prototype,{accumulate:function(e,i){var t=this.buffer,r=this.valueSize,n=e*r+r,a=this.cumulativeWeight;if(a===0){for(var o=0;o!==r;++o)t[n+o]=t[o];a=i}else{a+=i;var s=i/a;this._mixBufferRegion(t,n,0,s,r)}this.cumulativeWeight=a},accumulateAdditive:function(e){var i=this.buffer,t=this.valueSize,r=t*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,r,0,e,t),this.cumulativeWeightAdditive+=e},apply:function(e){var i=this.valueSize,t=this.buffer,r=e*i+i,n=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){var s=i*this._origIndex;this._mixBufferRegion(t,r,s,1-n,i)}a>0&&this._mixBufferRegionAdditive(t,r,this._addIndex*i,1,i);for(var l=i,c=i+i;l!==c;++l)if(t[l]!==t[l+i]){o.setValue(t,r);break}},saveOriginalState:function(){var e=this.binding,i=this.buffer,t=this.valueSize,r=t*this._origIndex;e.getValue(i,r);for(var n=t,a=r;n!==a;++n)i[n]=i[r+n%t];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var e=this.valueSize*3;this.binding.setValue(this.buffer,e)},_setAdditiveIdentityNumeric:function(){for(var e=this._addIndex*this.valueSize,i=e+this.valueSize,t=e;t<i;t++)this.buffer[t]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var e=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize,t=0;t<this.valueSize;t++)this.buffer[i+t]=this.buffer[e+t]},_select:function(e,i,t,r,n){if(r>=.5)for(var a=0;a!==n;++a)e[i+a]=e[t+a]},_slerp:function(e,i,t,r){_t.slerpFlat(e,i,e,i,e,t,r)},_slerpAdditive:function(e,i,t,r,n){var a=this._workIndex*n;_t.multiplyQuaternionsFlat(e,a,e,i,e,t),_t.slerpFlat(e,i,e,i,e,a,r)},_lerp:function(e,i,t,r,n){for(var a=1-r,o=0;o!==n;++o){var s=i+o;e[s]=e[s]*a+e[t+o]*r}},_lerpAdditive:function(e,i,t,r,n){for(var a=0;a!==n;++a){var o=i+a;e[o]=e[o]+e[t+a]*r}}});var lc="\\[\\]\\.:\\/",ty=new RegExp("["+lc+"]","g"),cc="[^"+lc+"]",ry="[^"+lc.replace("\\.","")+"]",iy=/((?:WC+[\/:])*)/.source.replace("WC",cc),ny=/(WCOD+)?/.source.replace("WCOD",ry),ay=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",cc),oy=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",cc),sy=new RegExp("^"+iy+ny+ay+oy+"$"),ly=["material","materials","bones"];function Ud(e,i,t){var r=t||St.parseTrackName(i);this._targetGroup=e,this._bindings=e.subscribe_(i,r)}Object.assign(Ud.prototype,{getValue:function(e,i){this.bind();var t=this._targetGroup.nCachedObjects_,r=this._bindings[t];r!==void 0&&r.getValue(e,i)},setValue:function(e,i){for(var t=this._bindings,r=this._targetGroup.nCachedObjects_,n=t.length;r!==n;++r)t[r].setValue(e,i)},bind:function(){for(var e=this._bindings,i=this._targetGroup.nCachedObjects_,t=e.length;i!==t;++i)e[i].bind()},unbind:function(){for(var e=this._bindings,i=this._targetGroup.nCachedObjects_,t=e.length;i!==t;++i)e[i].unbind()}});function St(e,i,t){this.path=i,this.parsedPath=t||St.parseTrackName(i),this.node=St.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}Object.assign(St,{Composite:Ud,create:function(e,i,t){return e&&e.isAnimationObjectGroup?new St.Composite(e,i,t):new St(e,i,t)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(ty,"")},parseTrackName:function(e){var i=sy.exec(e);if(!i)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var t={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},r=t.nodeName&&t.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){var n=t.nodeName.substring(r+1);ly.indexOf(n)!==-1&&(t.nodeName=t.nodeName.substring(0,r),t.objectName=n)}if(t.propertyName===null||t.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return t},findNode:function(e,i){if(!i||i===""||i==="."||i===-1||i===e.name||i===e.uuid)return e;if(e.skeleton){var t=e.skeleton.getBoneByName(i);if(t!==void 0)return t}if(e.children){var r=function a(o){for(var s=0;s<o.length;s++){var l=o[s];if(l.name===i||l.uuid===i)return l;var c=a(l.children);if(c)return c}return null},n=r(e.children);if(n)return n}return null}}),Object.assign(St.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,i){e[i]=this.node[this.propertyName]},function(e,i){for(var t=this.resolvedProperty,r=0,n=t.length;r!==n;++r)e[i++]=t[r]},function(e,i){e[i]=this.resolvedProperty[this.propertyIndex]},function(e,i){this.resolvedProperty.toArray(e,i)}],SetterByBindingTypeAndVersioning:[[function(e,i){this.targetObject[this.propertyName]=e[i]},function(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.needsUpdate=!0},function(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,i){for(var t=this.resolvedProperty,r=0,n=t.length;r!==n;++r)t[r]=e[i++]},function(e,i){for(var t=this.resolvedProperty,r=0,n=t.length;r!==n;++r)t[r]=e[i++];this.targetObject.needsUpdate=!0},function(e,i){for(var t=this.resolvedProperty,r=0,n=t.length;r!==n;++r)t[r]=e[i++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,i){this.resolvedProperty[this.propertyIndex]=e[i]},function(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.needsUpdate=!0},function(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,i){this.resolvedProperty.fromArray(e,i)},function(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.needsUpdate=!0},function(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,i){this.bind(),this.getValue(e,i)},setValue:function(e,i){this.bind(),this.setValue(e,i)},bind:function(){var e=this.node,i=this.parsedPath,t=i.objectName,r=i.propertyName,n=i.propertyIndex;if(e||(e=St.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(t){var a=i.objectIndex;switch(t){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(e[t]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[t]}if(a!==void 0){if(e[a]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[a]}}var s=e[r];if(s===void 0){var l=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",e);return}var c=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?c=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(c=this.Versioning.MatrixWorldNeedsUpdate);var h=this.BindingType.Direct;if(n!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[n]!==void 0&&(n=e.morphTargetDictionary[n])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}h=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else s.fromArray!==void 0&&s.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(h=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][c]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(St.prototype,{_getValue_unbound:St.prototype.getValue,_setValue_unbound:St.prototype.setValue});function Fd(){this.uuid=be.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var i=0,t=arguments.length;i!==t;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}Object.assign(Fd.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,i=this._indicesByUUID,t=this._paths,r=this._parsedPaths,n=this._bindings,a=n.length,o=void 0,s=e.length,l=this.nCachedObjects_,c=0,h=arguments.length;c!==h;++c){var u=arguments[c],p=u.uuid,d=i[p];if(d===void 0){d=s++,i[p]=d,e.push(u);for(var m=0,g=a;m!==g;++m)n[m].push(new St(u,t[m],r[m]))}else if(d<l){o=e[d];var b=--l,v=e[b];i[v.uuid]=d,e[d]=v,i[p]=b,e[b]=u;for(var f=0,M=a;f!==M;++f){var _=n[f],w=_[b],x=_[d];_[d]=w,x===void 0&&(x=new St(u,t[f],r[f])),_[b]=x}}else e[d]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l},remove:function(){for(var e=this._objects,i=this._indicesByUUID,t=this._bindings,r=t.length,n=this.nCachedObjects_,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,c=i[l];if(c!==void 0&&c>=n){var h=n++,u=e[h];i[u.uuid]=c,e[c]=u,i[l]=h,e[h]=s;for(var p=0,d=r;p!==d;++p){var m=t[p],g=m[h],b=m[c];m[c]=g,m[h]=b}}}this.nCachedObjects_=n},uncache:function(){for(var e=this._objects,i=this._indicesByUUID,t=this._bindings,r=t.length,n=this.nCachedObjects_,a=e.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o],c=l.uuid,h=i[c];if(h!==void 0)if(delete i[c],h<n){var u=--n,p=e[u],d=--a,m=e[d];i[p.uuid]=h,e[h]=p,i[m.uuid]=u,e[u]=m,e.pop();for(var g=0,b=r;g!==b;++g){var v=t[g],f=v[u],M=v[d];v[h]=f,v[u]=M,v.pop()}}else{var _=--a,w=e[_];_>0&&(i[w.uuid]=h),e[h]=w,e.pop();for(var x=0,S=r;x!==S;++x){var A=t[x];A[h]=A[_],A.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,i){var t=this._bindingsIndicesByPath,r=t[e],n=this._bindings;if(r!==void 0)return n[r];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,h=new Array(l);r=n.length,t[e]=r,a.push(e),o.push(i),n.push(h);for(var u=c,p=s.length;u!==p;++u){var d=s[u];h[u]=new St(d,e,i)}return h},unsubscribe_:function(e){var i=this._bindingsIndicesByPath,t=i[e];if(t!==void 0){var r=this._paths,n=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o],l=e[o];i[l]=t,a[t]=s,a.pop(),n[t]=n[o],n.pop(),r[t]=r[o],r.pop()}}});var cy=function(){function e(t,r,n,a){n===void 0&&(n=null),a===void 0&&(a=r.blendMode),this._mixer=t,this._clip=r,this._localRoot=n,this.blendMode=a;for(var o=r.tracks,s=o.length,l=new Array(s),c={endingStart:pi,endingEnd:pi},h=0;h!==s;++h){var u=o[h].createInterpolant(null);l[h]=u,u.settings=c}this._interpolantSettings=c,this._interpolants=l,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qu,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=Infinity,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var i=e.prototype;return i.play=function(){return this._mixer._activateAction(this),this},i.stop=function(){return this._mixer._deactivateAction(this),this.reset()},i.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},i.isRunning=function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},i.isScheduled=function(){return this._mixer._isActiveAction(this)},i.startAt=function(t){return this._startTime=t,this},i.setLoop=function(t,r){return this.loop=t,this.repetitions=r,this},i.setEffectiveWeight=function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},i.getEffectiveWeight=function(){return this._effectiveWeight},i.fadeIn=function(t){return this._scheduleFading(t,0,1)},i.fadeOut=function(t){return this._scheduleFading(t,1,0)},i.crossFadeFrom=function(t,r,n){if(t.fadeOut(r),this.fadeIn(r),n){var a=this._clip.duration,o=t._clip.duration,s=o/a,l=a/o;t.warp(1,s,r),this.warp(l,1,r)}return this},i.crossFadeTo=function(t,r,n){return t.crossFadeFrom(this,r,n)},i.stopFading=function(){var t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},i.setEffectiveTimeScale=function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},i.getEffectiveTimeScale=function(){return this._effectiveTimeScale},i.setDuration=function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},i.syncWith=function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},i.halt=function(t){return this.warp(this._effectiveTimeScale,0,t)},i.warp=function(t,r,n){var a=this._mixer,o=a.time,s=this.timeScale,l=this._timeScaleInterpolant;l===null&&(l=a._lendControlInterpolant(),this._timeScaleInterpolant=l);var c=l.parameterPositions,h=l.sampleValues;return c[0]=o,c[1]=o+n,h[0]=t/s,h[1]=r/s,this},i.stopWarping=function(){var t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},i.getMixer=function(){return this._mixer},i.getClip=function(){return this._clip},i.getRoot=function(){return this._localRoot||this._mixer._root},i._update=function(t,r,n,a){if(!this.enabled){this._updateWeight(t);return}var o=this._startTime;if(o!==null){var s=(t-o)*n;if(s<0||n===0)return;this._startTime=null,r=n*s}r*=this._updateTimeScale(t);var l=this._updateTime(r),c=this._updateWeight(t);if(c>0){var h=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case Fs:for(var p=0,d=h.length;p!==d;++p)h[p].evaluate(l),u[p].accumulateAdditive(c);break;case Za:default:for(var m=0,g=h.length;m!==g;++m)h[m].evaluate(l),u[m].accumulate(a,c)}}},i._updateWeight=function(t){var r=0;if(this.enabled){r=this.weight;var n=this._weightInterpolant;if(n!==null){var a=n.evaluate(t)[0];r*=a,t>n.parameterPositions[1]&&(this.stopFading(),a===0&&(this.enabled=!1))}}return this._effectiveWeight=r,r},i._updateTimeScale=function(t){var r=0;if(!this.paused){r=this.timeScale;var n=this._timeScaleInterpolant;if(n!==null){var a=n.evaluate(t)[0];r*=a,t>n.parameterPositions[1]&&(this.stopWarping(),r===0?this.paused=!0:this.timeScale=r)}}return this._effectiveTimeScale=r,r},i._updateTime=function(t){var r=this._clip.duration,n=this.loop,a=this.time+t,o=this._loopCount,s=n===Xu;if(t===0)return o===-1?a:s&&(o&1)==1?r-a:a;if(n===ju){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(a>=r)a=r;else if(a<0)a=0;else{this.time=a;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(o===-1&&(t>=0?(o=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),a>=r||a<0){var l=Math.floor(a/r);a-=r*l,o+=Math.abs(l);var c=this.repetitions-o;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a=t>0?r:0,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(c===1){var h=t<0;this._setEndings(h,!h,s)}else this._setEndings(!1,!1,s);this._loopCount=o,this.time=a,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=a;if(s&&(o&1)==1)return r-a}return a},i._setEndings=function(t,r,n){var a=this._interpolantSettings;n?(a.endingStart=fi,a.endingEnd=fi):(t?a.endingStart=this.zeroSlopeAtStart?fi:pi:a.endingStart=qn,r?a.endingEnd=this.zeroSlopeAtEnd?fi:pi:a.endingEnd=qn)},i._scheduleFading=function(t,r,n){var a=this._mixer,o=a.time,s=this._weightInterpolant;s===null&&(s=a._lendControlInterpolant(),this._weightInterpolant=s);var l=s.parameterPositions,c=s.sampleValues;return l[0]=o,c[0]=r,l[1]=o+t,c[1]=n,this},e}();function uc(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}uc.prototype=Object.assign(Object.create(ur.prototype),{constructor:uc,_bindAction:function(e,i){var t=e._localRoot||this._root,r=e._clip.tracks,n=r.length,a=e._propertyBindings,o=e._interpolants,s=t.uuid,l=this._bindingsByRootAndName,c=l[s];c===void 0&&(c={},l[s]=c);for(var h=0;h!==n;++h){var u=r[h],p=u.name,d=c[p];if(d!==void 0)a[h]=d;else{if(d=a[h],d!==void 0){d._cacheIndex===null&&(++d.referenceCount,this._addInactiveBinding(d,s,p));continue}var m=i&&i._propertyBindings[h].binding.parsedPath;d=new sc(St.create(t,p,m),u.ValueTypeName,u.getValueSize()),++d.referenceCount,this._addInactiveBinding(d,s,p),a[h]=d}o[h].resultBuffer=d.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var i=(e._localRoot||this._root).uuid,t=e._clip.uuid,r=this._actionsByClip[t];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,t,i)}for(var n=e._propertyBindings,a=0,o=n.length;a!==o;++a){var s=n[a];s.useCount++==0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var i=e._propertyBindings,t=0,r=i.length;t!==r;++t){var n=i[t];--n.useCount==0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var i=e._cacheIndex;return i!==null&&i<this._nActiveActions},_addInactiveAction:function(e,i,t){var r=this._actions,n=this._actionsByClip,a=n[i];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[i]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[t]=e},_removeInactiveAction:function(e){var i=this._actions,t=i[i.length-1],r=e._cacheIndex;t._cacheIndex=r,i[r]=t,i.pop(),e._cacheIndex=null;var n=e._clip.uuid,a=this._actionsByClip,o=a[n],s=o.knownActions,l=s[s.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),e._byClipCacheIndex=null;var h=o.actionByRoot,u=(e._localRoot||this._root).uuid;delete h[u],s.length===0&&delete a[n],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var i=e._propertyBindings,t=0,r=i.length;t!==r;++t){var n=i[t];--n.referenceCount==0&&this._removeInactiveBinding(n)}},_lendAction:function(e){var i=this._actions,t=e._cacheIndex,r=this._nActiveActions++,n=i[r];e._cacheIndex=r,i[r]=e,n._cacheIndex=t,i[t]=n},_takeBackAction:function(e){var i=this._actions,t=e._cacheIndex,r=--this._nActiveActions,n=i[r];e._cacheIndex=r,i[r]=e,n._cacheIndex=t,i[t]=n},_addInactiveBinding:function(e,i,t){var r=this._bindingsByRootAndName,n=this._bindings,a=r[i];a===void 0&&(a={},r[i]=a),a[t]=e,e._cacheIndex=n.length,n.push(e)},_removeInactiveBinding:function(e){var i=this._bindings,t=e.binding,r=t.rootNode.uuid,n=t.path,a=this._bindingsByRootAndName,o=a[r],s=i[i.length-1],l=e._cacheIndex;s._cacheIndex=l,i[l]=s,i.pop(),delete o[n],Object.keys(o).length===0&&delete a[r]},_lendBinding:function(e){var i=this._bindings,t=e._cacheIndex,r=this._nActiveBindings++,n=i[r];e._cacheIndex=r,i[r]=e,n._cacheIndex=t,i[t]=n},_takeBackBinding:function(e){var i=this._bindings,t=e._cacheIndex,r=--this._nActiveBindings,n=i[r];e._cacheIndex=r,i[r]=e,n._cacheIndex=t,i[t]=n},_lendControlInterpolant:function(){var e=this._controlInterpolants,i=this._nActiveControlInterpolants++,t=e[i];return t===void 0&&(t=new Oa(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),t.__cacheIndex=i,e[i]=t),t},_takeBackControlInterpolant:function(e){var i=this._controlInterpolants,t=e.__cacheIndex,r=--this._nActiveControlInterpolants,n=i[r];e.__cacheIndex=r,i[r]=e,n.__cacheIndex=t,i[t]=n},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,i,t){var r=i||this._root,n=r.uuid,a=typeof e=="string"?kt.findByName(r,e):e,o=a!==null?a.uuid:e,s=this._actionsByClip[o],l=null;if(t===void 0&&(a!==null?t=a.blendMode:t=Za),s!==void 0){var c=s.actionByRoot[n];if(c!==void 0&&c.blendMode===t)return c;l=s.knownActions[0],a===null&&(a=l._clip)}if(a===null)return null;var h=new cy(this,a,i,t);return this._bindAction(h,l),this._addInactiveAction(h,o,n),h},existingAction:function(e,i){var t=i||this._root,r=t.uuid,n=typeof e=="string"?kt.findByName(t,e):e,a=n?n.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[r]||null},stopAllAction:function(){for(var e=this._actions,i=this._nActiveActions,t=i-1;t>=0;--t)e[t].stop();return this},update:function(e){e*=this.timeScale;for(var i=this._actions,t=this._nActiveActions,r=this.time+=e,n=Math.sign(e),a=this._accuIndex^=1,o=0;o!==t;++o){var s=i[o];s._update(r,e,n,a)}for(var l=this._bindings,c=this._nActiveBindings,h=0;h!==c;++h)l[h].apply(a);return this},setTime:function(e){this.time=0;for(var i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var i=this._actions,t=e.uuid,r=this._actionsByClip,n=r[t];if(n!==void 0){for(var a=n.knownActions,o=0,s=a.length;o!==s;++o){var l=a[o];this._deactivateAction(l);var c=l._cacheIndex,h=i[i.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,h._cacheIndex=c,i[c]=h,i.pop(),this._removeInactiveBindingsForAction(l)}delete r[t]}},uncacheRoot:function(e){var i=e.uuid,t=this._actionsByClip;for(var r in t){var n=t[r].actionByRoot,a=n[i];a!==void 0&&(this._deactivateAction(a),this._removeInactiveAction(a))}var o=this._bindingsByRootAndName,s=o[i];if(s!==void 0)for(var l in s){var c=s[l];c.restoreOriginalState(),this._removeInactiveBinding(c)}},uncacheAction:function(e,i){var t=this.existingAction(e,i);t!==null&&(this._deactivateAction(t),this._removeInactiveAction(t))}});var Gd=function(){function e(t){typeof t=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}var i=e.prototype;return i.clone=function(){return new e(this.value.clone===void 0?this.value:this.value.clone())},e}();function hc(e,i,t){Gt.call(this,e,i),this.meshPerAttribute=t||1}hc.prototype=Object.assign(Object.create(Gt.prototype),{constructor:hc,isInstancedInterleavedBuffer:!0,copy:function(e){return Gt.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){var i=Gt.prototype.clone.call(this,e);return i.meshPerAttribute=this.meshPerAttribute,i},toJSON:function(e){var i=Gt.prototype.toJSON.call(this,e);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}});function dc(e,i,t,r,n){this.buffer=e,this.type=i,this.itemSize=t,this.elementSize=r,this.count=n,this.version=0}Object.defineProperty(dc.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(dc.prototype,{isGLBufferAttribute:!0,setBuffer:function(e){return this.buffer=e,this},setType:function(e,i){return this.type=e,this.elementSize=i,this},setItemSize:function(e){return this.itemSize=e,this},setCount:function(e){return this.count=e,this}});function pc(e,i,t,r){this.ray=new $i(e,i),this.near=t||0,this.far=r||Infinity,this.camera=null,this.layers=new Qs,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Hd(e,i){return e.distance-i.distance}function fc(e,i,t,r){if(e.layers.test(i.layers)&&e.raycast(i,t),r===!0)for(var n=e.children,a=0,o=n.length;a<o;a++)fc(n[a],i,t,!0)}Object.assign(pc.prototype,{set:function(e,i){this.ray.set(e,i)},setFromCamera:function(e,i){i&&i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i&&i.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)},intersectObject:function(e,i,t){var r=t||[];return fc(e,this,r,i),r.sort(Hd),r},intersectObjects:function(e,i,t){var r=t||[];if(Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var n=0,a=e.length;n<a;n++)fc(e[n],this,r,i);return r.sort(Hd),r}});var uy=function(){function e(t,r,n){return t===void 0&&(t=1),r===void 0&&(r=0),n===void 0&&(n=0),this.radius=t,this.phi=r,this.theta=n,this}var i=e.prototype;return i.set=function(t,r,n){return this.radius=t,this.phi=r,this.theta=n,this},i.clone=function(){return new this.constructor().copy(this)},i.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},i.makeSafe=function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},i.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},i.setFromCartesianCoords=function(t,r,n){return this.radius=Math.sqrt(t*t+r*r+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(be.clamp(r/this.radius,-1,1))),this},e}(),hy=function(){function e(t,r,n){return this.radius=t!==void 0?t:1,this.theta=r!==void 0?r:0,this.y=n!==void 0?n:0,this}var i=e.prototype;return i.set=function(t,r,n){return this.radius=t,this.theta=r,this.y=n,this},i.clone=function(){return new this.constructor().copy(this)},i.copy=function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},i.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},i.setFromCartesianCoords=function(t,r,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=r,this},e}(),kd=new X,Vd=function(){function e(t,r){Object.defineProperty(this,"isBox2",{value:!0}),this.min=t!==void 0?t:new X(Infinity,Infinity),this.max=r!==void 0?r:new X(-Infinity,-Infinity)}var i=e.prototype;return i.set=function(t,r){return this.min.copy(t),this.max.copy(r),this},i.setFromPoints=function(t){this.makeEmpty();for(var r=0,n=t.length;r<n;r++)this.expandByPoint(t[r]);return this},i.setFromCenterAndSize=function(t,r){var n=kd.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},i.clone=function(){return new this.constructor().copy(this)},i.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},i.makeEmpty=function(){return this.min.x=this.min.y=Infinity,this.max.x=this.max.y=-Infinity,this},i.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},i.getCenter=function(t){return t===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new X),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},i.getSize=function(t){return t===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new X),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},i.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},i.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},i.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},i.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},i.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},i.getParameter=function(t,r){return r===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),r=new X),r.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},i.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},i.clampPoint=function(t,r){return r===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),r=new X),r.copy(t).clamp(this.min,this.max)},i.distanceToPoint=function(t){var r=kd.copy(t).clamp(this.min,this.max);return r.sub(t).length()},i.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this},i.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},i.translate=function(t){return this.min.add(t),this.max.add(t),this},i.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},e}(),Wd=new T,ss=new T,jd=function(){function e(t,r){this.start=t!==void 0?t:new T,this.end=r!==void 0?r:new T}var i=e.prototype;return i.set=function(t,r){return this.start.copy(t),this.end.copy(r),this},i.clone=function(){return new this.constructor().copy(this)},i.copy=function(t){return this.start.copy(t.start),this.end.copy(t.end),this},i.getCenter=function(t){return t===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new T),t.addVectors(this.start,this.end).multiplyScalar(.5)},i.delta=function(t){return t===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),t=new T),t.subVectors(this.end,this.start)},i.distanceSq=function(){return this.start.distanceToSquared(this.end)},i.distance=function(){return this.start.distanceTo(this.end)},i.at=function(t,r){return r===void 0&&(console.warn("THREE.Line3: .at() target is now required"),r=new T),this.delta(r).multiplyScalar(t).add(this.start)},i.closestPointToPointParameter=function(t,r){Wd.subVectors(t,this.start),ss.subVectors(this.end,this.start);var n=ss.dot(ss),a=ss.dot(Wd),o=a/n;return r&&(o=be.clamp(o,0,1)),o},i.closestPointToPoint=function(t,r,n){var a=this.closestPointToPointParameter(t,r);return n===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new T),this.delta(n).multiplyScalar(a).add(this.start)},i.applyMatrix4=function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},i.equals=function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},e}();function Ua(e){se.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Ua.prototype=Object.create(se.prototype),Ua.prototype.constructor=Ua,Ua.prototype.isImmediateRenderObject=!0;var qd=new T,dy=function(e){le(i,e);function i(r,n){var a;a=e.call(this)||this,a.light=r,a.light.updateMatrixWorld(),a.matrix=r.matrixWorld,a.matrixAutoUpdate=!1,a.color=n;for(var o=new pe,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],l=0,c=1,h=32;l<h;l++,c++){var u=l/h*Math.PI*2,p=c/h*Math.PI*2;s.push(Math.cos(u),Math.sin(u),1,Math.cos(p),Math.sin(p),1)}o.setAttribute("position",new te(s,3));var d=new et({fog:!1,toneMapped:!1});return a.cone=new Ct(o,d),a.add(a.cone),a.update(),a}var t=i.prototype;return t.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},t.update=function(){this.light.updateMatrixWorld();var r=this.light.distance?this.light.distance:1e3,n=r*Math.tan(this.light.angle);this.cone.scale.set(n,n,r),qd.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(qd),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},i}(se),ai=new T,ls=new Te,mc=new Te,Xd=function(e){le(i,e);function i(r){for(var n,a=Yd(r),o=new pe,s=[],l=[],c=new ie(0,0,1),h=new ie(0,1,0),u=0;u<a.length;u++){var p=a[u];p.parent&&p.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),l.push(c.r,c.g,c.b),l.push(h.r,h.g,h.b))}o.setAttribute("position",new te(s,3)),o.setAttribute("color",new te(l,3));var d=new et({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return n=e.call(this,o,d)||this,n.type="SkeletonHelper",n.isSkeletonHelper=!0,n.root=r,n.bones=a,n.matrix=r.matrixWorld,n.matrixAutoUpdate=!1,n}var t=i.prototype;return t.updateMatrixWorld=function(r){var n=this.bones,a=this.geometry,o=a.getAttribute("position");mc.copy(this.root.matrixWorld).invert();for(var s=0,l=0;s<n.length;s++){var c=n[s];c.parent&&c.parent.isBone&&(ls.multiplyMatrices(mc,c.matrixWorld),ai.setFromMatrixPosition(ls),o.setXYZ(l,ai.x,ai.y,ai.z),ls.multiplyMatrices(mc,c.parent.matrixWorld),ai.setFromMatrixPosition(ls),o.setXYZ(l+1,ai.x,ai.y,ai.z),l+=2)}a.getAttribute("position").needsUpdate=!0,e.prototype.updateMatrixWorld.call(this,r)},i}(Ct);function Yd(e){var i=[];e&&e.isBone&&i.push(e);for(var t=0;t<e.children.length;t++)i.push.apply(i,Yd(e.children[t]));return i}var py=function(e){le(i,e);function i(r,n,a){var o,s=new Fo(n,4,2),l=new qt({wireframe:!0,fog:!1,toneMapped:!1});return o=e.call(this,s,l)||this,o.light=r,o.light.updateMatrixWorld(),o.color=a,o.type="PointLightHelper",o.matrix=o.light.matrixWorld,o.matrixAutoUpdate=!1,o.update(),o}var t=i.prototype;return t.dispose=function(){this.geometry.dispose(),this.material.dispose()},t.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)},i}(Je),fy=new T,Zd=new ie,Jd=new ie,my=function(e){le(i,e);function i(r,n,a){var o;o=e.call(this)||this,o.light=r,o.light.updateMatrixWorld(),o.matrix=r.matrixWorld,o.matrixAutoUpdate=!1,o.color=a;var s=new Uo(n);s.rotateY(Math.PI*.5),o.material=new qt({wireframe:!0,fog:!1,toneMapped:!1}),o.color===void 0&&(o.material.vertexColors=!0);var l=s.getAttribute("position"),c=new Float32Array(l.count*3);return s.setAttribute("color",new fe(c,3)),o.add(new Je(s,o.material)),o.update(),o}var t=i.prototype;return t.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},t.update=function(){var r=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var n=r.geometry.getAttribute("color");Zd.copy(this.light.color),Jd.copy(this.light.groundColor);for(var a=0,o=n.count;a<o;a++){var s=a<o/2?Zd:Jd;n.setXYZ(a,s.r,s.g,s.b)}n.needsUpdate=!0}r.lookAt(fy.setFromMatrixPosition(this.light.matrixWorld).negate())},i}(se),Kd=function(e){le(i,e);function i(t,r,n,a){var o;t===void 0&&(t=10),r===void 0&&(r=10),n===void 0&&(n=4473924),a===void 0&&(a=8947848),n=new ie(n),a=new ie(a);for(var s=r/2,l=t/r,c=t/2,h=[],u=[],p=0,d=0,m=-c;p<=r;p++,m+=l){h.push(-c,0,m,c,0,m),h.push(m,0,-c,m,0,c);var g=p===s?n:a;g.toArray(u,d),d+=3,g.toArray(u,d),d+=3,g.toArray(u,d),d+=3,g.toArray(u,d),d+=3}var b=new pe;b.setAttribute("position",new te(h,3)),b.setAttribute("color",new te(u,3));var v=new et({vertexColors:!0,toneMapped:!1});return o=e.call(this,b,v)||this,o.type="GridHelper",o}return i}(Ct),vy=function(e){le(i,e);function i(t,r,n,a,o,s){var l;t===void 0&&(t=10),r===void 0&&(r=16),n===void 0&&(n=8),a===void 0&&(a=64),o===void 0&&(o=4473924),s===void 0&&(s=8947848),o=new ie(o),s=new ie(s);for(var c=[],h=[],u=0;u<=r;u++){var p=u/r*(Math.PI*2),d=Math.sin(p)*t,m=Math.cos(p)*t;c.push(0,0,0),c.push(d,0,m);var g=u&1?o:s;h.push(g.r,g.g,g.b),h.push(g.r,g.g,g.b)}for(var b=0;b<=n;b++)for(var v=b&1?o:s,f=t-t/n*b,M=0;M<a;M++){var _=M/a*(Math.PI*2),w=Math.sin(_)*f,x=Math.cos(_)*f;c.push(w,0,x),h.push(v.r,v.g,v.b),_=(M+1)/a*(Math.PI*2),w=Math.sin(_)*f,x=Math.cos(_)*f,c.push(w,0,x),h.push(v.r,v.g,v.b)}var S=new pe;S.setAttribute("position",new te(c,3)),S.setAttribute("color",new te(h,3));var A=new et({vertexColors:!0,toneMapped:!1});return l=e.call(this,S,A)||this,l.type="PolarGridHelper",l}return i}(Ct),Qd=new T,cs=new T,$d=new T,gy=function(e){le(i,e);function i(r,n,a){var o;o=e.call(this)||this,o.light=r,o.light.updateMatrixWorld(),o.matrix=r.matrixWorld,o.matrixAutoUpdate=!1,o.color=a,n===void 0&&(n=1);var s=new pe;s.setAttribute("position",new te([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));var l=new et({fog:!1,toneMapped:!1});return o.lightPlane=new Yt(s,l),o.add(o.lightPlane),s=new pe,s.setAttribute("position",new te([0,0,0,0,0,1],3)),o.targetLine=new Yt(s,l),o.add(o.targetLine),o.update(),o}var t=i.prototype;return t.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},t.update=function(){Qd.setFromMatrixPosition(this.light.matrixWorld),cs.setFromMatrixPosition(this.light.target.matrixWorld),$d.subVectors(cs,Qd),this.lightPlane.lookAt(cs),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(cs),this.targetLine.scale.z=$d.length()},i}(se),us=new T,nt=new fr,yy=function(e){le(i,e);function i(r){var n,a=new pe,o=new et({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],l=[],c={},h=new ie(16755200),u=new ie(16711680),p=new ie(43775),d=new ie(16777215),m=new ie(3355443);g("n1","n2",h),g("n2","n4",h),g("n4","n3",h),g("n3","n1",h),g("f1","f2",h),g("f2","f4",h),g("f4","f3",h),g("f3","f1",h),g("n1","f1",h),g("n2","f2",h),g("n3","f3",h),g("n4","f4",h),g("p","n1",u),g("p","n2",u),g("p","n3",u),g("p","n4",u),g("u1","u2",p),g("u2","u3",p),g("u3","u1",p),g("c","t",d),g("p","c",m),g("cn1","cn2",m),g("cn3","cn4",m),g("cf1","cf2",m),g("cf3","cf4",m);function g(v,f,M){b(v,M),b(f,M)}function b(v,f){s.push(0,0,0),l.push(f.r,f.g,f.b),c[v]===void 0&&(c[v]=[]),c[v].push(s.length/3-1)}return a.setAttribute("position",new te(s,3)),a.setAttribute("color",new te(l,3)),n=e.call(this,a,o)||this,n.type="CameraHelper",n.camera=r,n.camera.updateProjectionMatrix&&n.camera.updateProjectionMatrix(),n.matrix=r.matrixWorld,n.matrixAutoUpdate=!1,n.pointMap=c,n.update(),n}var t=i.prototype;return t.update=function(){var r=this.geometry,n=this.pointMap,a=1,o=1;nt.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),at("c",n,r,nt,0,0,-1),at("t",n,r,nt,0,0,1),at("n1",n,r,nt,-a,-o,-1),at("n2",n,r,nt,a,-o,-1),at("n3",n,r,nt,-a,o,-1),at("n4",n,r,nt,a,o,-1),at("f1",n,r,nt,-a,-o,1),at("f2",n,r,nt,a,-o,1),at("f3",n,r,nt,-a,o,1),at("f4",n,r,nt,a,o,1),at("u1",n,r,nt,a*.7,o*1.1,-1),at("u2",n,r,nt,-a*.7,o*1.1,-1),at("u3",n,r,nt,0,o*2,-1),at("cf1",n,r,nt,-a,0,1),at("cf2",n,r,nt,a,0,1),at("cf3",n,r,nt,0,-o,1),at("cf4",n,r,nt,0,o,1),at("cn1",n,r,nt,-a,0,-1),at("cn2",n,r,nt,a,0,-1),at("cn3",n,r,nt,0,-o,-1),at("cn4",n,r,nt,0,o,-1),r.getAttribute("position").needsUpdate=!0},i}(Ct);function at(e,i,t,r,n,a,o){us.set(n,a,o).unproject(r);var s=i[e];if(s!==void 0)for(var l=t.getAttribute("position"),c=0,h=s.length;c<h;c++)l.setXYZ(s[c],us.x,us.y,us.z)}var hs=new hr,ep=function(e){le(i,e);function i(r,n){var a;n===void 0&&(n=16776960);var o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(8*3),l=new pe;return l.setIndex(new fe(o,1)),l.setAttribute("position",new fe(s,3)),a=e.call(this,l,new et({color:n,toneMapped:!1}))||this,a.object=r,a.type="BoxHelper",a.matrixAutoUpdate=!1,a.update(),a}var t=i.prototype;return t.update=function(r){if(r!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&hs.setFromObject(this.object),!hs.isEmpty()){var n=hs.min,a=hs.max,o=this.geometry.attributes.position,s=o.array;s[0]=a.x,s[1]=a.y,s[2]=a.z,s[3]=n.x,s[4]=a.y,s[5]=a.z,s[6]=n.x,s[7]=n.y,s[8]=a.z,s[9]=a.x,s[10]=n.y,s[11]=a.z,s[12]=a.x,s[13]=a.y,s[14]=n.z,s[15]=n.x,s[16]=a.y,s[17]=n.z,s[18]=n.x,s[19]=n.y,s[20]=n.z,s[21]=a.x,s[22]=n.y,s[23]=n.z,o.needsUpdate=!0,this.geometry.computeBoundingSphere()}},t.setFromObject=function(r){return this.object=r,this.update(),this},t.copy=function(r){return Ct.prototype.copy.call(this,r),this.object=r.object,this},i}(Ct),xy=function(e){le(i,e);function i(r,n){var a;n===void 0&&(n=16776960);var o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],l=new pe;return l.setIndex(new fe(o,1)),l.setAttribute("position",new te(s,3)),a=e.call(this,l,new et({color:n,toneMapped:!1}))||this,a.box=r,a.type="Box3Helper",a.geometry.computeBoundingSphere(),a}var t=i.prototype;return t.updateMatrixWorld=function(r){var n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),e.prototype.updateMatrixWorld.call(this,r))},i}(Ct),by=function(e){le(i,e);function i(r,n,a){var o;n===void 0&&(n=1),a===void 0&&(a=16776960);var s=a,l=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],c=new pe;c.setAttribute("position",new te(l,3)),c.computeBoundingSphere(),o=e.call(this,c,new et({color:s,toneMapped:!1}))||this,o.type="PlaneHelper",o.plane=r,o.size=n;var h=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],u=new pe;return u.setAttribute("position",new te(h,3)),u.computeBoundingSphere(),o.add(new Je(u,new qt({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),o}var t=i.prototype;return t.updateMatrixWorld=function(r){var n=-this.plane.constant;Math.abs(n)<1e-8&&(n=1e-8),this.scale.set(.5*this.size,.5*this.size,n),this.children[0].material.side=n<0?ht:Hi,this.lookAt(this.plane.normal),e.prototype.updateMatrixWorld.call(this,r)},i}(Yt),tp=new T,ds,vc,_y=function(e){le(i,e);function i(r,n,a,o,s,l){var c;return c=e.call(this)||this,c.type="ArrowHelper",r===void 0&&(r=new T(0,0,1)),n===void 0&&(n=new T(0,0,0)),a===void 0&&(a=1),o===void 0&&(o=16776960),s===void 0&&(s=.2*a),l===void 0&&(l=.2*s),ds===void 0&&(ds=new pe,ds.setAttribute("position",new te([0,0,0,0,1,0],3)),vc=new Aa(0,.5,1,5,1),vc.translate(0,-.5,0)),c.position.copy(n),c.line=new Yt(ds,new et({color:o,toneMapped:!1})),c.line.matrixAutoUpdate=!1,c.add(c.line),c.cone=new Je(vc,new qt({color:o,toneMapped:!1})),c.cone.matrixAutoUpdate=!1,c.add(c.cone),c.setDirection(r),c.setLength(a,s,l),c}var t=i.prototype;return t.setDirection=function(r){if(r.y>.99999)this.quaternion.set(0,0,0,1);else if(r.y<-.99999)this.quaternion.set(1,0,0,0);else{tp.set(r.z,0,-r.x).normalize();var n=Math.acos(r.y);this.quaternion.setFromAxisAngle(tp,n)}},t.setLength=function(r,n,a){n===void 0&&(n=.2*r),a===void 0&&(a=.2*n),this.line.scale.set(1,Math.max(1e-4,r-n),1),this.line.updateMatrix(),this.cone.scale.set(a,n,a),this.cone.position.y=r,this.cone.updateMatrix()},t.setColor=function(r){this.line.material.color.set(r),this.cone.material.color.set(r)},t.copy=function(r){return e.prototype.copy.call(this,r,!1),this.line.copy(r.line),this.cone.copy(r.cone),this},i}(se),rp=function(e){le(i,e);function i(t){var r;t===void 0&&(t=1);var n=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],a=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],o=new pe;o.setAttribute("position",new te(n,3)),o.setAttribute("color",new te(a,3));var s=new et({vertexColors:!0,toneMapped:!1});return r=e.call(this,o,s)||this,r.type="AxesHelper",r}return i}(Ct),ip=new Float32Array(1),wy=new Int32Array(ip.buffer),My={toHalfFloat:function(e){ip[0]=e;var i=wy[0],t=i>>16&32768,r=i>>12&2047,n=i>>23&255;return n<103?t:n>142?(t|=31744,t|=(n==255?0:1)&&i&8388607,t):n<113?(r|=2048,t|=(r>>114-n)+(r>>113-n&1),t):(t|=n-112<<10|r>>1,t+=r&1,t)}},zr,Pn=4,oi=8,br=Math.pow(2,oi),np=[.125,.215,.35,.446,.526,.582],ap=oi-Pn+1+np.length,Cn=20,_r=(zr={},zr[Lt]=0,zr[Xn]=1,zr[Ka]=2,zr[Gs]=3,zr[Hs]=4,zr[ks]=5,zr[Ja]=6,zr),gc=new Rn,yc=Ey(),Fa=yc._lodPlanes,op=yc._sizeLods,ps=yc._sigmas,sp=new ie,xc=null,zi=(1+Math.sqrt(5))/2,Nn=1/zi,lp=[new T(1,1,1),new T(-1,1,1),new T(1,1,-1),new T(-1,1,-1),new T(0,zi,Nn),new T(0,zi,-Nn),new T(Nn,0,zi),new T(-Nn,0,zi),new T(zi,Nn,0),new T(-zi,Nn,0)],Sy=function(){function e(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=Ay(Cn),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var i=e.prototype;return i.fromScene=function(t,r,n,a){r===void 0&&(r=0),n===void 0&&(n=.1),a===void 0&&(a=100),xc=this._renderer.getRenderTarget();var o=this._allocateTargets();return this._sceneToCubeUV(t,n,a,o),r>0&&this._blur(o,0,0,r),this._applyPMREM(o),this._cleanup(o),o},i.fromEquirectangular=function(t){return this._fromTexture(t)},i.fromCubemap=function(t){return this._fromTexture(t)},i.compileCubemapShader=function(){this._cubemapShader===null&&(this._cubemapShader=hp(),this._compileMaterial(this._cubemapShader))},i.compileEquirectangularShader=function(){this._equirectShader===null&&(this._equirectShader=up(),this._compileMaterial(this._equirectShader))},i.dispose=function(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(var t=0;t<Fa.length;t++)Fa[t].dispose()},i._cleanup=function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(xc),t.scissorTest=!1,fs(t,0,0,t.width,t.height)},i._fromTexture=function(t){xc=this._renderer.getRenderTarget();var r=this._allocateTargets(t);return this._textureToCubeUV(t,r),this._applyPMREM(r),this._cleanup(r),r},i._allocateTargets=function(t){var r={magFilter:dt,minFilter:dt,generateMipmaps:!1,type:ji,format:lu,encoding:Ty(t)?t.encoding:Ka,depthBuffer:!1},n=cp(r);return n.depthBuffer=!t,this._pingPongRenderTarget=cp(r),n},i._compileMaterial=function(t){var r=new Je(Fa[0],t);this._renderer.compile(r,gc)},i._sceneToCubeUV=function(t,r,n,a){var o=90,s=1,l=new ct(o,s,r,n),c=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],u=this._renderer,p=u.outputEncoding,d=u.toneMapping;u.getClearColor(sp);var m=u.getClearAlpha();u.toneMapping=hi,u.outputEncoding=Lt;var g=t.background;if(g&&g.isColor){g.convertSRGBToLinear();var b=Math.max(g.r,g.g,g.b),v=Math.min(Math.max(Math.ceil(Math.log2(b)),-128),127);g=g.multiplyScalar(Math.pow(2,-v));var f=(v+128)/255;u.setClearColor(g,f),t.background=null}for(var M=0;M<6;M++){var _=M%3;_==0?(l.up.set(0,c[M],0),l.lookAt(h[M],0,0)):_==1?(l.up.set(0,0,c[M]),l.lookAt(0,h[M],0)):(l.up.set(0,c[M],0),l.lookAt(0,0,h[M])),fs(a,_*br,M>2?br:0,br,br),u.setRenderTarget(a),u.render(t,l)}u.toneMapping=d,u.outputEncoding=p,u.setClearColor(sp,m)},i._textureToCubeUV=function(t,r){var n=this._renderer;t.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=hp()):this._equirectShader==null&&(this._equirectShader=up());var a=t.isCubeTexture?this._cubemapShader:this._equirectShader,o=new Je(Fa[0],a),s=a.uniforms;s.envMap.value=t,t.isCubeTexture||s.texelSize.value.set(1/t.image.width,1/t.image.height),s.inputEncoding.value=_r[t.encoding],s.outputEncoding.value=_r[r.texture.encoding],fs(r,0,0,3*br,2*br),n.setRenderTarget(r),n.render(o,gc)},i._applyPMREM=function(t){var r=this._renderer,n=r.autoClear;r.autoClear=!1;for(var a=1;a<ap;a++){var o=Math.sqrt(ps[a]*ps[a]-ps[a-1]*ps[a-1]),s=lp[(a-1)%lp.length];this._blur(t,a-1,a,o,s)}r.autoClear=n},i._blur=function(t,r,n,a,o){var s=this._pingPongRenderTarget;this._halfBlur(t,s,r,n,a,"latitudinal",o),this._halfBlur(s,t,n,n,a,"longitudinal",o)},i._halfBlur=function(t,r,n,a,o,s,l){var c=this._renderer,h=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var u=3,p=new Je(Fa[a],h),d=h.uniforms,m=op[n]-1,g=isFinite(o)?Math.PI/(2*m):2*Math.PI/(2*Cn-1),b=o/g,v=isFinite(o)?1+Math.floor(u*b):Cn;v>Cn&&console.warn("sigmaRadians, "+o+", is too large and will clip, as it requested "+v+" samples when the maximum is set to "+Cn);for(var f=[],M=0,_=0;_<Cn;++_){var w=_/b,x=Math.exp(-w*w/2);f.push(x),_==0?M+=x:_<v&&(M+=2*x)}for(var S=0;S<f.length;S++)f[S]=f[S]/M;d.envMap.value=t.texture,d.samples.value=v,d.weights.value=f,d.latitudinal.value=s==="latitudinal",l&&(d.poleAxis.value=l),d.dTheta.value=g,d.mipInt.value=oi-n,d.inputEncoding.value=_r[t.texture.encoding],d.outputEncoding.value=_r[t.texture.encoding];var A=op[a],I=3*Math.max(0,br-2*A),P=(a===0?0:2*br)+2*A*(a>oi-Pn?a-oi+Pn:0);fs(r,I,P,3*A,2*A),c.setRenderTarget(r),c.render(p,gc)},e}();function Ty(e){return e===void 0||e.type!==ji?!1:e.encoding===Lt||e.encoding===Xn||e.encoding===Ja}function Ey(){for(var e=[],i=[],t=[],r=oi,n=0;n<ap;n++){var a=Math.pow(2,r);i.push(a);var o=1/a;n>oi-Pn?o=np[n-oi+Pn-1]:n==0&&(o=0),t.push(o);for(var s=1/(a-1),l=-s/2,c=1+s/2,h=[l,l,c,l,c,c,l,l,c,c,l,c],u=6,p=6,d=3,m=2,g=1,b=new Float32Array(d*p*u),v=new Float32Array(m*p*u),f=new Float32Array(g*p*u),M=0;M<u;M++){var _=M%3*2/3-1,w=M>2?0:-1,x=[_,w,0,_+2/3,w,0,_+2/3,w+1,0,_,w,0,_+2/3,w+1,0,_,w+1,0];b.set(x,d*p*M),v.set(h,m*p*M);var S=[M,M,M,M,M,M];f.set(S,g*p*M)}var A=new pe;A.setAttribute("position",new fe(b,d)),A.setAttribute("uv",new fe(v,m)),A.setAttribute("faceIndex",new fe(f,g)),e.push(A),r>Pn&&r--}return{_lodPlanes:e,_sizeLods:i,_sigmas:t}}function cp(e){var i=new Bt(3*br,3*br,e);return i.texture.mapping=Vi,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function fs(e,i,t,r,n){e.viewport.set(i,t,r,n),e.scissor.set(i,t,r,n)}function Ay(e){var i=new Float32Array(e),t=new T(0,1,0),r=new Ir({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t},inputEncoding:{value:_r[Lt]},outputEncoding:{value:_r[Lt]}},vertexShader:bc(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			`+_c()+`

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:Mr,depthTest:!1,depthWrite:!1});return r}function up(){var e=new X(1,1),i=new Ir({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:_r[Lt]},outputEncoding:{value:_r[Lt]}},vertexShader:bc(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			`+_c()+`

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:Mr,depthTest:!1,depthWrite:!1});return i}function hp(){var e=new Ir({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:_r[Lt]},outputEncoding:{value:_r[Lt]}},vertexShader:bc(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			`+_c()+`

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:Mr,depthTest:!1,depthWrite:!1});return e}function bc(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function _c(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}function Ly(e,i,t,r,n,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new $n(e,i,t,n,a,o)}var Ry=0,Py=1,Cy=0,Ny=1,Oy=2;function Iy(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function Dy(e){return e===void 0&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function By(e,i){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new bn(e,i)}function zy(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new xa(e)}function Uy(e,i){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new bn(e,i)}function Fy(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new rr(e)}function Gy(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new rr(e)}function Hy(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new rr(e)}function ky(e,i,t){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new T(e,i,t)}function Vy(e,i){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new fe(e,i).setUsage(vi)}function Wy(e,i){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new ea(e,i)}function jy(e,i){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new ta(e,i)}function qy(e,i){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ra(e,i)}function Xy(e,i){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new ia(e,i)}function Yy(e,i){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new bi(e,i)}function Zy(e,i){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new na(e,i)}function Jy(e,i){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new _i(e,i)}function Ky(e,i){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new te(e,i)}function Qy(e,i){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new oa(e,i)}de.create=function(e,i){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(de.prototype),e.prototype.constructor=e,e.prototype.getPoint=i,e},Object.assign(Dr.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var i=this.getPoints(e);return this.createGeometry(i)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var i=this.getSpacedPoints(e);return this.createGeometry(i)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var i=new je,t=0,r=e.length;t<r;t++){var n=e[t];i.vertices.push(new T(n.x,n.y,n.z||0))}return i}}),Object.assign(lr.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}});function dp(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Mt.call(this,e),this.type="catmullrom",this.closed=!0}dp.prototype=Object.create(Mt.prototype);function pp(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Mt.call(this,e),this.type="catmullrom"}pp.prototype=Object.create(Mt.prototype);function wc(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Mt.call(this,e),this.type="catmullrom"}wc.prototype=Object.create(Mt.prototype),Object.assign(wc.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});function $y(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new rp(e)}function ex(e,i){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new ep(e,i)}function tx(e,i){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ct(new El(e.geometry),new et({color:i!==void 0?i:16777215}))}Kd.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Xd.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};function rx(e,i){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ct(new Gl(e.geometry),new et({color:i!==void 0?i:16777215}))}Object.assign(ke.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Ql.extractUrlBase(e)}}),ke.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};function ix(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Zt(e)}function nx(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Xo(e)}Object.assign(Vd.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(hr.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Er.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),ha.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},jd.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(be,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),be.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),be.ceilPowerOfTwo(e)}}),Object.assign(Rt.prototype,{flattenToArrayOffset:function(e,i){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,i)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()}}),Object.assign(Te.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,i){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,i)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new T().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,i,t,r,n,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,i,r,t,n,a)},getInverse:function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()}}),dr.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Object.assign(_t.prototype,{multiplyVector3:function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},inverse:function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()}}),Object.assign($i.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign($t.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,i)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign($t,{barycoordFromPoint:function(e,i,t,r,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),$t.getBarycoord(e,i,t,r,n)},normal:function(e,i,t,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),$t.getNormal(e,i,t,r)}}),Object.assign(ni.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Rl(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Il(this,e)}}),Object.assign(X.prototype,{fromAttribute:function(e,i,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,i,t)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(T.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,i){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(i,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,i,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,i,t)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(We.prototype,{fromAttribute:function(e,i,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,i,t)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(je.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(se.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,i){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(i,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(se.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Je.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Je.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Yu},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(ba.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ma.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),_a.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(de.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),ct.prototype.setLens=function(e,i){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),i!==void 0&&(this.filmGauge=i),this.setFocalLength(e)},Object.defineProperties(Ye.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(fe.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===vi},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(vi)}}}),Object.assign(fe.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?vi:Yn),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(pe.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,i){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(i&&i.isBufferAttribute)&&!(i&&i.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new fe(arguments[1],arguments[2]))):e==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(i),this):this.setAttribute(e,i)},addDrawCall:function(e,i,t){t!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,i)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(pe.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(za.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(pc.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(Gt.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===vi},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(Gt.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?vi:Yn),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Ca.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.assign(ml.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(Gd.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(ye.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ie}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===bs}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(ii.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(ri.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties(Pt.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(ma.prototype,{clearTarget:function(e,i,t,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(i,t,r)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(ma.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=e===!0?Xn:Lt}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(zh.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});function ax(e,i,t){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Cr(e,t)}Object.defineProperties(Bt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(oc.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var i=this,t=new os;return t.load(e,function(r){i.setBuffer(r)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),zd.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Mi.prototype.updateCubeMap=function(e,i){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,i)},Mi.prototype.clear=function(e,i,t,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,i,t,r)};var ox={merge:function(e,i,t){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var r;i.isMesh&&(i.matrixAutoUpdate&&i.updateMatrix(),r=i.matrix,i=i.geometry),e.merge(i,r,t)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};gi.crossOrigin=void 0,gi.loadTexture=function(e,i,t,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var n=new Yo;n.setCrossOrigin(this.crossOrigin);var a=n.load(e,t,void 0,r);return i&&(a.mapping=i),a},gi.loadTextureCube=function(e,i,t,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var n=new qo;n.setCrossOrigin(this.crossOrigin);var a=n.load(e,t,void 0,r);return i&&(a.mapping=i),a},gi.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},gi.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function sx(){console.error("THREE.CanvasRenderer has been removed")}function lx(){console.error("THREE.JSONLoader has been removed.")}var cx={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function ux(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Fi}})),y.ACESFilmicToneMapping=Kc,y.AddEquation=ui,y.AddOperation=Xc,y.AdditiveAnimationBlendMode=Fs,y.AdditiveBlending=_s,y.AlphaFormat=au,y.AlwaysDepth=Gc,y.AlwaysStencilFunc=$u,y.AmbientLight=es,y.AmbientLightProbe=ac,y.AnimationClip=kt,y.AnimationLoader=kl,y.AnimationMixer=uc,y.AnimationObjectGroup=Fd,y.AnimationUtils=Ke,y.ArcCurve=Ln,y.ArrayCamera=yo,y.ArrowHelper=_y,y.Audio=oc,y.AudioAnalyser=zd,y.AudioContext=ic,y.AudioListener=Q0,y.AudioLoader=os,y.AxesHelper=rp,y.AxisHelper=$y,y.BackSide=ht,y.BasicDepthPacking=Ju,y.BasicShadowMap=wp,y.BinaryTextureLoader=nx,y.Bone=wa,y.BooleanKeyframeTrack=ko,y.BoundingBoxHelper=ex,y.Box2=Vd,y.Box3=hr,y.Box3Helper=xy,y.BoxBufferGeometry=ua,y.BoxGeometry=_l,y.BoxHelper=ep,y.BufferAttribute=fe,y.BufferGeometry=pe,y.BufferGeometryLoader=ns,y.ByteType=$c,y.Cache=Ni,y.Camera=fr,y.CameraHelper=yy,y.CanvasRenderer=sx,y.CanvasTexture=Ta,y.CatmullRomCurve3=Mt,y.CineonToneMapping=Jc,y.CircleBufferGeometry=wl,y.CircleGeometry=id,y.ClampToEdgeWrapping=At,y.Clock=Od,y.ClosedSplineCurve3=dp,y.Color=ie,y.ColorKeyframeTrack=Vo,y.CompressedTexture=_n,y.CompressedTextureLoader=Vl,y.ConeBufferGeometry=ad,y.ConeGeometry=nd,y.CubeCamera=Mi,y.CubeGeometry=_l,y.CubeReflectionMapping=Bn,y.CubeRefractionMapping=zn,y.CubeTexture=mr,y.CubeTextureLoader=qo,y.CubeUVReflectionMapping=Vi,y.CubeUVRefractionMapping=Un,y.CubicBezierCurve=nr,y.CubicBezierCurve3=yr,y.CubicInterpolant=Go,y.CullFaceBack=ys,y.CullFaceFront=Tc,y.CullFaceFrontBack=_p,y.CullFaceNone=Sc,y.Curve=de,y.CurvePath=Dr,y.CustomBlending=Ac,y.CustomToneMapping=Qc,y.CylinderBufferGeometry=Aa,y.CylinderGeometry=Ml,y.Cylindrical=hy,y.DataTexture=Nr,y.DataTexture2DArray=pn,y.DataTexture3D=fn,y.DataTextureLoader=Xo,y.DataUtils=My,y.DecrementStencilOp=Op,y.DecrementWrapStencilOp=Dp,y.DefaultLoadingManager=Td,y.DepthFormat=di,y.DepthStencilFormat=Xi,y.DepthTexture=Ea,y.DirectionalLight=$o,y.DirectionalLightHelper=gy,y.DiscreteInterpolant=Ho,y.DodecahedronBufferGeometry=Sl,y.DodecahedronGeometry=od,y.DoubleSide=In,y.DstAlphaFactor=Ic,y.DstColorFactor=Bc,y.DynamicBufferAttribute=Vy,y.DynamicCopyUsage=Zp,y.DynamicDrawUsage=vi,y.DynamicReadUsage=qp,y.EdgesGeometry=El,y.EdgesHelper=tx,y.EllipseCurve=Vt,y.EqualDepth=kc,y.EqualStencilFunc=Fp,y.EquirectangularReflectionMapping=Wa,y.EquirectangularRefractionMapping=ja,y.Euler=oo,y.EventDispatcher=ur,y.ExtrudeBufferGeometry=Ca,y.ExtrudeGeometry=Rl,y.Face3=$n,y.Face4=Ly,y.FaceColors=Ny,y.FileLoader=Zt,y.FlatShading=bs,y.Float16BufferAttribute=aa,y.Float32Attribute=Ky,y.Float32BufferAttribute=te,y.Float64Attribute=Qy,y.Float64BufferAttribute=oa,y.FloatType=Sr,y.Fog=Hh,y.FogExp2=Gh,y.Font=tc,y.FontLoader=rc,y.FrontSide=Hi,y.Frustum=ha,y.GLBufferAttribute=dc,y.GLSL1=Kp,y.GLSL3=Vs,y.GammaEncoding=Ja,y.Geometry=je,y.GeometryUtils=ox,y.GreaterDepth=Wc,y.GreaterEqualDepth=Vc,y.GreaterEqualStencilFunc=Vp,y.GreaterStencilFunc=Hp,y.GridHelper=Kd,y.Group=Qr,y.HalfFloatType=Vn,y.HemisphereLight=Jo,y.HemisphereLightHelper=my,y.HemisphereLightProbe=nc,y.IcosahedronBufferGeometry=Pl,y.IcosahedronGeometry=pd,y.ImageBitmapLoader=$l,y.ImageLoader=An,y.ImageUtils=gi,y.ImmediateRenderObject=Ua,y.IncrementStencilOp=Np,y.IncrementWrapStencilOp=Ip,y.InstancedBufferAttribute=is,y.InstancedBufferGeometry=za,y.InstancedInterleavedBuffer=hc,y.InstancedMesh=So,y.Int16Attribute=Xy,y.Int16BufferAttribute=ia,y.Int32Attribute=Zy,y.Int32BufferAttribute=na,y.Int8Attribute=Wy,y.Int8BufferAttribute=ea,y.IntType=tu,y.InterleavedBuffer=Gt,y.InterleavedBufferAttribute=$r,y.Interpolant=Ht,y.InterpolateDiscrete=Wn,y.InterpolateLinear=jn,y.InterpolateSmooth=Ya,y.InvertStencilOp=Bp,y.JSONLoader=lx,y.KeepStencilOp=Qa,y.KeyframeTrack=bt,y.LOD=ba,y.LatheBufferGeometry=Cl,y.LatheGeometry=fd,y.Layers=Qs,y.LensFlare=ux,y.LessDepth=Hc,y.LessEqualDepth=ka,y.LessEqualStencilFunc=Gp,y.LessStencilFunc=Up,y.Light=Ye,y.LightProbe=Jt,y.Line=Yt,y.Line3=jd,y.LineBasicMaterial=et,y.LineCurve=It,y.LineCurve3=ar,y.LineDashedMaterial=Ci,y.LineLoop=Ro,y.LinePieces=Py,y.LineSegments=Ct,y.LineStrip=Ry,y.LinearEncoding=Lt,y.LinearFilter=mt,y.LinearInterpolant=Oa,y.LinearMipMapLinearFilter=Ap,y.LinearMipMapNearestFilter=Ep,y.LinearMipmapLinearFilter=Wi,y.LinearMipmapNearestFilter=Ls,y.LinearToneMapping=Yc,y.Loader=ke,y.LoaderUtils=Ql,y.LoadingManager=Hl,y.LogLuvEncoding=Zu,y.LoopOnce=ju,y.LoopPingPong=Xu,y.LoopRepeat=qu,y.LuminanceAlphaFormat=su,y.LuminanceFormat=ou,y.MOUSE=xp,y.Material=ye,y.MaterialLoader=rs,y.Math=be,y.MathUtils=be,y.Matrix3=Rt,y.Matrix4=Te,y.MaxEquation=Ts,y.Mesh=Je,y.MeshBasicMaterial=qt,y.MeshDepthMaterial=Jr,y.MeshDistanceMaterial=Kr,y.MeshFaceMaterial=Iy,y.MeshLambertMaterial=Ri,y.MeshMatcapMaterial=Pi,y.MeshNormalMaterial=Li,y.MeshPhongMaterial=ii,y.MeshPhysicalMaterial=ri,y.MeshStandardMaterial=gr,y.MeshToonMaterial=Ai,y.MinEquation=Ss,y.MirroredRepeatWrapping=Gn,y.MixOperation=qc,y.MultiMaterial=Dy,y.MultiplyBlending=Ms,y.MultiplyOperation=Dn,y.NearestFilter=dt,y.NearestMipMapLinearFilter=Tp,y.NearestMipMapNearestFilter=Sp,y.NearestMipmapLinearFilter=Xa,y.NearestMipmapNearestFilter=qa,y.NeverDepth=Fc,y.NeverStencilFunc=zp,y.NoBlending=Mr,y.NoColors=Cy,y.NoToneMapping=hi,y.NormalAnimationBlendMode=Za,y.NormalBlending=ki,y.NotEqualDepth=jc,y.NotEqualStencilFunc=kp,y.NumberKeyframeTrack=Tn,y.Object3D=se,y.ObjectLoader=X0,y.ObjectSpaceNormalMap=Qu,y.OctahedronBufferGeometry=Uo,y.OctahedronGeometry=md,y.OneFactor=Cc,y.OneMinusDstAlphaFactor=Dc,y.OneMinusDstColorFactor=zc,y.OneMinusSrcAlphaFactor=As,y.OneMinusSrcColorFactor=Oc,y.OrthographicCamera=Rn,y.PCFShadowMap=xs,y.PCFSoftShadowMap=Ec,y.PMREMGenerator=Sy,y.ParametricBufferGeometry=Sn,y.ParametricGeometry=Na,y.Particle=zy,y.ParticleBasicMaterial=Gy,y.ParticleSystem=Uy,y.ParticleSystemMaterial=Hy,y.Path=lr,y.PerspectiveCamera=ct,y.Plane=dr,y.PlaneBufferGeometry=go,y.PlaneGeometry=vd,y.PlaneHelper=by,y.PointCloud=By,y.PointCloudMaterial=Fy,y.PointLight=Qo,y.PointLightHelper=py,y.Points=bn,y.PointsMaterial=rr,y.PolarGridHelper=vy,y.PolyhedronBufferGeometry=Ti,y.PolyhedronGeometry=gd,y.PositionalAudio=ey,y.PropertyBinding=St,y.PropertyMixer=sc,y.QuadraticBezierCurve=or,y.QuadraticBezierCurve3=xr,y.Quaternion=_t,y.QuaternionKeyframeTrack=Ia,y.QuaternionLinearInterpolant=Wo,y.REVISION=Fi,y.RGBADepthPacking=Ku,y.RGBAFormat=Dt,y.RGBAIntegerFormat=fu,y.RGBA_ASTC_10x10_Format=Au,y.RGBA_ASTC_10x5_Format=Su,y.RGBA_ASTC_10x6_Format=Tu,y.RGBA_ASTC_10x8_Format=Eu,y.RGBA_ASTC_12x10_Format=Lu,y.RGBA_ASTC_12x12_Format=Ru,y.RGBA_ASTC_4x4_Format=vu,y.RGBA_ASTC_5x4_Format=gu,y.RGBA_ASTC_5x5_Format=yu,y.RGBA_ASTC_6x5_Format=xu,y.RGBA_ASTC_6x6_Format=bu,y.RGBA_ASTC_8x5_Format=_u,y.RGBA_ASTC_8x6_Format=wu,y.RGBA_ASTC_8x8_Format=Mu,y.RGBA_BPTC_Format=Pu,y.RGBA_ETC2_EAC_Format=Us,y.RGBA_PVRTC_2BPPV1_Format=Bs,y.RGBA_PVRTC_4BPPV1_Format=Ds,y.RGBA_S3TC_DXT1_Format=Ps,y.RGBA_S3TC_DXT3_Format=Cs,y.RGBA_S3TC_DXT5_Format=Ns,y.RGBDEncoding=ks,y.RGBEEncoding=Ka,y.RGBEFormat=lu,y.RGBFormat=Hr,y.RGBIntegerFormat=pu,y.RGBM16Encoding=Hs,y.RGBM7Encoding=Gs,y.RGB_ETC1_Format=mu,y.RGB_ETC2_Format=zs,y.RGB_PVRTC_2BPPV1_Format=Is,y.RGB_PVRTC_4BPPV1_Format=Os,y.RGB_S3TC_DXT1_Format=Rs,y.RGFormat=hu,y.RGIntegerFormat=du,y.RawShaderMaterial=Ir,y.Ray=$i,y.Raycaster=pc,y.RectAreaLight=ts,y.RedFormat=cu,y.RedIntegerFormat=uu,y.ReinhardToneMapping=Zc,y.RepeatWrapping=Fn,y.ReplaceStencilOp=Cp,y.ReverseSubtractEquation=Rc,y.RingBufferGeometry=Nl,y.RingGeometry=yd,y.SRGB8_ALPHA8_ASTC_10x10_Format=ku,y.SRGB8_ALPHA8_ASTC_10x5_Format=Fu,y.SRGB8_ALPHA8_ASTC_10x6_Format=Gu,y.SRGB8_ALPHA8_ASTC_10x8_Format=Hu,y.SRGB8_ALPHA8_ASTC_12x10_Format=Vu,y.SRGB8_ALPHA8_ASTC_12x12_Format=Wu,y.SRGB8_ALPHA8_ASTC_4x4_Format=Cu,y.SRGB8_ALPHA8_ASTC_5x4_Format=Nu,y.SRGB8_ALPHA8_ASTC_5x5_Format=Ou,y.SRGB8_ALPHA8_ASTC_6x5_Format=Iu,y.SRGB8_ALPHA8_ASTC_6x6_Format=Du,y.SRGB8_ALPHA8_ASTC_8x5_Format=Bu,y.SRGB8_ALPHA8_ASTC_8x6_Format=zu,y.SRGB8_ALPHA8_ASTC_8x8_Format=Uu,y.Scene=ml,y.SceneUtils=cx,y.ShaderChunk=Re,y.ShaderLib=tr,y.ShaderMaterial=Pt,y.ShadowMaterial=Ei,y.Shape=ni,y.ShapeBufferGeometry=Ol,y.ShapeGeometry=Il,y.ShapePath=ec,y.ShapeUtils=Or,y.ShortType=eu,y.Skeleton=Ma,y.SkeletonHelper=Xd,y.SkinnedMesh=_a,y.SmoothShading=Mp,y.Sphere=Er,y.SphereBufferGeometry=Fo,y.SphereGeometry=xd,y.Spherical=uy,y.SphericalHarmonics3=Ad,y.Spline=wc,y.SplineCurve=sr,y.SplineCurve3=pp,y.SpotLight=Ko,y.SpotLightHelper=dy,y.Sprite=xa,y.SpriteMaterial=ei,y.SrcAlphaFactor=Es,y.SrcAlphaSaturateFactor=Uc,y.SrcColorFactor=Nc,y.StaticCopyUsage=Yp,y.StaticDrawUsage=Yn,y.StaticReadUsage=jp,y.StereoCamera=Nd,y.StreamCopyUsage=Jp,y.StreamDrawUsage=Wp,y.StreamReadUsage=Xp,y.StringKeyframeTrack=jo,y.SubtractEquation=Lc,y.SubtractiveBlending=ws,y.TOUCH=bp,y.TangentSpaceNormalMap=mi,y.TetrahedronBufferGeometry=Dl,y.TetrahedronGeometry=bd,y.TextBufferGeometry=Bl,y.TextGeometry=_d,y.Texture=Ve,y.TextureLoader=Yo,y.TorusBufferGeometry=zl,y.TorusGeometry=wd,y.TorusKnotBufferGeometry=Ul,y.TorusKnotGeometry=Md,y.Triangle=$t,y.TriangleFanDrawMode=Rp,y.TriangleStripDrawMode=Lp,y.TrianglesDrawMode=Yu,y.TubeBufferGeometry=Fl,y.TubeGeometry=Sd,y.UVMapping=Va,y.Uint16Attribute=Yy,y.Uint16BufferAttribute=bi,y.Uint32Attribute=Jy,y.Uint32BufferAttribute=_i,y.Uint8Attribute=jy,y.Uint8BufferAttribute=ta,y.Uint8ClampedAttribute=qy,y.Uint8ClampedBufferAttribute=ra,y.Uniform=Gd,y.UniformsLib=ee,y.UniformsUtils=fh,y.UnsignedByteType=ji,y.UnsignedInt248Type=qi,y.UnsignedIntType=kn,y.UnsignedShort4444Type=ru,y.UnsignedShort5551Type=iu,y.UnsignedShort565Type=nu,y.UnsignedShortType=Hn,y.VSMShadowMap=Gi,y.Vector2=X,y.Vector3=T,y.Vector4=We,y.VectorKeyframeTrack=En,y.Vertex=ky,y.VertexColors=Oy,y.VideoTexture=xl,y.WebGL1Renderer=fl,y.WebGLCubeRenderTarget=Cr,y.WebGLMultisampleRenderTarget=js,y.WebGLRenderTarget=Bt,y.WebGLRenderTargetCube=ax,y.WebGLRenderer=ma,y.WebGLUtils=Uh,y.WireframeGeometry=Gl,y.WireframeHelper=rx,y.WrapAroundEnding=qn,y.XHRLoader=ix,y.ZeroCurvatureEnding=pi,y.ZeroFactor=Pc,y.ZeroSlopeEnding=fi,y.ZeroStencilOp=Pp,y.sRGBEncoding=Xn,Object.defineProperty(y,"__esModule",{value:!0})});
